<!DOCTYPE html>

<html lang="ja" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="4. Windows で Python を使う" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://docs.python.org/3/using/windows.html" />
<meta property="og:site_name" content="Python documentation" />
<meta property="og:description" content="このドキュメントは、 Python を Microsoft Windows で使うときに知っておくべき、 Windows 固有の動作についての概要を伝えることを目的としています。 ほとんどの Unix システムとサービスとは違って、Windows には、システムがサポートする Python インストールが含まれていません。Python を利用可能にするために、CPython チームは長年の間..." />
<meta property="og:image" content="https://docs.python.org/3/_static/og-image.png" />
<meta property="og:image:alt" content="Python documentation" />
<meta name="description" content="このドキュメントは、 Python を Microsoft Windows で使うときに知っておくべき、 Windows 固有の動作についての概要を伝えることを目的としています。 ほとんどの Unix システムとサービスとは違って、Windows には、システムがサポートする Python インストールが含まれていません。Python を利用可能にするために、CPython チームは長年の間..." />
<meta property="og:image:width" content="200" />
<meta property="og:image:height" content="200" />
<meta name="theme-color" content="#3776ab" />

    <title>4. Windows で Python を使う &#8212; Python 3.12.4 ドキュメント</title><meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css%3Fv=80d5e7a1.css" />
    <link rel="stylesheet" type="text/css" href="../_static/pydoctheme.css%3Fv=bb723527.css" />
    <link id="pygments_dark_css" media="(prefers-color-scheme: dark)" rel="stylesheet" type="text/css" href="../_static/pygments_dark.css%3Fv=b20cc3f5.css" />
    
    <script src="../_static/documentation_options.js%3Fv=7e11ab17"></script>
    <script src="../_static/doctools.js%3Fv=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js%3Fv=dc90522c"></script>
    <script src="../_static/translations.js%3Fv=4dbe4bdc"></script>
    
    <script src="../_static/sidebar.js"></script>
    
    <link rel="search" type="application/opensearchdescription+xml"
          title="Python 3.12.4 ドキュメント 内を検索"
          href="../_static/opensearch.xml"/>
    <link rel="author" title="このドキュメントについて" href="../about.html" />
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="検索" href="../search.html" />
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="next" title="5. Mac で Python を使う" href="mac.html" />
    <link rel="prev" title="3. Python を構成する" href="configure.html" />
    
      <script defer data-domain="docs.python.org" src="https://plausible.io/js/script.js"></script>
    
    <link rel="canonical" href="../../../3/using/windows.html" />
    
      
    

    
    <style>
      @media only screen {
        table.full-width-table {
            width: 100%;
        }
      }
    </style>
<link rel="stylesheet" href="../_static/pydoctheme_dark.css" media="(prefers-color-scheme: dark)" id="pydoctheme_dark_css">
    <link rel="shortcut icon" type="image/png" href="../_static/py.svg" />
            <script type="text/javascript" src="../_static/copybutton.js"></script>
            <script type="text/javascript" src="../_static/menu.js"></script>
            <script type="text/javascript" src="../_static/search-focus.js"></script>
            <script type="text/javascript" src="../_static/themetoggle.js"></script> 
<meta name="readthedocs-addons-api-version" content="1">
<script type="text/javascript">
 function onSwitch(event) {
     const option = event.target.selectedIndex;
     const item = event.target.options[option];
     window.location.href = item.dataset.url;
 }

 document.addEventListener("readthedocs-addons-data-ready", function(event) {
   const config = event.detail.data()

   // Add some mocked hardcoded versions pointing to the official
   // documentation while migrating to Read the Docs.
   // These are only for testing purposes.
   // TODO: remove them when managing all the versions on Read the Docs,
   // since all the "active, built and not hidden" versions will be shown automatically.
   let versions = config.versions.active.concat([
       {
           slug: "dev (3.13)",
           urls: {
               documentation: "https://docs.python.org/3.13/",
           }
       },
       {
           slug: "3.12",
           urls: {
               documentation: "https://docs.python.org/3.12/",
           }
       },
       {
           slug: "3.11",
           urls: {
               documentation: "https://docs.python.org/3.11/",
           }
       },
   ]);

   const versionSelect = `
   <select id="version_select">
   ${ versions.map(
       (version) => `
       <option
           value="${ version.slug }"
           ${ config.versions.current.slug === version.slug ? 'selected="selected"' : '' }
           data-url="${ version.urls.documentation }">
           ${ version.slug }
       </option>`
   ).join("\n") }
   </select>
   `;

   // Prepend the current language to the options on the selector
   let languages = config.projects.translations.concat(config.projects.current);
   languages = languages.sort((a, b) => a.language.name.localeCompare(b.language.name));

   const languageSelect = `
   <select id="language_select">
   ${ languages.map(
       (translation) => `
       <option
           value="${ translation.slug }"
           ${ config.projects.current.slug === translation.slug ? 'selected="selected"' : '' }
           data-url="${ translation.urls.documentation }">
           ${ translation.language.name }
       </option>`
   ).join("\n") }
   </select>
   `;

   // Query all the placeholders because there are different ones for Desktop/Mobile
   const versionPlaceholders = document.querySelectorAll(".version_switcher_placeholder");
   for (placeholder of versionPlaceholders) {
       placeholder.innerHTML = versionSelect;
       let selectElement = placeholder.querySelector("select");
       selectElement.addEventListener("change", onSwitch);
   }

   const languagePlaceholders = document.querySelectorAll(".language_switcher_placeholder");
   for (placeholder of languagePlaceholders) {
       placeholder.innerHTML = languageSelect;
       let selectElement = placeholder.querySelector("select");
       selectElement.addEventListener("change", onSwitch);
   }
 });
</script>

  </head>
<body>
<div class="mobile-nav">
    <input type="checkbox" id="menuToggler" class="toggler__input" aria-controls="navigation"
           aria-pressed="false" aria-expanded="false" role="button" aria-label="Menu" />
    <nav class="nav-content" role="navigation">
        <label for="menuToggler" class="toggler__label">
            <span></span>
        </label>
        <span class="nav-items-wrapper">
            <a href="https://www.python.org/" class="nav-logo">
                <img src="../_static/py.svg" alt="Python logo"/>
            </a>
            <span class="version_switcher_placeholder"></span>
            <form role="search" class="search" action="../search.html" method="get">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" class="search-icon">
                    <path fill-rule="nonzero" fill="currentColor" d="M15.5 14h-.79l-.28-.27a6.5 6.5 0 001.48-5.34c-.47-2.78-2.79-5-5.59-5.34a6.505 6.505 0 00-7.27 7.27c.34 2.8 2.56 5.12 5.34 5.59a6.5 6.5 0 005.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0 .41-.41.41-1.08 0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path>
                </svg>
                <input placeholder="クイック検索" aria-label="クイック検索" type="search" name="q" />
                <input type="submit" value="検索"/>
            </form>
        </span>
    </nav>
    <div class="menu-wrapper">
        <nav class="menu" role="navigation" aria-label="main navigation">
            <div class="language_switcher_placeholder"></div>
            
<label class="theme-selector-label">
    Theme
    <select class="theme-selector" oninput="activateTheme(this.value)">
        <option value="auto" selected>Auto</option>
        <option value="light">Light</option>
        <option value="dark">Dark</option>
    </select>
</label>
  <div>
    <h3><a href="../contents.html">目次</a></h3>
    <ul>
<li><a class="reference internal" href="windows.html#">4. Windows で Python を使う</a><ul>
<li><a class="reference internal" href="windows.html#the-full-installer">4.1. 完全版インストーラ</a><ul>
<li><a class="reference internal" href="windows.html#installation-steps">4.1.1. インストール手順</a></li>
<li><a class="reference internal" href="windows.html#removing-the-max-path-limitation">4.1.2. MAX_PATH の制限を除去する</a></li>
<li><a class="reference internal" href="windows.html#installing-without-ui">4.1.3. インストーラの GUI なしでインストールする</a></li>
<li><a class="reference internal" href="windows.html#installing-without-downloading">4.1.4. ダウンロード不要なインストール</a></li>
<li><a class="reference internal" href="windows.html#modifying-an-install">4.1.5. インストール後の変更</a></li>
</ul>
</li>
<li><a class="reference internal" href="windows.html#the-microsoft-store-package">4.2. Microsoft ストアパッケージ</a><ul>
<li><a class="reference internal" href="windows.html#known-issues">4.2.1. 既知の問題</a><ul>
<li><a class="reference internal" href="windows.html#redirection-of-local-data-registry-and-temporary-paths">4.2.1.1. Redirection of local data, registry, and temporary paths</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="windows.html#the-nuget-org-packages">4.3. nuget.org パッケージ</a></li>
<li><a class="reference internal" href="windows.html#the-embeddable-package">4.4. 埋め込み可能なパッケージ</a><ul>
<li><a class="reference internal" href="windows.html#python-application">4.4.1. Python アプリケーション</a></li>
<li><a class="reference internal" href="windows.html#embedding-python">4.4.2. Python の埋め込み</a></li>
</ul>
</li>
<li><a class="reference internal" href="windows.html#alternative-bundles">4.5. 別のバンドル</a></li>
<li><a class="reference internal" href="windows.html#configuring-python">4.6. Python を構成する</a><ul>
<li><a class="reference internal" href="windows.html#excursus-setting-environment-variables">4.6.1. 補足: 環境変数の設定</a></li>
<li><a class="reference internal" href="windows.html#finding-the-python-executable">4.6.2. Python 実行ファイルを見つける</a></li>
</ul>
</li>
<li><a class="reference internal" href="windows.html#utf-8-mode">4.7. UTF-8 モード</a></li>
<li><a class="reference internal" href="windows.html#python-launcher-for-windows">4.8. Windows の Python ランチャ</a><ul>
<li><a class="reference internal" href="windows.html#getting-started">4.8.1. 最初に</a><ul>
<li><a class="reference internal" href="windows.html#from-the-command-line">4.8.1.1. コマンドラインから起動する</a></li>
<li><a class="reference internal" href="windows.html#virtual-environments">4.8.1.2. 仮想環境 (Virtual environments)</a></li>
<li><a class="reference internal" href="windows.html#from-a-script">4.8.1.3. スクリプトから起動する</a></li>
<li><a class="reference internal" href="windows.html#from-file-associations">4.8.1.4. ファイルの関連付けから起動する</a></li>
</ul>
</li>
<li><a class="reference internal" href="windows.html#shebang-lines">4.8.2. シェバン (shebang) 行</a></li>
<li><a class="reference internal" href="windows.html#arguments-in-shebang-lines">4.8.3. シェバン行の引数</a></li>
<li><a class="reference internal" href="windows.html#customization">4.8.4. カスタマイズ</a><ul>
<li><a class="reference internal" href="windows.html#customization-via-ini-files">4.8.4.1. INI ファイルによるカスタマイズ</a></li>
<li><a class="reference internal" href="windows.html#customizing-default-python-versions">4.8.4.2. デフォルトのPythonバージョンのカスタマイズ</a></li>
</ul>
</li>
<li><a class="reference internal" href="windows.html#diagnostics">4.8.5. 診断</a></li>
<li><a class="reference internal" href="windows.html#dry-run">4.8.6. Dry Run</a></li>
<li><a class="reference internal" href="windows.html#install-on-demand">4.8.7. Install on demand</a></li>
<li><a class="reference internal" href="windows.html#return-codes">4.8.8. Return codes</a></li>
</ul>
</li>
<li><a class="reference internal" href="windows.html#finding-modules">4.9. モジュールの検索</a></li>
<li><a class="reference internal" href="windows.html#additional-modules">4.10. 追加のモジュール</a><ul>
<li><a class="reference internal" href="windows.html#pywin32">4.10.1. PyWin32</a></li>
<li><a class="reference internal" href="windows.html#cx-freeze">4.10.2. cx_Freeze</a></li>
</ul>
</li>
<li><a class="reference internal" href="windows.html#compiling-python-on-windows">4.11. Windows 上で Python をコンパイルする</a></li>
<li><a class="reference internal" href="windows.html#other-platforms">4.12. ほかのプラットフォーム</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>前のトピックへ</h4>
    <p class="topless"><a href="configure.html"
                          title="前の章へ"><span class="section-number">3. </span>Python を構成する</a></p>
  </div>
  <div>
    <h4>次のトピックへ</h4>
    <p class="topless"><a href="mac.html"
                          title="次の章へ"><span class="section-number">5. </span>Mac で Python を使う</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>このページ</h3>
    <ul class="this-page-menu">
      <li><a href="../bugs.html">バグ報告</a></li>
      <li>
        <a href="https://github.com/python/cpython/blob/main/Doc/using/windows.rst"
            rel="nofollow">ソースの表示
        </a>
      </li>
    </ul>
  </div>
        </nav>
    </div>
</div>

  
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="総合索引"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Pythonモジュール索引"
             >モジュール</a> |</li>
        <li class="right" >
          <a href="mac.html" title="5. Mac で Python を使う"
             accesskey="N">次へ</a> |</li>
        <li class="right" >
          <a href="configure.html" title="3. Python を構成する"
             accesskey="P">前へ</a> |</li>

          <li><img src="../_static/py.svg" alt="Python logo" style="vertical-align: middle; margin-top: -1px"/></li>
          <li><a href="https://www.python.org/">Python</a> &#187;</li>
          <li class="switchers">
            <div class="language_switcher_placeholder"></div>
            <div class="version_switcher_placeholder"></div>
          </li>
          <li>
              
          </li>
    <li id="cpython-language-and-version">
      <a href="../index.html">3.12.4 Documentation</a> &#187;
    </li>

          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Python のセットアップと利用</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="windows.html"><span class="section-number">4. </span>Windows で Python を使う</a></li>
                <li class="right">
                    

    <div class="inline-search" role="search">
        <form class="inline-search" action="../search.html" method="get">
          <input placeholder="クイック検索" aria-label="クイック検索" type="search" name="q" id="search-box" />
          <input type="submit" value="検索" />
        </form>
    </div>
                     |
                </li>
            <li class="right">
<label class="theme-selector-label">
    Theme
    <select class="theme-selector" oninput="activateTheme(this.value)">
        <option value="auto" selected>Auto</option>
        <option value="light">Light</option>
        <option value="dark">Dark</option>
    </select>
</label> |</li>
            
      </ul>
    </div>    

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="using-python-on-windows">
<span id="using-on-windows"></span><h1><span class="section-number">4. </span>Windows で Python を使う<a class="headerlink" href="windows.html#using-python-on-windows" title="Link to this heading">¶</a></h1>
<p>このドキュメントは、 Python を Microsoft Windows で使うときに知っておくべき、 Windows 固有の動作についての概要を伝えることを目的としています。</p>
<p>ほとんどの Unix システムとサービスとは違って、Windows には、システムがサポートする Python インストールが含まれていません。Python を利用可能にするために、CPython チームは長年の間、すべての <a class="reference external" href="https://www.python.org/downloads/">リリース</a> で Windows インストーラをコンパイルしてきました。単独のユーザで使われるコアインタープリターとライブラリをユーザーごとに追加する Python インストールを、これらインストーラーは主として意図しています。インストーラでは単一マシンのすべてのユーザ用にインストールすることもでき、また、これとは分離されたアプリケーションローカルな配布物の ZIP ファイルも入手可能です。</p>
<p><span class="target" id="index-67"></span><a class="pep reference external" href="https://peps.python.org/pep-0011/"><strong>PEP 11</strong></a> で明記しているとおり Python のリリースは、Microsoft が延長サポート期間であるとしている Windows プラットフォームのみをサポートします。
つまり Python 3.12 は Windows 8.1 とそれより新しい Windows をサポートするということです。
Windows 7 サポートが必要な場合は、Python 3.8 をインストールしてください。</p>
<p>Windows で使えるインストーラには多くの様々なものがあり、それぞれが利点と欠点を持っています。</p>
<p><a class="reference internal" href="windows.html#windows-full"><span class="std std-ref">完全版インストーラ</span></a> には全てのコンポーネントが含まれており、 Python を使う開発者がどんな種類のプロジェクトでも最適な選択肢です。</p>
<p><a class="reference internal" href="windows.html#windows-store"><span class="std std-ref">Microsoft ストアパッケージ</span></a> は、スクリプトやパッケージの実行、 IDLE の使用やその他開発環境に適したシンプルな構成の Python です。
Windows 10 以上が求められはしますが、他のプログラムを壊すことなく安全にインストールできます。
Python やそのツールを起動する多くの便利なコマンドも提供しています。</p>
<p><a class="reference internal" href="windows.html#windows-nuget"><span class="std std-ref">nuget.org パッケージ</span></a> は、継続的インテグレーションのための軽量なインストール構成です。
これは Python パッケージのビルドやスクリプトの実行にも使えますが、アップデート可能ではなく、ユーザーインターフェイスツールもありません。</p>
<p><a class="reference internal" href="windows.html#windows-embeddable"><span class="std std-ref">埋め込み可能なパッケージ</span></a> は、他の大きなアプリケーションに埋め込むのに適した、 Python の最小パッケージです。</p>
<section id="the-full-installer">
<span id="windows-full"></span><h2><span class="section-number">4.1. </span>完全版インストーラ<a class="headerlink" href="windows.html#the-full-installer" title="Link to this heading">¶</a></h2>
<section id="installation-steps">
<h3><span class="section-number">4.1.1. </span>インストール手順<a class="headerlink" href="windows.html#installation-steps" title="Link to this heading">¶</a></h3>
<p>ダウンロードできる Python 3.12 のインストーラは 4 つあります。
インタプリタの 32 ビット版、64 ビット版がそれぞれ 2 つずつあります。
<em>WEB インストーラ</em> は最初のダウンロードサイズは小さく、必要なコンポーネントはインストーラ実行時に必要に応じて自動的にダウンロードします。
<em>オフラインインストーラ</em> にはデフォルトインストールに必要なコンポーネントが含まれていて、インターネット接続はオプショナルな機能のためにだけに必要となります。
インストール時にダウンロードを避けるほかの方法については <a class="reference internal" href="windows.html#install-layout-option"><span class="std std-ref">ダウンロード不要なインストール</span></a> を参照して下さい。</p>
<p>インストーラを開始すると、2つの選択肢からひとつを選べます:</p>
<img alt="../_images/win_installer.png" src="../_images/win_installer.png" />
<p>&quot;Install Now&quot; を選択した場合:</p>
<ul class="simple">
<li><p>管理者権限は <em>不要です</em> (ただし C ランタイムライブラリのシステム更新が必要であったり、 <a class="reference internal" href="windows.html#launcher"><span class="std std-ref">Windows の Python ランチャ</span></a> をすべてのユーザ向けにインストールする場合は必要です)。</p></li>
<li><p>Python はあなたのユーザディレクトリにインストールされます。</p></li>
<li><p><a class="reference internal" href="windows.html#launcher"><span class="std std-ref">Windows の Python ランチャ</span></a> はこのインストールウィザード最初のページの下部のチェックボックス指定に従ってインストールされます。</p></li>
<li><p>標準ライブラリ、テストスイート、ランチャ、pip がインストールされます。</p></li>
<li><p>このインストールウィザード最初の下部のチェックボックスをチェックすれば、環境変数 <span class="target" id="index-68"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PATH</span></code> にインストールディレクトリが追加されます。</p></li>
<li><p>ショートカットはカレントユーザだけに可視になります。</p></li>
</ul>
<p>&quot;Customize installation&quot; を選択すると、インストール場所、その他オプションやインストール後のアクションの変更などのインストールの有りようを選べます。デバッグシンボルやデバッグバイナリをインストールするならこちらを選択する必要があるでしょう。</p>
<p>すべてのユーザのためのインストールのためには &quot;Customize installation&quot; を選んでください。この場合:</p>
<ul class="simple">
<li><p>管理者資格か承認が必要かもしれません。</p></li>
<li><p>Python は Program Files ディレクトリにインストールされます。</p></li>
<li><p><a class="reference internal" href="windows.html#launcher"><span class="std std-ref">Windows の Python ランチャ</span></a> は Windows ディレクトリにインストールされます。</p></li>
<li><p>オプショナルな機能はインストール中に選択できます。</p></li>
<li><p>標準ライブラリをバイトコードにプリコンパイルできます。</p></li>
<li><p>そう選択すれば、インストールディレクトリはシステム環境変数 <span class="target" id="index-69"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PATH</span></code> に追加されます。</p></li>
<li><p>ショートカットがすべてのユーザで利用できるようになります。</p></li>
</ul>
</section>
<section id="removing-the-max-path-limitation">
<span id="max-path"></span><h3><span class="section-number">4.1.2. </span>MAX_PATH の制限を除去する<a class="headerlink" href="windows.html#removing-the-max-path-limitation" title="Link to this heading">¶</a></h3>
<p>Windows は歴史的にパスの長さが 260 文字に制限されています。
つまり、これより長いパスは解決できず結果としてエラーになるということです。</p>
<p>Windows の最新版では、この制限は約 32,000 文字まで拡張できます。
管理者が、グループポリシーの &quot;Win32 の長いパスを有効にする (Enable Win32 long paths)&quot; を有効にするか、レジストリキー <code class="docutils literal notranslate"><span class="pre">HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\FileSystem</span></code> の <code class="docutils literal notranslate"><span class="pre">LongPathsEnabled</span></code> の値を <code class="docutils literal notranslate"><span class="pre">1</span></code> に設定する必要があります。</p>
<p>これにより、 <a class="reference internal" href="../library/functions.html#open" title="open"><code class="xref py py-func docutils literal notranslate"><span class="pre">open()</span></code></a> 関数や <a class="reference internal" href="../library/os.html#module-os" title="os: Miscellaneous operating system interfaces."><code class="xref py py-mod docutils literal notranslate"><span class="pre">os</span></code></a> モジュール、他のほとんどのパスの機能が 260 文字より長いパスを受け入れ、返すことができるようになります。</p>
<p>これらのオプションを変更したら、それ以上の設定は必要ありません。</p>
<div class="versionchanged">
<p><span class="versionmodified changed">バージョン 3.6 で変更: </span>Python で長いパスのサポートが可能になりました。</p>
</div>
</section>
<section id="installing-without-ui">
<span id="install-quiet-option"></span><h3><span class="section-number">4.1.3. </span>インストーラの GUI なしでインストールする<a class="headerlink" href="windows.html#installing-without-ui" title="Link to this heading">¶</a></h3>
<p>インストーラの GUI で利用できるすべてのオプションは、コマンドラインからも指定できます。これによりユーザとの対話なしで数多くの機器に同じインストールを行うような、スクリプト化されたインストールを行うことができます。ちょっとしたデフォルトの変更のために、GUI を抑制することなしにこれらコマンドラインオプションをセットすることもできます。</p>
<p>インストーラーには、以下のオプション (<code class="docutils literal notranslate"><span class="pre">/?</span></code> でインストーラを実行することで確認できます) を渡すことができます:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>名前</p></th>
<th class="head"><p>説明</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>/passive</p></td>
<td><p>ユーザーの操作なしでも進捗を表示する</p></td>
</tr>
<tr class="row-odd"><td><p>/quiet</p></td>
<td><p>UI を表示せずにインストール・アンインストールする</p></td>
</tr>
<tr class="row-even"><td><p>/simple</p></td>
<td><p>ユーザーによるカスタマイズができないようにする</p></td>
</tr>
<tr class="row-odd"><td><p>/uninstall</p></td>
<td><p>(確認無しで) Python を削除する</p></td>
</tr>
<tr class="row-even"><td><p>/layout [ディレクトリ]</p></td>
<td><p>すべてのコンポーネントを事前にダウンロードする</p></td>
</tr>
<tr class="row-odd"><td><p>/log [ファイル名]</p></td>
<td><p>ログファイルの場所を指定する</p></td>
</tr>
</tbody>
</table>
<p>ほかのすべてのオプションは <code class="docutils literal notranslate"><span class="pre">name=value</span></code> の形で渡します。value は大抵 <code class="docutils literal notranslate"><span class="pre">0</span></code> で機能を無効化、 <code class="docutils literal notranslate"><span class="pre">1</span></code> で機能を有効化、であるとかパスの指定です。利用可能なオプションの完全なリストは以下の通りです。</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>名前</p></th>
<th class="head"><p>説明</p></th>
<th class="head"><p>デフォルト</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>InstallAllUsers</p></td>
<td><p>システムワイドなインストールを実行する。</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>TargetDir</p></td>
<td><p>インストール先ディレクトリ。</p></td>
<td><p>InstallAllUsers に基いて選択されます。</p></td>
</tr>
<tr class="row-even"><td><p>DefaultAllUsersTargetDir</p></td>
<td><p>すべてのユーザ向けインストールのためのデフォルトインストール先ディレクトリ。</p></td>
<td><p><code class="file docutils literal notranslate"><span class="pre">%ProgramFiles%\Python</span> <span class="pre">X.Y</span></code> または <code class="file docutils literal notranslate"><span class="pre">%ProgramFiles(x86)%\Python</span> <span class="pre">X.Y</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>DefaultJustForMeTargetDir</p></td>
<td><p>自分一人用インストールのためのデフォルトインストール先ディレクトリ。</p></td>
<td><p><code class="file docutils literal notranslate"><span class="pre">%LocalAppData%\Programs\Python\PythonXY</span></code> または <code class="file docutils literal notranslate"><span class="pre">%LocalAppData%\Programs\Python\PythonXY-32</span></code> または <code class="file docutils literal notranslate"><span class="pre">%LocalAppData%\Programs\Python\PythonXY-64</span></code></p></td>
</tr>
<tr class="row-even"><td><p>DefaultCustomTargetDir</p></td>
<td><p>カスタムインストールディレクトリとしてデフォルトで GUI に表示される値。</p></td>
<td><p>(空)</p></td>
</tr>
<tr class="row-odd"><td><p>AssociateFiles</p></td>
<td><p>ランチャもインストールする場合に、ファイルの関連付けを行う。</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>CompileAll</p></td>
<td><p>すべての <code class="docutils literal notranslate"><span class="pre">.py</span></code> ファイルをバイトコンパイルして <code class="docutils literal notranslate"><span class="pre">.pyc</span></code> を作る。</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>PrependPath</p></td>
<td><p><span class="target" id="index-70"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PATH</span></code> にインストールディレクトリと Scripts ディレクトリを先頭に追加し、 <span class="target" id="index-71"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PATHEXT</span></code> に <code class="docutils literal notranslate"><span class="pre">.PY</span></code> を追加する。</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>AppendPath</p></td>
<td><p><span class="target" id="index-72"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PATH</span></code> にインストールディレクトリと Scripts ディレクトリを追加し、 <span class="target" id="index-73"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PATHEXT</span></code> に <code class="docutils literal notranslate"><span class="pre">.PY</span></code> を追加する。</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>Shortcuts</p></td>
<td><p>インストールするインタプリタ、ドキュメント、IDLE へのショートカットを作る。</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>Include_doc</p></td>
<td><p>Python マニュアルをインストールする。</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>Include_debug</p></td>
<td><p>デバッグバイナリをインストールする。</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>Include_dev</p></td>
<td><p>開発者用ヘッダーとライブラリをインストールする。これを省略すると、使用不可能なインストールになる可能性があります。</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>Include_exe</p></td>
<td><p><code class="file docutils literal notranslate"><span class="pre">python.exe</span></code> と関連するファイルをインストールする。これを省略すると、使用不可能なインストールになる可能性があります。</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>Include_launcher</p></td>
<td><p><a class="reference internal" href="windows.html#launcher"><span class="std std-ref">Windows の Python ランチャ</span></a> をインストールする。</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>InstallLauncherAllUsers</p></td>
<td><p>すべてのユーザーにランチャーをインストールする。 <code class="docutils literal notranslate"><span class="pre">Include_launcher</span></code> が 1 に設定されている必要があります。</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>Include_lib</p></td>
<td><p>標準ライブラリと拡張モジュールをインストールする。これを省略すると、使用不可能なインストールになる可能性があります。</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>Include_pip</p></td>
<td><p>バンドル版の pip と setuptools をインストールする。</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>Include_symbols</p></td>
<td><p>デバッグシンボル (<code class="docutils literal notranslate"><span class="pre">*.pdb</span></code>) をインストールする。</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>Include_tcltk</p></td>
<td><p>Tcl/Tk サポートと IDLE をインストールする。</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>Include_test</p></td>
<td><p>標準ライブラリのテストスイートをインストールする。</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>Include_tools</p></td>
<td><p>ユーティリティスクリプトをインストールする。</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>LauncherOnly</p></td>
<td><p>ランチャのみをインストールする。これは他のほとんどのオプションを上書きします。</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>SimpleInstall</p></td>
<td><p>最大限のインストーラ GUI を無効にする。</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>SimpleInstallDescription</p></td>
<td><p>単純化されたインストーラ GUI を使う際に表示するカスタムメッセージ。</p></td>
<td><p>(空)</p></td>
</tr>
</tbody>
</table>
<p>例えばデフォルトでシステムワイドな Python インストレーションを静かに行うには、以下コマンドを使えます (コマンドプロンプトより):</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>python-3.9.0.exe /quiet InstallAllUsers=1 PrependPath=1 Include_test=0
</pre></div>
</div>
<p>テストスイートなしの Python のパーソナルなコピーのインストールをユーザに簡単に行わせるには、以下コマンドのショートカットを作れば良いです。これはインストーラの最初のページを単純化して表示し、また、カスタマイズできないようにします:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>python-3.9.0.exe InstallAllUsers=0 Include_launcher=0 Include_test=0
    SimpleInstall=1 SimpleInstallDescription=&quot;Just for me, no test suite.&quot;
</pre></div>
</div>
<p>(ランチャのインストールを省略するとファイルの関連付けも省略されるので、これはランチャインストールを含めたシステムワイドなインストールをした場合のユーザごとインストールに限った場合のお勧めです。)</p>
<p>上でリストしたオプションは、実行ファイルと同じ場所の <code class="docutils literal notranslate"><span class="pre">unattend.xml</span></code> と名付けられたファイルで与えることもできます。このファイルはオプションとその値のリストを指定します。値がアトリビュートとして与えられた場合、それは数値であれば数値に変換されます。エレメントテキストで与える場合は常に文字列のままです。以下は、先の例と同じオプションをセットするファイルの実例です:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;Options&gt;</span>
<span class="w">    </span><span class="nt">&lt;Option</span><span class="w"> </span><span class="na">Name=</span><span class="s">&quot;InstallAllUsers&quot;</span><span class="w"> </span><span class="na">Value=</span><span class="s">&quot;no&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Option</span><span class="w"> </span><span class="na">Name=</span><span class="s">&quot;Include_launcher&quot;</span><span class="w"> </span><span class="na">Value=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Option</span><span class="w"> </span><span class="na">Name=</span><span class="s">&quot;Include_test&quot;</span><span class="w"> </span><span class="na">Value=</span><span class="s">&quot;no&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Option</span><span class="w"> </span><span class="na">Name=</span><span class="s">&quot;SimpleInstall&quot;</span><span class="w"> </span><span class="na">Value=</span><span class="s">&quot;yes&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Option</span><span class="w"> </span><span class="na">Name=</span><span class="s">&quot;SimpleInstallDescription&quot;</span><span class="nt">&gt;</span>Just<span class="w"> </span>for<span class="w"> </span>me,<span class="w"> </span>no<span class="w"> </span>test<span class="w"> </span>suite<span class="nt">&lt;/Option&gt;</span>
<span class="nt">&lt;/Options&gt;</span>
</pre></div>
</div>
</section>
<section id="installing-without-downloading">
<span id="install-layout-option"></span><h3><span class="section-number">4.1.4. </span>ダウンロード不要なインストール<a class="headerlink" href="windows.html#installing-without-downloading" title="Link to this heading">¶</a></h3>
<p>Python のいくつかの機能は最初にダウンロードしたインストーラには含まれていないため、それらの機能をインストールしようと選択するとインターネット接続が必要になります。
インターネット接続が必要にならないように、全てのコンポーネントをすぐにできる限りダウンロードして、完全な <em>配置構成 (layout)</em> を作成し、どんな機能が選択されたかに関わらず、それ以上インターネット接続を必要がないようにします。
この方法のダウンロードサイズは必要以上に大きくなるかもしれませんが、たくさんの回数インストールしようとする場合には、ローカルにキャッシュされたコピーを持つことはとても有用です。</p>
<p>コマンドプロンプトから以下のコマンドを実行して、必要なファイルをできる限り全てダウンロードします。
<code class="docutils literal notranslate"><span class="pre">python-3.9.0.exe</span></code> 部分は実際のインストーラの名前に置き換え、同名のファイルどうしの衝突が起こらないように、個別のディレクトリ内に配置構成を作るのを忘れないようにしてください。</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>python-3.9.0.exe /layout [optional target directory]
</pre></div>
</div>
<p>進捗表示を隠すのに <code class="docutils literal notranslate"><span class="pre">/quiet</span></code> オプションを指定することもできます。</p>
</section>
<section id="modifying-an-install">
<h3><span class="section-number">4.1.5. </span>インストール後の変更<a class="headerlink" href="windows.html#modifying-an-install" title="Link to this heading">¶</a></h3>
<p>いったん Python がインストールされたら、Windows のシステム機能の「プログラムと機能」ツールから機能の追加や削除ができます。Python のエントリを選択して「アンインストールと変更」を選ぶことで、インストーラをメンテナンスモードで開きます。</p>
<p>インストーラ GUI で &quot;Modify&quot; を選ぶと、チェックボックスの選択を変えることで機能の追加削除ができます - チェックボックスの選択を変えなければ、何かがインストールされたり削除されたりはしません。いくつかのオプションはこのモードでは変更することはできません。インストールディレクトリなどです。それらを変えたいのであれば、完全に削除してから再インストールする必要があります。</p>
<p>&quot;Repair&quot; では、現在の設定で本来インストールされるべきすべてのファイルを検証し、削除されていたり更新されていたりするファイルを修正します。</p>
<p>&quot;Uninstall&quot; は Python を完全に削除します。「プログラムと機能」内の自身のエントリを持つ <a class="reference internal" href="windows.html#launcher"><span class="std std-ref">Windows の Python ランチャ</span></a> の例外が起こります。</p>
</section>
</section>
<section id="the-microsoft-store-package">
<span id="windows-store"></span><h2><span class="section-number">4.2. </span>Microsoft ストアパッケージ<a class="headerlink" href="windows.html#the-microsoft-store-package" title="Link to this heading">¶</a></h2>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 3.7.2.</span></p>
</div>
<p>Microsoft ストアパッケージは、例えば生徒が主に対話型で使うことを意図した簡単にインストールできる Python インタプリタです。</p>
<p>このパッケージをインストールするには、最新の Windows 10 のアップデートになっていることを確認し、 Microsoft ストアアプリで &quot;Python 3.12&quot; と検索します。
選んだアプリが Python Software Foundation が公開したものであることを確認して、インストールします。</p>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p>Python は常に Microsoft ストアで無料で利用できます。
もしお金を払うように要求されたなら、正しいパッケージを選んでいません。</p>
</div>
<p>インストールした後は、スタートメニューから Python を見付けて起動するでしょう。
あるいは、 <code class="docutils literal notranslate"><span class="pre">python</span></code> とタイプしてコマンドプロンプトや PowerShell のセッションから使えるでしょう。
さらに、 <code class="docutils literal notranslate"><span class="pre">pip</span></code> や <code class="docutils literal notranslate"><span class="pre">idle</span></code> とタイプして pip あるいは IDLE を利用できます。
IDLE はスタートメニューからも見付けられます。</p>
<p>All three commands are also available with version number suffixes, for
example, as <code class="docutils literal notranslate"><span class="pre">python3.exe</span></code> and <code class="docutils literal notranslate"><span class="pre">python3.x.exe</span></code> as well as
<code class="docutils literal notranslate"><span class="pre">python.exe</span></code> (where <code class="docutils literal notranslate"><span class="pre">3.x</span></code> is the specific version you want to launch,
such as 3.12). Open &quot;Manage App Execution Aliases&quot; through Start to
select which version of Python is associated with each command. It is
recommended to make sure that <code class="docutils literal notranslate"><span class="pre">pip</span></code> and <code class="docutils literal notranslate"><span class="pre">idle</span></code> are consistent with
whichever version of <code class="docutils literal notranslate"><span class="pre">python</span></code> is selected.</p>
<p>仮想環境は <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">venv</span></code> で作成し、有効化して普通に使えます。</p>
<p>既に別のバージョンの Python をインストールして <code class="docutils literal notranslate"><span class="pre">PATH</span></code> 変数に追加してある場合は、 Microsoft ストアのものではない <code class="docutils literal notranslate"><span class="pre">python.exe</span></code> として使えます。
新しくインストールした Python にアクセスするには、 <code class="docutils literal notranslate"><span class="pre">python3.exe</span></code> あるいは <code class="docutils literal notranslate"><span class="pre">python3.x.exe</span></code> として使えます。</p>
<p><code class="docutils literal notranslate"><span class="pre">py.exe</span></code> ランチャーはこの Python のインストールを見つけますが、従来のインストーラーによるインストールを優先します。</p>
<p>Python を除去するには、「設定」を開き「アプリと機能」を使うか、「スタート」にある Python を右クリックしてアンインストールします。
アンインストールでは、この Python に直接インストールした全てのパッケージが除去されますが、仮想環境はどれも除去されません。</p>
<section id="known-issues">
<h3><span class="section-number">4.2.1. </span>既知の問題<a class="headerlink" href="windows.html#known-issues" title="Link to this heading">¶</a></h3>
<section id="redirection-of-local-data-registry-and-temporary-paths">
<h4><span class="section-number">4.2.1.1. </span>Redirection of local data, registry, and temporary paths<a class="headerlink" href="windows.html#redirection-of-local-data-registry-and-temporary-paths" title="Link to this heading">¶</a></h4>
<p>Microsoft ストアアプリの制限により、 Python スクリプトには <span class="target" id="index-74"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">TEMP</span></code> やレジストリのような共有の場所への完全な書き込み権限は無いでしょう。
その代わり、個人用のところへ書き込みます。
スクリプトで共有の場所で変更しなければならない場合は、完全版のインストーラでインストールする必要があります。</p>
<p>At runtime, Python will use a private copy of well-known Windows folders and the registry.
For example, if the environment variable <span class="target" id="index-8"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">%APPDATA%</span></code> is <code class="file docutils literal notranslate"><span class="pre">c:\Users\&lt;user&gt;\AppData\</span></code>,
then when writing to <code class="file docutils literal notranslate"><span class="pre">C:\Users\&lt;user&gt;\AppData\Local</span></code> will write to
<code class="file docutils literal notranslate"><span class="pre">C:\Users\&lt;user&gt;\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\Local\</span></code>.</p>
<p>When reading files, Windows will return the file from the private folder, or if that does not exist, the
real Windows directory. For example reading <code class="file docutils literal notranslate"><span class="pre">C:\Windows\System32</span></code> returns the contents of <code class="file docutils literal notranslate"><span class="pre">C:\Windows\System32</span></code>
plus the contents of <code class="file docutils literal notranslate"><span class="pre">C:\Program</span> <span class="pre">Files\WindowsApps\package_name\VFS\SystemX86</span></code>.</p>
<p>You can find the real path of any existing file using <a class="reference internal" href="../library/os.path.html#os.path.realpath" title="os.path.realpath"><code class="xref py py-func docutils literal notranslate"><span class="pre">os.path.realpath()</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_file</span> <span class="o">=</span> <span class="s1">&#39;C:</span><span class="se">\\</span><span class="s1">Users</span><span class="se">\\</span><span class="s1">example</span><span class="se">\\</span><span class="s1">AppData</span><span class="se">\\</span><span class="s1">Local</span><span class="se">\\</span><span class="s1">test.txt&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">test_file</span><span class="p">)</span>
<span class="go">&#39;C:\\Users\\example\\AppData\\Local\\Packages\\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\\LocalCache\\Local\\test.txt&#39;</span>
</pre></div>
</div>
<p>When writing to the Windows Registry, the following behaviors exist:</p>
<ul class="simple">
<li><p>Reading from <code class="docutils literal notranslate"><span class="pre">HKLM\\Software</span></code> is allowed and results are merged with the <code class="file docutils literal notranslate"><span class="pre">registry.dat</span></code> file in the package.</p></li>
<li><p>Writing to <code class="docutils literal notranslate"><span class="pre">HKLM\\Software</span></code> is not allowed if the corresponding key/value exists, i.e. modifying existing keys.</p></li>
<li><p>Writing to <code class="docutils literal notranslate"><span class="pre">HKLM\\Software</span></code> is allowed as long as a corresponding key/value does not exist in the package
and the user has the correct access permissions.</p></li>
</ul>
<p>For more detail on the technical basis for these limitations, please consult
Microsoft's documentation on packaged full-trust apps, currently available at
<a class="reference external" href="https://docs.microsoft.com/en-us/windows/msix/desktop/desktop-to-uwp-behind-the-scenes">docs.microsoft.com/en-us/windows/msix/desktop/desktop-to-uwp-behind-the-scenes</a></p>
</section>
</section>
</section>
<section id="the-nuget-org-packages">
<span id="windows-nuget"></span><h2><span class="section-number">4.3. </span>nuget.org パッケージ<a class="headerlink" href="windows.html#the-nuget-org-packages" title="Link to this heading">¶</a></h2>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 3.5.2.</span></p>
</div>
<p>nuget.org パッケージはサイズを縮小した Python 環境で、システム全体で使える Python が無い継続的インテグレーションやビルドシステムで使うことを意図しています。
nuget は &quot;.NET のためのパッケージマネージャ&quot; ですが、ビルド時に使うツールを含んだパッケージに対しても非常に上手く動作します。</p>
<p>nuget の使用方法についての最新の情報を得るには <a class="reference external" href="https://www.nuget.org/">nuget.org</a> に行ってください。
ここから先は Python 開発者にとって十分な要約です。</p>
<p><code class="docutils literal notranslate"><span class="pre">nuget.exe</span></code> コマンドラインツールは、例えば curl や PowerShell を使って <code class="docutils literal notranslate"><span class="pre">https://aka.ms/nugetclidl</span></code> から直接ダウンロードできるでしょう。
このツールを次のように使って、 64 bit あるいは 32 bit のマシン向けの最新バージョンの Python がインストールできます:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nuget.exe install python -ExcludeVersion -OutputDirectory .
nuget.exe install pythonx86 -ExcludeVersion -OutputDirectory .
</pre></div>
</div>
<p>特定のバージョンを選択するには、 <code class="docutils literal notranslate"><span class="pre">-Version</span> <span class="pre">3.x.y</span></code> を追加してください。
出力ディレクトリは <code class="docutils literal notranslate"><span class="pre">.</span></code> から変更されることがあり、パッケージはサブディレクトリにインストールされます。
デフォルトではサブディレクトリはパッケージと同じ名前になり、 <code class="docutils literal notranslate"><span class="pre">-ExcludeVersion</span></code> オプションを付けないとこの名前はインストールされたバージョンを含みます。
サブディレクトリの中にはインストールされた Python を含んでいる <code class="docutils literal notranslate"><span class="pre">tools</span></code> ディレクトリがあります:</p>
<div class="highlight-doscon notranslate"><div class="highlight"><pre><span></span><span class="go"># Without -ExcludeVersion</span>
<span class="gp">&gt;</span> .\python.3.5.2\tools\python.exe -V
<span class="go">Python 3.5.2</span>

<span class="go"># With -ExcludeVersion</span>
<span class="gp">&gt;</span> .\python\tools\python.exe -V
<span class="go">Python 3.5.2</span>
</pre></div>
</div>
<p>一般的には、 nuget パッケージはアップグレードできず、より新しいバージョンは横並びにインストールされ、フルパスで参照されます。
そうする代わりに、手動で直接パッケージを削除し、再度インストールすることもできます。
多くの CI システムは、ビルド間でファイルを保存しておかない場合、この作業を自動的に行います。</p>
<p><code class="docutils literal notranslate"><span class="pre">tools</span></code> ディレクトリと同じ場所に <code class="docutils literal notranslate"><span class="pre">build\native</span></code> ディレクトリがあります。
このディレクトリは、インストールされた Python を参照する C++ プロジェクトで使える MSBuild プロパティファイル <code class="docutils literal notranslate"><span class="pre">python.props</span></code> を含みます。
ここに設定を入れると自動的にヘッダを使い、ビルド時にライプラリをインポートします。</p>
<p>The package information pages on nuget.org are
<a class="reference external" href="https://www.nuget.org/packages/python">www.nuget.org/packages/python</a>
for the 64-bit version and <a class="reference external" href="https://www.nuget.org/packages/pythonx86">www.nuget.org/packages/pythonx86</a> for the 32-bit version.</p>
</section>
<section id="the-embeddable-package">
<span id="windows-embeddable"></span><h2><span class="section-number">4.4. </span>埋め込み可能なパッケージ<a class="headerlink" href="windows.html#the-embeddable-package" title="Link to this heading">¶</a></h2>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 3.5.</span></p>
</div>
<p>埋め込み用の配布 (embedded distribution) は、最小限の Python 環境を含んだ ZIP ファイルです。これは、エンドユーザから直接的にアクセスされるのではなく何かアプリケーションの一部として動作することを意図したものです。</p>
<p>展開されると、埋め込み用の配布は、環境変数、システムレジストリの設定、インストールされているパッケージといったユーザのシステムから (ほぼ) 完全に独立しています。
ZIP 内には標準ライブラリがプリコンパイルにより最適化された <code class="docutils literal notranslate"><span class="pre">.pyc</span></code> として含まれ、また、 <code class="docutils literal notranslate"><span class="pre">python3.dll</span></code>, <code class="docutils literal notranslate"><span class="pre">python37.dll</span></code>, <code class="docutils literal notranslate"><span class="pre">python.exe</span></code>, <code class="docutils literal notranslate"><span class="pre">pythonw.exe</span></code> のすべてが入っています。(IDLE のようなすべての依存物を含む) Tcl/tk、pip、Python ドキュメントは含まれていません。</p>
<div class="admonition note">
<p class="admonition-title">注釈</p>
<p>埋め込み用配布には <a class="reference external" href="https://docs.microsoft.com/en-US/cpp/windows/latest-supported-vc-redist#visual-studio-2015-2017-2019-and-2022">Microsoft C Runtime</a> は含まれません。これを提供するのはアプリケーションのインストーラの責務です。そのランタイムは既に以前にユーザのシステムにインストール済みかもしれませんし、Windows Update により自動で更新されているかもしれません。このことはシステムディレクトリに <code class="docutils literal notranslate"><span class="pre">ucrtbase.dll</span></code> があるか探せばわかります。</p>
</div>
<p>サードパーティのパッケージはアプリケーションのインストーラによって、埋め込み用配布と同じ場所にインストールされるべきです。通常の Python インストレーションのように依存性管理に pip を使うことは、この配布ではサポートされません。ですが、ちょっとした注意を払えば、自動更新のために pip を含めて利用することはできるかもしれません。一般的には、ユーザに更新を提供する前に開発者が新しいバージョンとの互換性を保証できるよう、サードパーティーのパッケージはアプリケーションの一部として扱われるべきです (&quot;vendoring&quot;)。</p>
<p>この配布の 2 つのお勧めできるユースケースを、以下で説明します。</p>
<section id="python-application">
<h3><span class="section-number">4.4.1. </span>Python アプリケーション<a class="headerlink" href="windows.html#python-application" title="Link to this heading">¶</a></h3>
<p>Python で記述された、必ずしもユーザにその事実を意識させる必要のないアプリケーションです。埋め込み用配布はこのケースで、インストールパッケージ内に Python のプライベートバージョンを含めるのに使えるでしょう。その事実がどのように透過的であるべきかに依存して (あるいは逆に、どのようにプロフェッショナルにみえるべきか)、2 つの選択肢があります。</p>
<p>ランチャとなる特別な実行ファイルを使うことはちょっとしたコーディングを必要としますが、ユーザにとっては最も透過的なユーザ体験となります。カスタマイズされたランチャでは、何もしなければ Python で実行されるプログラムの明白な目印はありません; アイコンはカスタマイズし、会社名やバージョン情報を指定し、ファイルの関連付けがそれに相応しく振舞うようにできます。ほとんどのケースではカスタムランチャは、ハードコードされたコマンドライン文字列で単純に <code class="docutils literal notranslate"><span class="pre">Py_Main</span></code> を呼び出すので済むはずです。</p>
<p>より簡単なアプローチは、 <code class="docutils literal notranslate"><span class="pre">python.exe</span></code> または <code class="docutils literal notranslate"><span class="pre">pythonw.exe</span></code> を必要なコマンドライン引数とともに直接呼び出すバッチファイルかショートカットを提供することです。この場合、そのアプリケーションは実際の名前ではなく Python であるようにみえるので、ほかに動作している Python プロセスやファイルの関連付けと区別するのにユーザが困るかもしれません。</p>
<p>後者のアプローチではパッケージは、パス上で利用可能であることを保証するために、Python 実行ファイルと同じディレクトリにインストールされるべきです。特別なランチャの場合はアプリケーション起動前に検索パスを指定する機会があるので、パッケージはほかの場所に配置できます。</p>
</section>
<section id="embedding-python">
<h3><span class="section-number">4.4.2. </span>Python の埋め込み<a class="headerlink" href="windows.html#embedding-python" title="Link to this heading">¶</a></h3>
<p>ネイティブコードで書かれ、時々スクリプト言語のようなものを必要とするようなアプリケーションです。Python 埋め込み用の配布はこの目的に使えます。一般的に、アプリケーションの大半がネイティブコード内にあり、一部が <code class="docutils literal notranslate"><span class="pre">python.exe</span></code> を呼び出すか、直接的に <code class="docutils literal notranslate"><span class="pre">python3.dll</span></code> を使います。どちらのケースでも、ロード可能な Python インタプリタを提供するのには、埋め込み用の配布を展開してアプリケーションのインストレーションのサブディレクトリに置くことで十分です。</p>
<p>アプリケーションが使うパッケージは、インタプリタ初期化前に検索パスを指定する機会があるので、任意の場所にインストールできます。また、埋め込み用配布を使うのと通常の Python インストレーションを使うのとでの根本的な違いはありません。</p>
</section>
</section>
<section id="alternative-bundles">
<h2><span class="section-number">4.5. </span>別のバンドル<a class="headerlink" href="windows.html#alternative-bundles" title="Link to this heading">¶</a></h2>
<p>標準の CPython の配布物の他に、追加の機能を持っている修正されたパッケージがあります。以下は人気のあるバージョンとそのキーとなる機能です:</p>
<dl>
<dt><a class="reference external" href="https://www.activestate.com/products/python/">ActivePython</a></dt><dd><p>マルチプラットフォーム互換のインストーラー、ドキュメント、 PyWin32</p>
</dd>
<dt><a class="reference external" href="https://www.anaconda.com/download/">Anaconda</a></dt><dd><p>人気のある (numpy, scipy や pandas のような) 科学系モジュールと、パッケージマネージャ <code class="docutils literal notranslate"><span class="pre">conda</span></code> 。</p>
</dd>
<dt><a class="reference external" href="https://www.enthought.com/edm/">Enthought Deployment Manager</a></dt><dd><p>&quot;次世代の Python 環境とパッケージマネージャー&quot; (&quot;The Next Generation Python Environment and Package Manager&quot;)。</p>
<p>以前は Enthought が Canopy を提供していましたが、これは <a class="reference external" href="https://support.enthought.com/hc/en-us/articles/360038600051-Canopy-GUI-end-of-life-transition-to-the-Enthought-Deployment-Manager-EDM-and-Visual-Studio-Code">2016 年にサポートが終了しました</a>。</p>
</dd>
<dt><a class="reference external" href="https://winpython.github.io/">WinPython</a></dt><dd><p>ビルド済みの科学系パッケージと、パッケージのビルドのためのツールを含む、Windows 固有のディストリビューション。</p>
</dd>
</dl>
<p>これらパッケージは Python や他のライブラリの最新バージョンが含まれるとは限りませんし、コア Python チームはこれらを保守もしませんしサポートもしませんのでご理解ください。</p>
</section>
<section id="configuring-python">
<h2><span class="section-number">4.6. </span>Python を構成する<a class="headerlink" href="windows.html#configuring-python" title="Link to this heading">¶</a></h2>
<p>コマンドプロンプトより便利に Python を実行するために、Windows のデフォルトの環境変数をいくつか変えたいと思うかもしれません。インストーラは <span class="target" id="index-75"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PATH</span></code> と <span class="target" id="index-76"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PATHEXT</span></code> 変数を構成させるオプションを提供してはいますが、これは単独のシステムワイドなインストレーションの場合にだけ頼りになるものです。もしもあなたが定常的に複数バージョンの Python を使うのであれば、 <a class="reference internal" href="windows.html#launcher"><span class="std std-ref">Windows の Python ランチャ</span></a> の利用を検討してください。</p>
<section id="excursus-setting-environment-variables">
<span id="setting-envvars"></span><h3><span class="section-number">4.6.1. </span>補足: 環境変数の設定<a class="headerlink" href="windows.html#excursus-setting-environment-variables" title="Link to this heading">¶</a></h3>
<p>Windows では、環境変数を恒久的にユーザレベルとシステムレベルの両方で設定でき、あるいはコマンドプロンプトから一時的にも設定できます。</p>
<p>一時的に環境変数を設定するには、コマンドプロンプトを開き <strong class="command">set</strong> コマンドを使います:</p>
<div class="highlight-doscon notranslate"><div class="highlight"><pre><span></span><span class="gp">C:\&gt;</span><span class="k">set</span> <span class="nv">PATH</span><span class="p">=</span>C:\Program Files\Python 3.9;<span class="nv">%PATH%</span>
<span class="gp">C:\&gt;</span><span class="k">set</span> <span class="nv">PYTHONPATH</span><span class="p">=</span><span class="nv">%PYTHONPATH%</span>;C:\My_python_lib
<span class="gp">C:\&gt;</span>python
</pre></div>
</div>
<p>これらの変更は、以降に実行される同じコンソール内で実行される任意のコマンドに適用され、また、そのコンソールから開始するすべてのアプリケーションに引き継がれます。</p>
<p>パーセント記号で変数名を囲んだものは既存の変数の値で展開されるので、新しい値を最初にも最後にも追加することができます。 <strong class="program">python.exe</strong> が入っているディレクトリを <span class="target" id="index-77"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PATH</span></code> に追加することは、Python の適切なバージョンが起動するように保証するための一般的な方法です。</p>
<p>デフォルトの環境変数を恒久的に変更するには、「スタート」をクリックして検索ボックスで「環境変数を編集」を検索するか、(コンピュータのプロパティなどから) <span class="guilabel">システムの詳細設定</span> を開いて <span class="guilabel">環境変数の設定</span> ボタンをクリックしてください。これで立ち上がるダイアログで、ユーザ環境変数とシステム環境変数を追加したり修正したりできます。システム変数を変更するにはあなたのマシンへの制限のないアクセス (つまり管理者権限) が必要です。</p>
<div class="admonition note">
<p class="admonition-title">注釈</p>
<p>Windows はシステム変数の <em>後ろに</em> ユーザ変数を結合します。この振る舞いにより <span class="target" id="index-78"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PATH</span></code> の修正時に期待とは異なる結果になることがあります。</p>
<p><span class="target" id="index-79"></span><a class="reference internal" href="cmdline.html#envvar-PYTHONPATH"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYTHONPATH</span></code></a> 変数は Python のすべてのバージョンで使われるので、インストールされているすべての Python バージョンに互換性のあるコードだけがパスの一覧に含まれているのでない限り、これは恒久的な設定をすべきではありません。</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">参考</p>
<dl class="simple">
<dt><a class="reference external" href="https://learn.microsoft.com/ja-jp/windows/win32/procthread/environment-variables">https://learn.microsoft.com/ja-jp/windows/win32/procthread/environment-variables</a></dt><dd><p>Windows の環境変数の概要</p>
</dd>
<dt><a class="reference external" href="https://learn.microsoft.com/ja-jp/windows-server/administration/windows-commands/set_1">https://learn.microsoft.com/ja-jp/windows-server/administration/windows-commands/set_1</a></dt><dd><p>一時的に環境変数を変更するための <code class="docutils literal notranslate"><span class="pre">set</span></code> コマンドについて</p>
</dd>
<dt><a class="reference external" href="https://learn.microsoft.com/ja-jp/windows-server/administration/windows-commands/setx">https://learn.microsoft.com/ja-jp/windows-server/administration/windows-commands/setx</a></dt><dd><p>恒久的に環境変数を変更するための <code class="docutils literal notranslate"><span class="pre">setx</span></code> コマンドについて。</p>
</dd>
</dl>
</div>
</section>
<section id="finding-the-python-executable">
<span id="windows-path-mod"></span><h3><span class="section-number">4.6.2. </span>Python 実行ファイルを見つける<a class="headerlink" href="windows.html#finding-the-python-executable" title="Link to this heading">¶</a></h3>
<div class="versionchanged">
<p><span class="versionmodified changed">バージョン 3.5 で変更.</span></p>
</div>
<p>自動的に作成される Python インタープリタのスタートメニュー項目を使うだけでなく、Python をコマンドプロンプトから起動したいと思うかもしれません。
インストーラにはそのための設定を行うオプションがあります。</p>
<p>インストーラの最初のページに &quot;Add Python to PATH&quot; というラベルのオプションがあり、これを選択するとインストーラはインストール場所を環境変数 <span class="target" id="index-80"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PATH</span></code> に追加します。
<code class="file docutils literal notranslate"><span class="pre">Scripts\</span></code> フォルダの場所も追加されます。
これによりコマンドプロンプトから <strong class="command">python</strong> とタイプしてインタプリタを起動したり、 <strong class="command">pip</strong> とタイプしてパッケージインストーラを起動したりできます。
コマンドラインからの起動なので、スクリプトをコマンドライン引数付きで起動することもできます。
<a class="reference internal" href="cmdline.html#using-on-cmdline"><span class="std std-ref">コマンドライン</span></a> の文章を参照して下さい。</p>
<p>インストール時にこのオプションを有効にしていなかったとしても、インストーラを再度実行して「Modify」を選んで、それを有効にし直せます。あるいはそうせずとも、 <span class="target" id="index-81"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PATH</span></code> 変数は手動で修正できます。 <a class="reference internal" href="windows.html#setting-envvars"><span class="std std-ref">補足: 環境変数の設定</span></a> を参照してください。環境変数 <span class="target" id="index-82"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PATH</span></code> には Python インストールディレクトリを含む必要があります。ほかのエントリとはセミコロンで区切って繋いでください。これの実例は以下のようになります (以下最初の 2 つのエントリは既に存在しているものと仮定しています):</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>C:\WINDOWS\system32;C:\WINDOWS;C:\Program Files\Python 3.9
</pre></div>
</div>
</section>
</section>
<section id="utf-8-mode">
<span id="win-utf8-mode"></span><h2><span class="section-number">4.7. </span>UTF-8 モード<a class="headerlink" href="windows.html#utf-8-mode" title="Link to this heading">¶</a></h2>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 3.7.</span></p>
</div>
<p>Windows still uses legacy encodings for the system encoding (the ANSI Code
Page).  Python uses it for the default encoding of text files (e.g.
<a class="reference internal" href="../library/locale.html#locale.getencoding" title="locale.getencoding"><code class="xref py py-func docutils literal notranslate"><span class="pre">locale.getencoding()</span></code></a>).</p>
<p>This may cause issues because UTF-8 is widely used on the internet
and most Unix systems, including WSL (Windows Subsystem for Linux).</p>
<p>You can use the <a class="reference internal" href="../library/os.html#utf8-mode"><span class="std std-ref">Python UTF-8 Mode</span></a> to change the default text
encoding to UTF-8. You can enable the <a class="reference internal" href="../library/os.html#utf8-mode"><span class="std std-ref">Python UTF-8 Mode</span></a> via
the <code class="docutils literal notranslate"><span class="pre">-X</span> <span class="pre">utf8</span></code> command line option, or the <code class="docutils literal notranslate"><span class="pre">PYTHONUTF8=1</span></code> environment
variable.  See <span class="target" id="index-15"></span><a class="reference internal" href="cmdline.html#envvar-PYTHONUTF8"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYTHONUTF8</span></code></a> for enabling UTF-8 mode, and
<a class="reference internal" href="windows.html#setting-envvars"><span class="std std-ref">補足: 環境変数の設定</span></a> for how to modify environment variables.</p>
<p>When the <a class="reference internal" href="../library/os.html#utf8-mode"><span class="std std-ref">Python UTF-8 Mode</span></a> is enabled, you can still use the
system encoding (the ANSI Code Page) via the &quot;mbcs&quot; codec.</p>
<p>Note that adding <code class="docutils literal notranslate"><span class="pre">PYTHONUTF8=1</span></code> to the default environment variables
will affect all Python 3.7+ applications on your system.
If you have any Python 3.7+ applications which rely on the legacy
system encoding, it is recommended to set the environment variable
temporarily or use the <code class="docutils literal notranslate"><span class="pre">-X</span> <span class="pre">utf8</span></code> command line option.</p>
<div class="admonition note">
<p class="admonition-title">注釈</p>
<p>Even when UTF-8 mode is disabled, Python uses UTF-8 by default
on Windows for:</p>
<ul class="simple">
<li><p>Console I/O including standard I/O (see <span class="target" id="index-16"></span><a class="pep reference external" href="https://peps.python.org/pep-0528/"><strong>PEP 528</strong></a> for details).</p></li>
<li><p>The <a class="reference internal" href="../glossary.html#term-filesystem-encoding-and-error-handler"><span class="xref std std-term">filesystem encoding</span></a>
(see <span class="target" id="index-17"></span><a class="pep reference external" href="https://peps.python.org/pep-0529/"><strong>PEP 529</strong></a> for details).</p></li>
</ul>
</div>
</section>
<section id="python-launcher-for-windows">
<span id="launcher"></span><h2><span class="section-number">4.8. </span>Windows の Python ランチャ<a class="headerlink" href="windows.html#python-launcher-for-windows" title="Link to this heading">¶</a></h2>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 3.3.</span></p>
</div>
<p>Windows の Python ランチャは、異なる Python のバージョンの位置の特定と実行を助けるユーティリティです。スクリプト (またはコマンドライン) で特定の Python のバージョンの設定を与えられると、位置を特定し、そのバージョンを実行します。</p>
<p>環境変数 <span class="target" id="index-83"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PATH</span></code> による方法と違って、このランチャは Python の一番適切なバージョンを、正しく選択します。このランチャはシステムワイドなものよりもユーザごとのインストレーションの方を優先し、また、新しくインストールされた順よりも言語のバージョンを優先します。</p>
<p>ランチャのオリジナルの仕様は <span class="target" id="index-84"></span><a class="pep reference external" href="https://peps.python.org/pep-0397/"><strong>PEP 397</strong></a> にあります。</p>
<section id="getting-started">
<h3><span class="section-number">4.8.1. </span>最初に<a class="headerlink" href="windows.html#getting-started" title="Link to this heading">¶</a></h3>
<section id="from-the-command-line">
<h4><span class="section-number">4.8.1.1. </span>コマンドラインから起動する<a class="headerlink" href="windows.html#from-the-command-line" title="Link to this heading">¶</a></h4>
<div class="versionchanged">
<p><span class="versionmodified changed">バージョン 3.6 で変更.</span></p>
</div>
<p>Python 3.3 とそれ以降のシステムワイドなインストールでは、ランチャーが <span class="target" id="index-85"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PATH</span></code> に追加されます。ランチャーは、入手可能なあらゆる Python のバージョンに互換性があるため、実際にどのバージョンの Python がインストールされているのかは重要ではありません。ランチャーが使えるかを確認するには以下のコマンドをコマンドプロンプトで実行してください:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>py
</pre></div>
</div>
<p>インストールされている最新バージョンの Python が起動するはずです。
通常どおりに終了することもできますし、追加のコマンドライン引数を指定して直接 Python に渡すこともできます。</p>
<p>複数のバージョンの Python (たとえば 3.7 と 3.12) がインストールされている場合は、Python 3.12 が起動することになります。Python 3.7 を起動したいなら、次のコマンドを実行してみてください:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>py -3.7
</pre></div>
</div>
<p>インストールしてある Python 2 の最新バージョンを起動したい場合は、次のコマンドを実行してみてください:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>py -2
</pre></div>
</div>
<p>以下のようなエラーが出るようであれば、ランチャはインストールされていません:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&#39;py&#39; is not recognized as an internal or external command,
operable program or batch file.
</pre></div>
</div>
<p>このコマンド:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>py --list
</pre></div>
</div>
<p>これは、現在インストールされている Python のバージョンを表示します。</p>
<p>The <code class="docutils literal notranslate"><span class="pre">-x.y</span></code> argument is the short form of the <code class="docutils literal notranslate"><span class="pre">-V:Company/Tag</span></code> argument,
which allows selecting a specific Python runtime, including those that may have
come from somewhere other than python.org. Any runtime registered by following
<span class="target" id="index-21"></span><a class="pep reference external" href="https://peps.python.org/pep-0514/"><strong>PEP 514</strong></a> will be discoverable. The <code class="docutils literal notranslate"><span class="pre">--list</span></code> command lists all available
runtimes using the <code class="docutils literal notranslate"><span class="pre">-V:</span></code> format.</p>
<p>When using the <code class="docutils literal notranslate"><span class="pre">-V:</span></code> argument, specifying the Company will limit selection to
runtimes from that provider, while specifying only the Tag will select from all
providers. Note that omitting the slash implies a tag:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># Select any &#39;3.*&#39; tagged runtime
py -V:3

# Select any &#39;PythonCore&#39; released runtime
py -V:PythonCore/

# Select PythonCore&#39;s latest Python 3 runtime
py -V:PythonCore/3
</pre></div>
</div>
<p>The short form of the argument (<code class="docutils literal notranslate"><span class="pre">-3</span></code>) only ever selects from core Python
releases, and not other distributions. However, the longer form (<code class="docutils literal notranslate"><span class="pre">-V:3</span></code>) will
select from any.</p>
<p>The Company is matched on the full string, case-insenitive. The Tag is matched
oneither the full string, or a prefix, provided the next character is a dot or a
hyphen. This allows <code class="docutils literal notranslate"><span class="pre">-V:3.1</span></code> to match <code class="docutils literal notranslate"><span class="pre">3.1-32</span></code>, but not <code class="docutils literal notranslate"><span class="pre">3.10</span></code>. Tags are
sorted using numerical ordering (<code class="docutils literal notranslate"><span class="pre">3.10</span></code> is newer than <code class="docutils literal notranslate"><span class="pre">3.1</span></code>), but are
compared using text (<code class="docutils literal notranslate"><span class="pre">-V:3.01</span></code> does not match <code class="docutils literal notranslate"><span class="pre">3.1</span></code>).</p>
</section>
<section id="virtual-environments">
<h4><span class="section-number">4.8.1.2. </span>仮想環境 (Virtual environments)<a class="headerlink" href="windows.html#virtual-environments" title="Link to this heading">¶</a></h4>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 3.5.</span></p>
</div>
<p>(標準ライブラリの <a class="reference internal" href="../library/venv.html#module-venv" title="venv: Creation of virtual environments."><code class="xref py py-mod docutils literal notranslate"><span class="pre">venv</span></code></a> モジュールか外部ツール <code class="docutils literal notranslate"><span class="pre">virtualenv</span></code> で作った) 仮想環境がアクティブな状態で Python の明示的なバージョンを指定せずにランチャを起動すると、ランチャはグローバルなインタプリタではなくその仮想環境のものを実行します。グローバルなほうのインタプリタを実行するには、仮想環境の動作を停止するか、または明示的にグローバルな Python バージョンを指定してください。</p>
</section>
<section id="from-a-script">
<h4><span class="section-number">4.8.1.3. </span>スクリプトから起動する<a class="headerlink" href="windows.html#from-a-script" title="Link to this heading">¶</a></h4>
<p>テスト用の Python スクリプトを作成しましょう。<code class="docutils literal notranslate"><span class="pre">hello.py</span></code> という名前で以下の内容のファイルを作成してください</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="ch">#! python</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;hello from Python </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">version</span><span class="p">,))</span>
</pre></div>
</div>
<p>hello.py が存在するディレクトリで、下記コマンドを実行してください:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>py hello.py
</pre></div>
</div>
<p>インストールされている最新の Python 2.x のバージョン番号が表示されるはずです。では、1行目を以下のように変更してみてください:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="ch">#! python3</span>
</pre></div>
</div>
<p>コマンドを再実行すると、今度は最新の Python 3.x の情報が表示されるはずです。これまでのコマンドラインの例と同様に、より細かいバージョン修飾子を指定することもできます。Python 3.7 がインストールされている場合、最初の行を <code class="docutils literal notranslate"><span class="pre">#!</span> <span class="pre">python3.7</span></code> に変更すると、3.7 のバージョン情報が表示されるはずです。</p>
<p>コマンドからの呼び出しとは異なり、後ろに何もつかない &quot;python&quot; はインストールされている Python2.x の最新バージョンを利用することに注意してください。これは後方互換性と、 <code class="docutils literal notranslate"><span class="pre">python</span></code> が一般的に Python 2 を指すUnix との互換性のためです。</p>
</section>
<section id="from-file-associations">
<h4><span class="section-number">4.8.1.4. </span>ファイルの関連付けから起動する<a class="headerlink" href="windows.html#from-file-associations" title="Link to this heading">¶</a></h4>
<p>インストール時に、ランチャは Python ファイル (すなわち <code class="docutils literal notranslate"><span class="pre">.py</span></code>, <code class="docutils literal notranslate"><span class="pre">.pyw</span></code>, <code class="docutils literal notranslate"><span class="pre">.pyc</span></code> ファイル) に関連付けられたはずです。そのため、これらのファイルを Windows のエクスプローラーでダブルクリックした際はランチャが使われ、上で述べたのと同じ機能を使ってスクリプトが使われるべきバージョンを指定できるようになります。</p>
<p>このことによる重要な利点は、単一のランチャが先頭行の内容によって複数の Python バージョンを同時にサポートできることです。</p>
</section>
</section>
<section id="shebang-lines">
<h3><span class="section-number">4.8.2. </span>シェバン (shebang) 行<a class="headerlink" href="windows.html#shebang-lines" title="Link to this heading">¶</a></h3>
<p>スクリプトファイルの先頭の行が <code class="docutils literal notranslate"><span class="pre">#!</span></code> で始まっている場合は、その行はシェバン (shebang) 行として知られています。
Linux や他の Unix 系 OS はこうした行をもともとサポートしているため、それらのシステムでは、スクリプトがどのように実行されるかを示すために広く使われます。
Windows の Python ランチャは、Windows 上の Python スクリプトが同じ機能を使用できるようにし、上の例ではそれらの機能の使用法を示しています。</p>
<p>Python スクリプトのシェバン行を Unix-Windows 間で移植可能にするため、このランチャは、どのインタプリタが使われるかを指定するための大量の '仮想' コマンドをサポートしています。サポートされる仮想コマンドには以下のものがあります:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">/usr/bin/env</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">/usr/bin/python</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">/usr/local/bin/python</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">python</span></code></p></li>
</ul>
<p>具体的に、もしスクリプトの1行目が</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="ch">#! /usr/bin/python</span>
</pre></div>
</div>
<p>The default Python will be located and used.  As many Python scripts written
to work on Unix will already have this line, you should find these scripts can
be used by the launcher without modification.  If you are writing a new script
on Windows which you hope will be useful on Unix, you should use one of the
shebang lines starting with <code class="docutils literal notranslate"><span class="pre">/usr</span></code>.</p>
<p>Any of the above virtual commands can be suffixed with an explicit version
(either just the major version, or the major and minor version).
Furthermore the 32-bit version can be requested by adding &quot;-32&quot; after the
minor version. I.e. <code class="docutils literal notranslate"><span class="pre">/usr/bin/python3.7-32</span></code> will request usage of the
32-bit python 3.7.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 3.7: </span>python ランチャの 3.7 からは、末尾に &quot;-64&quot; を付けて 64-bit 版を要求できます。
さらに、マイナーバージョン無しのメジャーバージョンとアーキテクチャだけ (例えば、 <code class="docutils literal notranslate"><span class="pre">/usr/bin/python3-64</span></code>) で指定できます。</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">バージョン 3.11 で変更: </span>The &quot;-64&quot; suffix is deprecated, and now implies &quot;any architecture that is
not provably i386/32-bit&quot;. To request a specific environment, use the new
<code class="samp docutils literal notranslate"><span class="pre">-V:</span><em><span class="pre">TAG</span></em></code> argument with the complete tag.</p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">/usr/bin/env</span></code> form of shebang line has one further special property.
Before looking for installed Python interpreters, this form will search the
executable <span class="target" id="index-22"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PATH</span></code> for a Python executable matching the name provided
as the first argument. This corresponds to the behaviour of the Unix <code class="docutils literal notranslate"><span class="pre">env</span></code>
program, which performs a <span class="target" id="index-23"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PATH</span></code> search.
If an executable matching the first argument after the <code class="docutils literal notranslate"><span class="pre">env</span></code> command cannot
be found, but the argument starts with <code class="docutils literal notranslate"><span class="pre">python</span></code>, it will be handled as
described for the other virtual commands.
The environment variable <span class="target" id="index-24"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYLAUNCHER_NO_SEARCH_PATH</span></code> may be set
(to any value) to skip this search of <span class="target" id="index-25"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PATH</span></code>.</p>
<p>Shebang lines that do not match any of these patterns are looked up in the
<code class="docutils literal notranslate"><span class="pre">[commands]</span></code> section of the launcher's <a class="reference internal" href="windows.html#launcher-ini"><span class="std std-ref">.INI file</span></a>.
This may be used to handle certain commands in a way that makes sense for your
system. The name of the command must be a single argument (no spaces in the
shebang executable), and the value substituted is the full path to the
executable (additional arguments specified in the .INI will be quoted as part
of the filename).</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[commands]</span>
<span class="na">/bin/xpython</span><span class="o">=</span><span class="s">C:\Program Files\XPython\python.exe</span>
</pre></div>
</div>
<p>Any commands not found in the .INI file are treated as <strong>Windows</strong> executable
paths that are absolute or relative to the directory containing the script file.
This is a convenience for Windows-only scripts, such as those generated by an
installer, since the behavior is not compatible with Unix-style shells.
These paths may be quoted, and may include multiple arguments, after which the
path to the script and any additional arguments will be appended.</p>
</section>
<section id="arguments-in-shebang-lines">
<h3><span class="section-number">4.8.3. </span>シェバン行の引数<a class="headerlink" href="windows.html#arguments-in-shebang-lines" title="Link to this heading">¶</a></h3>
<p>シェバン行では Python インタプリタに渡される追加の引数を指定することもできます。たとえば、シェバン行に以下のように書かれているとしましょう:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="ch">#! /usr/bin/python -v</span>
</pre></div>
</div>
<p>この場合、Python は <code class="docutils literal notranslate"><span class="pre">-v</span></code> オプション付きで起動するでしょう</p>
</section>
<section id="customization">
<h3><span class="section-number">4.8.4. </span>カスタマイズ<a class="headerlink" href="windows.html#customization" title="Link to this heading">¶</a></h3>
<section id="customization-via-ini-files">
<span id="launcher-ini"></span><h4><span class="section-number">4.8.4.1. </span>INI ファイルによるカスタマイズ<a class="headerlink" href="windows.html#customization-via-ini-files" title="Link to this heading">¶</a></h4>
<p>ランチャは2つの .ini ファイルを探しに行きます。具体的には、現在のユーザーのアプリケーションデータディレクトリ (<code class="docutils literal notranslate"><span class="pre">%LOCALAPPDATA%</span></code> または <code class="docutils literal notranslate"><span class="pre">$env:LocalAppData</span></code>) の <code class="docutils literal notranslate"><span class="pre">py.ini</span></code> と、ランチャと同じディレクトリにある <code class="docutils literal notranslate"><span class="pre">py.ini</span></code> です。'コンソール' 版のランチャ (つまり py.exe) と 'Windows' 版のランチャ (つまり pyw.exe) は同一の .ini ファイルを使用します。</p>
<p>&quot;application data&quot; ディレクトリで指定された設定は、実行ファイルの隣にあるものより優先されます。そのため、ランチャの隣にある .ini ファイルへの書き込みアクセスができないユーザは、グローバルな .ini ファイル内のコマンドを上書き (override) できます。</p>
</section>
<section id="customizing-default-python-versions">
<h4><span class="section-number">4.8.4.2. </span>デフォルトのPythonバージョンのカスタマイズ<a class="headerlink" href="windows.html#customizing-default-python-versions" title="Link to this heading">¶</a></h4>
<p>どのバージョンの Python をコマンドで使用するかを定めるため、バージョン修飾子がコマンドに含められることがあります。
バージョン修飾子はメジャーバージョン番号で始まり、オプションのピリオド ('.') とマイナーバージョン指定子がそれに続きます。
さらに、 &quot;-32&quot; や &quot;-64&quot; を追記して 32-bit あるいは 64-bit のどちらの実装が要求されるかを指示できます。</p>
<p>たとえば、<code class="docutils literal notranslate"><span class="pre">#!python</span></code> というシェバン行はバージョン修飾子を含みませんが、<code class="docutils literal notranslate"><span class="pre">#!python3</span></code> はメジャーバージョンを指定するバージョン修飾子を含みます。</p>
<p>コマンドにバージョン修飾子が見つからない場合、環境変数 <span class="target" id="index-86"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PY_PYTHON</span></code> を設定して、デフォルトのバージョン修飾子を指定できます。
設定されていない場合、デフォルト値は &quot;3&quot; です。
この変数には &quot;3&quot;, &quot;3.7&quot;, &quot;3.7-32&quot;, &quot;3.7-64&quot; のような任意の値をコマンドラインから指定できます。
(&quot;-64&quot; オプションは Python 3.7 以降のランチャでしか使えないことに注意してください。)</p>
<p>マイナーバージョン修飾子が見つからない場合、環境変数 <code class="docutils literal notranslate"><span class="pre">PY_PYTHON{major}</span></code> (ここで <code class="docutils literal notranslate"><span class="pre">{major}</span></code> は、上記で決定された現在のメジャーバージョン修飾子) を設定して完全なバージョンを指定することができます。そういったオプションが見つからなければ、ランチャはインストール済みの Python バージョンを列挙して、見つかったそのメジャーバージョン向けマイナーリリースのうち最新のものを使用します。保証されているわけではありませんが、通常はそのメジャーバージョン系で最も後にインストールしたバージョンになります。</p>
<p>64-bit Windows で、同一の (major.minor) Python バージョンの 32-bit と 64-bit の両方の実装がインストールされていた場合、64-bit バージョンのほうが常に優先されます。これはランチャが 32-bit と 64-bit のどちらでも言えることで、32-bit のランチャは、指定されたバージョンが使用可能であれば、64-bit の Python を優先して実行します。これは、どのバージョンが PC にインストールされているかのみでランチャの挙動を予見でき、それらがインストールされた順番に関係なくなる (つまり最後にインストールされた Python とランチャが 32-bit か 64-bit かを知らなくともよい) ようにするためです。上に記したとおり、オプションの &quot;-32&quot;, &quot;-64&quot; サフィックスでこの挙動を変更できます。</p>
<p>例:</p>
<ul class="simple">
<li><p>関連するオプションが設定されていない場合、<code class="docutils literal notranslate"><span class="pre">python</span></code> および <code class="docutils literal notranslate"><span class="pre">python2</span></code> コマンドはインストールされている最新の Python 2.x バージョンを使用し、<code class="docutils literal notranslate"><span class="pre">python3</span></code> コマンドはインストールされている最新の Python 3.x を使用します。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">python3.7</span></code> コマンドは、バージョンが完全に指定されているため、全くオプションを参照しません。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PY_PYTHON=3</span></code> の場合、<code class="docutils literal notranslate"><span class="pre">python</span></code> および <code class="docutils literal notranslate"><span class="pre">python3</span></code> コマンドはともにインストールされている最新の Python 3 を使用します。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PY_PYTHON=3.7-32</span></code> の場合、<code class="docutils literal notranslate"><span class="pre">python</span></code> コマンドは 32-bit 版の 3.7 を使用しますが、<code class="docutils literal notranslate"><span class="pre">python3</span></code> コマンドはインストールされている最新の Python を使用します (メジャーバージョンが指定されているため、PY_PYTHON は全く考慮されません。)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PY_PYTHON=3</span></code> で <code class="docutils literal notranslate"><span class="pre">PY_PYTHON3=3.7</span></code> の場合、<code class="docutils literal notranslate"><span class="pre">python</span></code> および <code class="docutils literal notranslate"><span class="pre">python3</span></code> はどちらも 3.7 を使用します</p></li>
</ul>
<p>環境変数に加え、同じ設定をランチャが使う INI ファイルで構成することができます。INI ファイルの該当するセクションは <code class="docutils literal notranslate"><span class="pre">[defaults]</span></code> と呼ばれ、キー名は環境変数のキー名から <code class="docutils literal notranslate"><span class="pre">PY_</span></code> という接頭辞を取ったものと同じです (INI ファイルのキー名は大文字小文字を区別しないことにご注意ください)。環境変数の内容は INI ファイルでの指定を上書きします。</p>
<p>例えば:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">PY_PYTHON=3.7</span></code> と設定することは、INI ファイルに下記が含まれることと等価です:</p></li>
</ul>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[defaults]</span>
<span class="na">python</span><span class="o">=</span><span class="s">3.7</span>
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">PY_PYTHON=3</span></code> と <code class="docutils literal notranslate"><span class="pre">PY_PYTHON3=3.7</span></code> を設定することは、INI ファイルに下記が含まれることと等価です:</p></li>
</ul>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[defaults]</span>
<span class="na">python</span><span class="o">=</span><span class="s">3</span>
<span class="na">python3</span><span class="o">=</span><span class="s">3.7</span>
</pre></div>
</div>
</section>
</section>
<section id="diagnostics">
<h3><span class="section-number">4.8.5. </span>診断<a class="headerlink" href="windows.html#diagnostics" title="Link to this heading">¶</a></h3>
<p>環境変数 <span class="target" id="index-87"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYLAUNCHER_DEBUG</span></code> が設定されていたら (設定値が何であっても)、ランチャは診断情報を stderr (つまりコンソール) に出力します。この情報のメッセージは詳細で <em>しかも</em> きついものですが、どういったバージョンの Python が検知されたか、なぜ特定のバージョンが選択されたか、そして、対象の Python を実行するのに使われた正確なコマンドラインを教えてくれます。これは主にテストやデバッグのためのものです。</p>
</section>
<section id="dry-run">
<h3><span class="section-number">4.8.6. </span>Dry Run<a class="headerlink" href="windows.html#dry-run" title="Link to this heading">¶</a></h3>
<p>If an environment variable <span class="target" id="index-28"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYLAUNCHER_DRYRUN</span></code> is set (to any value),
the launcher will output the command it would have run, but will not actually
launch Python. This may be useful for tools that want to use the launcher to
detect and then launch Python directly. Note that the command written to
standard output is always encoded using UTF-8, and may not render correctly in
the console.</p>
</section>
<section id="install-on-demand">
<h3><span class="section-number">4.8.7. </span>Install on demand<a class="headerlink" href="windows.html#install-on-demand" title="Link to this heading">¶</a></h3>
<p>If an environment variable <span class="target" id="index-29"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYLAUNCHER_ALLOW_INSTALL</span></code> is set (to any
value), and the requested Python version is not installed but is available on
the Microsoft Store, the launcher will attempt to install it. This may require
user interaction to complete, and you may need to run the command again.</p>
<p>An additional <span class="target" id="index-30"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYLAUNCHER_ALWAYS_INSTALL</span></code> variable causes the launcher
to always try to install Python, even if it is detected. This is mainly intended
for testing (and should be used with <span class="target" id="index-31"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYLAUNCHER_DRYRUN</span></code>).</p>
</section>
<section id="return-codes">
<h3><span class="section-number">4.8.8. </span>Return codes<a class="headerlink" href="windows.html#return-codes" title="Link to this heading">¶</a></h3>
<p>The following exit codes may be returned by the Python launcher. Unfortunately,
there is no way to distinguish these from the exit code of Python itself.</p>
<p>The names of codes are as used in the sources, and are only for reference. There
is no way to access or resolve them apart from reading this page. Entries are
listed in alphabetical order of names.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>名前</p></th>
<th class="head"><p>値</p></th>
<th class="head"><p>説明</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>RC_BAD_VENV_CFG</p></td>
<td><p>107</p></td>
<td><p>A <code class="file docutils literal notranslate"><span class="pre">pyvenv.cfg</span></code> was found but is corrupt.</p></td>
</tr>
<tr class="row-odd"><td><p>RC_CREATE_PROCESS</p></td>
<td><p>101</p></td>
<td><p>Failed to launch Python.</p></td>
</tr>
<tr class="row-even"><td><p>RC_INSTALLING</p></td>
<td><p>111</p></td>
<td><p>An install was started, but the command will
need to be re-run after it completes.</p></td>
</tr>
<tr class="row-odd"><td><p>RC_INTERNAL_ERROR</p></td>
<td><p>109</p></td>
<td><p>Unexpected error. Please report a bug.</p></td>
</tr>
<tr class="row-even"><td><p>RC_NO_COMMANDLINE</p></td>
<td><p>108</p></td>
<td><p>Unable to obtain command line from the
operating system.</p></td>
</tr>
<tr class="row-odd"><td><p>RC_NO_PYTHON</p></td>
<td><p>103</p></td>
<td><p>Unable to locate the requested version.</p></td>
</tr>
<tr class="row-even"><td><p>RC_NO_VENV_CFG</p></td>
<td><p>106</p></td>
<td><p>A <code class="file docutils literal notranslate"><span class="pre">pyvenv.cfg</span></code> was required but not
found.</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="finding-modules">
<span id="windows-finding-modules"></span><h2><span class="section-number">4.9. </span>モジュールの検索<a class="headerlink" href="windows.html#finding-modules" title="Link to this heading">¶</a></h2>
<p>These notes supplement the description at <a class="reference internal" href="../library/sys_path_init.html#sys-path-init"><span class="std std-ref">sys.path モジュール検索パスの初期化</span></a> with
detailed Windows notes.</p>
<p><code class="docutils literal notranslate"><span class="pre">._pth</span></code> ファイルが見付からなかったときは、 Windows では <a class="reference internal" href="../library/sys.html#sys.path" title="sys.path"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.path</span></code></a> は次のように設定されます:</p>
<ul class="simple">
<li><p>最初に空のエントリが追加されます。これはカレントディレクトリを指しています。</p></li>
<li><p>その次に、 <span class="target" id="index-88"></span><a class="reference internal" href="cmdline.html#envvar-PYTHONPATH"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYTHONPATH</span></code></a> 環境変数が存在するとき、 <a class="reference internal" href="cmdline.html#using-on-envvars"><span class="std std-ref">環境変数</span></a> で解説されているように追加されます。 Windows ではドライブ識別子 (<code class="docutils literal notranslate"><span class="pre">C:\</span></code> など)と区別するために、この環境変数に含まれるパスの区切り文字はセミコロンでなければならない事に注意してください。</p></li>
<li><p>追加で &quot;アプリケーションのパス&quot; を <code class="docutils literal notranslate"><span class="pre">HKEY_CURRENT_USER</span></code> か <code class="docutils literal notranslate"><span class="pre">HKEY_LOCAL_MACHINE</span></code> の中の <code class="samp docutils literal notranslate"><span class="pre">\SOFTWARE\Python\PythonCore{version}\PythonPath</span></code> のサブキーとして登録することができます。サブキーはデフォルト値としてセミコロンで区切られたパス文字列を持つことができ、書くパスが <a class="reference internal" href="../library/sys.html#sys.path" title="sys.path"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.path</span></code></a> に追加されます。 (既存のインストーラーはすべて HKLM しか利用しないので、 HKCU は通常空です)</p></li>
<li><p><span class="target" id="index-89"></span><a class="reference internal" href="cmdline.html#envvar-PYTHONHOME"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYTHONHOME</span></code></a> が設定されている場合、それが &quot;Python Home&quot; として扱われます。
それ以外の場合、 &quot;Python Home&quot; を推定するために Python の実行ファイルのパスから &quot;目印ファイル&quot; (<code class="docutils literal notranslate"><span class="pre">Lib\os.py</span></code> または <code class="docutils literal notranslate"><span class="pre">pythonXY.zip</span></code>) が探されます。
Python home が見つかった場合、そこからいくつかのサブディレクトリ (<code class="docutils literal notranslate"><span class="pre">Lib</span></code>, <code class="docutils literal notranslate"><span class="pre">plat-win</span></code> など) が <a class="reference internal" href="../library/sys.html#sys.path" title="sys.path"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.path</span></code></a> に追加されます。
見つからなかった場合、コアとなる Python path はレジストリに登録された PythonPath から構築されます。</p></li>
<li><p>Python Home が見つからず、環境変数 <span class="target" id="index-90"></span><a class="reference internal" href="cmdline.html#envvar-PYTHONPATH"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYTHONPATH</span></code></a> が指定されず、レジストリエントリが見つからなかった場合、関連するデフォルトのパスが利用されます (例: <code class="docutils literal notranslate"><span class="pre">.\Lib;.\plat-win</span></code> など)。</p></li>
</ul>
<p>メインの実行ファイルと同じ場所か一つ上のディレクトリに <code class="docutils literal notranslate"><span class="pre">pyvenv.cfg</span></code> がある場合、以下の異なった規則が適用されます:</p>
<ul class="simple">
<li><p><span class="target" id="index-91"></span><a class="reference internal" href="cmdline.html#envvar-PYTHONHOME"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYTHONHOME</span></code></a> が設定されておらず、 <code class="docutils literal notranslate"><span class="pre">home</span></code> が絶対パスの場合、home 推定の際メインの実行ファイルから推定するのではなくこのパスを使います。</p></li>
</ul>
<p>結果としてこうなります:</p>
<ul class="simple">
<li><p><code class="file docutils literal notranslate"><span class="pre">python.exe</span></code> かそれ以外の Python ディレクトリにある .exe ファイルを実行したとき (インストールされている場合でも PCbuild から直接実行されている場合でも) core path が利用され、レジストリ内の core path は無視されます。それ以外のレジストリの &quot;application paths&quot; は常に読み込まれます。</p></li>
<li><p>Python が他の .exe ファイル (他のディレクトリに存在する場合や、COM経由で組み込まれる場合など) にホストされている場合は、 &quot;Python Home&quot; は推定されず、レジストリにある core path が利用されます。それ以外のレジストリの &quot;application paths&quot; は常に読み込まれます。</p></li>
<li><p>Python がその home を見つけられず、レジストリの値もない場合 (これはいくつかのとてもおかしなインストレーションセットアップの凍結された .exe)、パスは最小限のデフォルトとして相対パスが使われます。</p></li>
</ul>
<p>自身のアプリケーションや配布物に Python をバンドルしたい場合には、以下の助言 (のいずれかまたは組合せ) によりほかのインストレーションとの衝突を避けることができます:</p>
<ul class="simple">
<li><p>Include a <code class="docutils literal notranslate"><span class="pre">._pth</span></code> file alongside your executable containing the
directories to include. This will ignore paths listed in the registry and
environment variables, and also ignore <a class="reference internal" href="../library/site.html#module-site" title="site: Module responsible for site-specific configuration."><code class="xref py py-mod docutils literal notranslate"><span class="pre">site</span></code></a> unless <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">site</span></code> is
listed.</p></li>
<li><p>If you are loading <code class="file docutils literal notranslate"><span class="pre">python3.dll</span></code> or <code class="file docutils literal notranslate"><span class="pre">python37.dll</span></code> in your own
executable, explicitly call <a class="reference internal" href="../c-api/init.html#c.Py_SetPath" title="Py_SetPath"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_SetPath()</span></code></a> or (at least)
<a class="reference internal" href="../c-api/init.html#c.Py_SetProgramName" title="Py_SetProgramName"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_SetProgramName()</span></code></a> before <a class="reference internal" href="../c-api/init.html#c.Py_Initialize" title="Py_Initialize"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_Initialize()</span></code></a>.</p></li>
<li><p>自身のアプリケーションから <code class="file docutils literal notranslate"><span class="pre">python.exe</span></code> を起動する前に、 <span class="target" id="index-92"></span><a class="reference internal" href="cmdline.html#envvar-PYTHONPATH"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYTHONPATH</span></code></a> をクリアしたり上書きし、 <span class="target" id="index-93"></span><a class="reference internal" href="cmdline.html#envvar-PYTHONHOME"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYTHONHOME</span></code></a> をセットしてください。</p></li>
<li><p>If you cannot use the previous suggestions (for example, you are a
distribution that allows people to run <code class="file docutils literal notranslate"><span class="pre">python.exe</span></code> directly), ensure
that the landmark file (<code class="file docutils literal notranslate"><span class="pre">Lib\os.py</span></code>) exists in your install directory.
(Note that it will not be detected inside a ZIP file, but a correctly named
ZIP file will be detected instead.)</p></li>
</ul>
<p>これらはシステムワイドにインストールされたファイルが、あなたのアプリケーションにバンドルされた標準ライブラリのコピーに優先しないようにします。これをしなければあなたのアプリケーションのユーザは、何かしら問題を抱えるかもしれません。上で列挙した最初の提案が最善です。ほかのものはレジストリ内の非標準のパスやユーザの site-packages の影響を少し受けやすいからです。</p>
<div class="versionchanged">
<p><span class="versionmodified changed">バージョン 3.6 で変更: </span>Add <code class="docutils literal notranslate"><span class="pre">._pth</span></code> file support and removes <code class="docutils literal notranslate"><span class="pre">applocal</span></code> option from
<code class="docutils literal notranslate"><span class="pre">pyvenv.cfg</span></code>.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">バージョン 3.6 で変更: </span>Add <code class="file docutils literal notranslate"><span class="pre">python</span><em><span class="pre">XX</span></em><span class="pre">.zip</span></code> as a potential landmark when directly adjacent
to the executable.</p>
</div>
<div class="deprecated">
<p><span class="versionmodified deprecated">バージョン 3.6 で非推奨: </span>Modules specified in the registry under <code class="docutils literal notranslate"><span class="pre">Modules</span></code> (not <code class="docutils literal notranslate"><span class="pre">PythonPath</span></code>)
may be imported by <a class="reference internal" href="../library/importlib.html#importlib.machinery.WindowsRegistryFinder" title="importlib.machinery.WindowsRegistryFinder"><code class="xref py py-class docutils literal notranslate"><span class="pre">importlib.machinery.WindowsRegistryFinder</span></code></a>.
This finder is enabled on Windows in 3.6.0 and earlier, but may need to
be explicitly added to <a class="reference internal" href="../library/sys.html#sys.meta_path" title="sys.meta_path"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.meta_path</span></code></a> in the future.</p>
</div>
</section>
<section id="additional-modules">
<h2><span class="section-number">4.10. </span>追加のモジュール<a class="headerlink" href="windows.html#additional-modules" title="Link to this heading">¶</a></h2>
<p>Python は全プラットフォーム互換を目指していますが、 Windows にしかないユニークな機能もあります。標準ライブラリと外部のライブラリの両方で、幾つかのモジュールと、そういった機能を使うためのスニペットがあります。</p>
<p>Windows 固有の標準モジュールは、 <a class="reference internal" href="../library/windows.html#mswin-specific-services"><span class="std std-ref">MS Windows 固有のサービス</span></a> に書かれています。</p>
<section id="pywin32">
<h3><span class="section-number">4.10.1. </span>PyWin32<a class="headerlink" href="windows.html#pywin32" title="Link to this heading">¶</a></h3>
<p>The <a class="reference external" href="https://pypi.org/project/PyWin32/">PyWin32</a> module by Mark Hammond
is a collection of modules for advanced Windows-specific support.  This includes
utilities for:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.microsoft.com/en-us/windows/win32/com/component-object-model--com--portal">Component Object Model</a>
(COM)</p></li>
<li><p>Win32 API 呼び出し</p></li>
<li><p>レジストリ</p></li>
<li><p>イベントログ</p></li>
<li><p><a class="reference external" href="https://docs.microsoft.com/en-us/cpp/mfc/mfc-desktop-applications">Microsoft Foundation Classes</a> (MFC) ユーザーインターフェイス</p></li>
</ul>
<p><a class="reference external" href="https://web.archive.org/web/20060524042422/https://www.python.org/windows/pythonwin/">PythonWin</a> は PyWin32 に付属している、サンプルのMFCアプリケーションです。これはビルトインのデバッガを含む、組み込み可能なIDEです。</p>
<div class="admonition seealso">
<p class="admonition-title">参考</p>
<dl class="simple">
<dt><a class="reference external" href="http://timgolden.me.uk/python/win32_how_do_i.html">Win32 How Do I...?</a></dt><dd><p>by Tim Golden</p>
</dd>
<dt><a class="reference external" href="https://www.boddie.org.uk/python/COM.html">Python and COM</a></dt><dd><p>by David and Paul Boddie</p>
</dd>
</dl>
</div>
</section>
<section id="cx-freeze">
<h3><span class="section-number">4.10.2. </span>cx_Freeze<a class="headerlink" href="windows.html#cx-freeze" title="Link to this heading">¶</a></h3>
<p><a class="reference external" href="https://cx-freeze.readthedocs.io/en/latest/">cx_Freeze</a>
wraps Python scripts into executable Windows programs
(<code class="file docutils literal notranslate"><em><span class="pre">*</span></em><span class="pre">.exe</span></code> files).  When you have done this, you can distribute your
application without requiring your users to install Python.</p>
</section>
</section>
<section id="compiling-python-on-windows">
<h2><span class="section-number">4.11. </span>Windows 上で Python をコンパイルする<a class="headerlink" href="windows.html#compiling-python-on-windows" title="Link to this heading">¶</a></h2>
<p>CPython を自分でコンパイルしたい場合、最初にすべきことは <a class="reference external" href="https://www.python.org/downloads/source/">ソース</a> を取得することです。最新リリース版のソースか、新しい <a class="reference external" href="https://devguide.python.org/setup/#get-the-source-code">チェックアウト</a> をダウンロードできます。</p>
<p>ソースツリーには Microsoft Visual Studio でのビルドのソリューションファイルとプロジェクトファイルが含まれていて、これが公式の Python リリースに使われているコンパイラです。これらファイルは <code class="file docutils literal notranslate"><span class="pre">PCbuild</span></code> ディレクトリ内にあります。</p>
<p>ビルドプロセスについての一般的な情報は、<code class="file docutils literal notranslate"><span class="pre">PCbuild/readme.txt</span></code> にあります。</p>
<p>拡張モジュールについては、 <a class="reference internal" href="../extending/windows.html#building-on-windows"><span class="std std-ref">Windows 上での C および C++ 拡張モジュールのビルド</span></a> を参照してください。</p>
</section>
<section id="other-platforms">
<h2><span class="section-number">4.12. </span>ほかのプラットフォーム<a class="headerlink" href="windows.html#other-platforms" title="Link to this heading">¶</a></h2>
<p>Python の継続的な開発の中で、過去にサポートされていた幾つかのプラットフォームが (ユーザーや開発者の不足のために) サポートされなくなっています。すべてのサポートされないプラットフォームについての詳細は <span class="target" id="index-94"></span><a class="pep reference external" href="https://peps.python.org/pep-0011/"><strong>PEP 11</strong></a> をチェックしてください。</p>
<ul class="simple">
<li><p><a class="reference external" href="https://pythonce.sourceforge.net/">Windows CE</a> is
<a class="reference external" href="https://github.com/python/cpython/issues/71542">no longer supported</a>
since Python 3 (if it ever was).</p></li>
<li><p>The <a class="reference external" href="https://cygwin.com/">Cygwin</a> installer offers to install the
<a class="reference external" href="https://cygwin.com/packages/summary/python3.html">Python interpreter</a>
as well</p></li>
</ul>
<p>コンパイル済みインストーラが提供されているプラットフォームについての詳細な情報は <a class="reference external" href="https://www.python.org/downloads/windows/">Python for Windows</a> を参照してください。</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../contents.html">目次</a></h3>
    <ul>
<li><a class="reference internal" href="windows.html#">4. Windows で Python を使う</a><ul>
<li><a class="reference internal" href="windows.html#the-full-installer">4.1. 完全版インストーラ</a><ul>
<li><a class="reference internal" href="windows.html#installation-steps">4.1.1. インストール手順</a></li>
<li><a class="reference internal" href="windows.html#removing-the-max-path-limitation">4.1.2. MAX_PATH の制限を除去する</a></li>
<li><a class="reference internal" href="windows.html#installing-without-ui">4.1.3. インストーラの GUI なしでインストールする</a></li>
<li><a class="reference internal" href="windows.html#installing-without-downloading">4.1.4. ダウンロード不要なインストール</a></li>
<li><a class="reference internal" href="windows.html#modifying-an-install">4.1.5. インストール後の変更</a></li>
</ul>
</li>
<li><a class="reference internal" href="windows.html#the-microsoft-store-package">4.2. Microsoft ストアパッケージ</a><ul>
<li><a class="reference internal" href="windows.html#known-issues">4.2.1. 既知の問題</a><ul>
<li><a class="reference internal" href="windows.html#redirection-of-local-data-registry-and-temporary-paths">4.2.1.1. Redirection of local data, registry, and temporary paths</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="windows.html#the-nuget-org-packages">4.3. nuget.org パッケージ</a></li>
<li><a class="reference internal" href="windows.html#the-embeddable-package">4.4. 埋め込み可能なパッケージ</a><ul>
<li><a class="reference internal" href="windows.html#python-application">4.4.1. Python アプリケーション</a></li>
<li><a class="reference internal" href="windows.html#embedding-python">4.4.2. Python の埋め込み</a></li>
</ul>
</li>
<li><a class="reference internal" href="windows.html#alternative-bundles">4.5. 別のバンドル</a></li>
<li><a class="reference internal" href="windows.html#configuring-python">4.6. Python を構成する</a><ul>
<li><a class="reference internal" href="windows.html#excursus-setting-environment-variables">4.6.1. 補足: 環境変数の設定</a></li>
<li><a class="reference internal" href="windows.html#finding-the-python-executable">4.6.2. Python 実行ファイルを見つける</a></li>
</ul>
</li>
<li><a class="reference internal" href="windows.html#utf-8-mode">4.7. UTF-8 モード</a></li>
<li><a class="reference internal" href="windows.html#python-launcher-for-windows">4.8. Windows の Python ランチャ</a><ul>
<li><a class="reference internal" href="windows.html#getting-started">4.8.1. 最初に</a><ul>
<li><a class="reference internal" href="windows.html#from-the-command-line">4.8.1.1. コマンドラインから起動する</a></li>
<li><a class="reference internal" href="windows.html#virtual-environments">4.8.1.2. 仮想環境 (Virtual environments)</a></li>
<li><a class="reference internal" href="windows.html#from-a-script">4.8.1.3. スクリプトから起動する</a></li>
<li><a class="reference internal" href="windows.html#from-file-associations">4.8.1.4. ファイルの関連付けから起動する</a></li>
</ul>
</li>
<li><a class="reference internal" href="windows.html#shebang-lines">4.8.2. シェバン (shebang) 行</a></li>
<li><a class="reference internal" href="windows.html#arguments-in-shebang-lines">4.8.3. シェバン行の引数</a></li>
<li><a class="reference internal" href="windows.html#customization">4.8.4. カスタマイズ</a><ul>
<li><a class="reference internal" href="windows.html#customization-via-ini-files">4.8.4.1. INI ファイルによるカスタマイズ</a></li>
<li><a class="reference internal" href="windows.html#customizing-default-python-versions">4.8.4.2. デフォルトのPythonバージョンのカスタマイズ</a></li>
</ul>
</li>
<li><a class="reference internal" href="windows.html#diagnostics">4.8.5. 診断</a></li>
<li><a class="reference internal" href="windows.html#dry-run">4.8.6. Dry Run</a></li>
<li><a class="reference internal" href="windows.html#install-on-demand">4.8.7. Install on demand</a></li>
<li><a class="reference internal" href="windows.html#return-codes">4.8.8. Return codes</a></li>
</ul>
</li>
<li><a class="reference internal" href="windows.html#finding-modules">4.9. モジュールの検索</a></li>
<li><a class="reference internal" href="windows.html#additional-modules">4.10. 追加のモジュール</a><ul>
<li><a class="reference internal" href="windows.html#pywin32">4.10.1. PyWin32</a></li>
<li><a class="reference internal" href="windows.html#cx-freeze">4.10.2. cx_Freeze</a></li>
</ul>
</li>
<li><a class="reference internal" href="windows.html#compiling-python-on-windows">4.11. Windows 上で Python をコンパイルする</a></li>
<li><a class="reference internal" href="windows.html#other-platforms">4.12. ほかのプラットフォーム</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>前のトピックへ</h4>
    <p class="topless"><a href="configure.html"
                          title="前の章へ"><span class="section-number">3. </span>Python を構成する</a></p>
  </div>
  <div>
    <h4>次のトピックへ</h4>
    <p class="topless"><a href="mac.html"
                          title="次の章へ"><span class="section-number">5. </span>Mac で Python を使う</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>このページ</h3>
    <ul class="this-page-menu">
      <li><a href="../bugs.html">バグ報告</a></li>
      <li>
        <a href="https://github.com/python/cpython/blob/main/Doc/using/windows.rst"
            rel="nofollow">ソースの表示
        </a>
      </li>
    </ul>
  </div>
        </div>
<div id="sidebarbutton" title="サイドバーをたたむ">
<span>«</span>
</div>

      </div>
      <div class="clearer"></div>
    </div>  
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="総合索引"
             >索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Pythonモジュール索引"
             >モジュール</a> |</li>
        <li class="right" >
          <a href="mac.html" title="5. Mac で Python を使う"
             >次へ</a> |</li>
        <li class="right" >
          <a href="configure.html" title="3. Python を構成する"
             >前へ</a> |</li>

          <li><img src="../_static/py.svg" alt="Python logo" style="vertical-align: middle; margin-top: -1px"/></li>
          <li><a href="https://www.python.org/">Python</a> &#187;</li>
          <li class="switchers">
            <div class="language_switcher_placeholder"></div>
            <div class="version_switcher_placeholder"></div>
          </li>
          <li>
              
          </li>
    <li id="cpython-language-and-version">
      <a href="../index.html">3.12.4 Documentation</a> &#187;
    </li>

          <li class="nav-item nav-item-1"><a href="index.html" >Python のセットアップと利用</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="windows.html"><span class="section-number">4. </span>Windows で Python を使う</a></li>
                <li class="right">
                    

    <div class="inline-search" role="search">
        <form class="inline-search" action="../search.html" method="get">
          <input placeholder="クイック検索" aria-label="クイック検索" type="search" name="q" id="search-box" />
          <input type="submit" value="検索" />
        </form>
    </div>
                     |
                </li>
            <li class="right">
<label class="theme-selector-label">
    Theme
    <select class="theme-selector" oninput="activateTheme(this.value)">
        <option value="auto" selected>Auto</option>
        <option value="light">Light</option>
        <option value="dark">Dark</option>
    </select>
</label> |</li>
            
      </ul>
    </div>  
    <div class="footer">
    &copy; 
      <a href="../copyright.html">
    
    Copyright
    
      </a>
     2001-2024, Python Software Foundation.
    <br />
    This page is licensed under the Python Software Foundation License Version 2.
    <br />
    Examples, recipes, and other code in the documentation are additionally licensed under the Zero Clause BSD License.
    <br />
    
      See <a href="../../../license.html">History and License</a> for more information.<br />
    
    
    <br />

    The Python Software Foundation is a non-profit corporation.
<a href="https://www.python.org/psf/donations/">Please donate.</a>
<br />
    <br />
      最終更新: Jun 11, 2024 (04:44 UTC)
    
      <a href="../../../bugs.html">Found a bug</a>?
    
    <br />

    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.3.7.
    </div>

    <script type="text/javascript" src="../_static/switchers.js"></script>
  </body>
</html>