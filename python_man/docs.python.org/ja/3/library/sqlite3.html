<!DOCTYPE html>

<html lang="ja" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="sqlite3 --- SQLite データベース用の DB-API 2.0 インターフェース" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://docs.python.org/3/library/sqlite3.html" />
<meta property="og:site_name" content="Python documentation" />
<meta property="og:description" content="ソースコード: Lib/sqlite3/ SQLite は、軽量なディスク上のデータベースを提供する C ライブラリです。別のサーバプロセスを用意する必要なく、 SQL クエリー言語の非標準的な一種を使用してデータベースにアクセスできます。一部のアプリケーションは内部データ保存に SQLite を使えます。また、SQLite を使ってアプリケーションのプロトタイプを作り、その後そのコードを ..." />
<meta property="og:image" content="https://docs.python.org/3/_static/og-image.png" />
<meta property="og:image:alt" content="Python documentation" />
<meta name="description" content="ソースコード: Lib/sqlite3/ SQLite は、軽量なディスク上のデータベースを提供する C ライブラリです。別のサーバプロセスを用意する必要なく、 SQL クエリー言語の非標準的な一種を使用してデータベースにアクセスできます。一部のアプリケーションは内部データ保存に SQLite を使えます。また、SQLite を使ってアプリケーションのプロトタイプを作り、その後そのコードを ..." />
<meta property="og:image:width" content="200" />
<meta property="og:image:height" content="200" />
<meta name="theme-color" content="#3776ab" />

    <title>sqlite3 --- SQLite データベース用の DB-API 2.0 インターフェース &#8212; Python 3.12.4 ドキュメント</title><meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css%3Fv=80d5e7a1.css" />
    <link rel="stylesheet" type="text/css" href="../_static/pydoctheme.css%3Fv=bb723527.css" />
    <link id="pygments_dark_css" media="(prefers-color-scheme: dark)" rel="stylesheet" type="text/css" href="../_static/pygments_dark.css%3Fv=b20cc3f5.css" />
    
    <script src="../_static/documentation_options.js%3Fv=7e11ab17"></script>
    <script src="../_static/doctools.js%3Fv=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js%3Fv=dc90522c"></script>
    <script src="../_static/translations.js%3Fv=4dbe4bdc"></script>
    
    <script src="../_static/sidebar.js"></script>
    
    <link rel="search" type="application/opensearchdescription+xml"
          title="Python 3.12.4 ドキュメント 内を検索"
          href="../_static/opensearch.xml"/>
    <link rel="author" title="このドキュメントについて" href="../about.html" />
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="検索" href="../search.html" />
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="next" title="データ圧縮とアーカイブ" href="archiving.html" />
    <link rel="prev" title="dbm --- Unix &#34;データベース&#34; へのインターフェース" href="dbm.html" />
    
      <script defer data-domain="docs.python.org" src="https://plausible.io/js/script.js"></script>
    
    <link rel="canonical" href="../../../3/library/sqlite3.html" />
    
      
    

    
    <style>
      @media only screen {
        table.full-width-table {
            width: 100%;
        }
      }
    </style>
<link rel="stylesheet" href="../_static/pydoctheme_dark.css" media="(prefers-color-scheme: dark)" id="pydoctheme_dark_css">
    <link rel="shortcut icon" type="image/png" href="../_static/py.svg" />
            <script type="text/javascript" src="../_static/copybutton.js"></script>
            <script type="text/javascript" src="../_static/menu.js"></script>
            <script type="text/javascript" src="../_static/search-focus.js"></script>
            <script type="text/javascript" src="../_static/themetoggle.js"></script> 
<meta name="readthedocs-addons-api-version" content="1">
<script type="text/javascript">
 function onSwitch(event) {
     const option = event.target.selectedIndex;
     const item = event.target.options[option];
     window.location.href = item.dataset.url;
 }

 document.addEventListener("readthedocs-addons-data-ready", function(event) {
   const config = event.detail.data()

   // Add some mocked hardcoded versions pointing to the official
   // documentation while migrating to Read the Docs.
   // These are only for testing purposes.
   // TODO: remove them when managing all the versions on Read the Docs,
   // since all the "active, built and not hidden" versions will be shown automatically.
   let versions = config.versions.active.concat([
       {
           slug: "dev (3.13)",
           urls: {
               documentation: "https://docs.python.org/3.13/",
           }
       },
       {
           slug: "3.12",
           urls: {
               documentation: "https://docs.python.org/3.12/",
           }
       },
       {
           slug: "3.11",
           urls: {
               documentation: "https://docs.python.org/3.11/",
           }
       },
   ]);

   const versionSelect = `
   <select id="version_select">
   ${ versions.map(
       (version) => `
       <option
           value="${ version.slug }"
           ${ config.versions.current.slug === version.slug ? 'selected="selected"' : '' }
           data-url="${ version.urls.documentation }">
           ${ version.slug }
       </option>`
   ).join("\n") }
   </select>
   `;

   // Prepend the current language to the options on the selector
   let languages = config.projects.translations.concat(config.projects.current);
   languages = languages.sort((a, b) => a.language.name.localeCompare(b.language.name));

   const languageSelect = `
   <select id="language_select">
   ${ languages.map(
       (translation) => `
       <option
           value="${ translation.slug }"
           ${ config.projects.current.slug === translation.slug ? 'selected="selected"' : '' }
           data-url="${ translation.urls.documentation }">
           ${ translation.language.name }
       </option>`
   ).join("\n") }
   </select>
   `;

   // Query all the placeholders because there are different ones for Desktop/Mobile
   const versionPlaceholders = document.querySelectorAll(".version_switcher_placeholder");
   for (placeholder of versionPlaceholders) {
       placeholder.innerHTML = versionSelect;
       let selectElement = placeholder.querySelector("select");
       selectElement.addEventListener("change", onSwitch);
   }

   const languagePlaceholders = document.querySelectorAll(".language_switcher_placeholder");
   for (placeholder of languagePlaceholders) {
       placeholder.innerHTML = languageSelect;
       let selectElement = placeholder.querySelector("select");
       selectElement.addEventListener("change", onSwitch);
   }
 });
</script>

  </head>
<body>
<div class="mobile-nav">
    <input type="checkbox" id="menuToggler" class="toggler__input" aria-controls="navigation"
           aria-pressed="false" aria-expanded="false" role="button" aria-label="Menu" />
    <nav class="nav-content" role="navigation">
        <label for="menuToggler" class="toggler__label">
            <span></span>
        </label>
        <span class="nav-items-wrapper">
            <a href="https://www.python.org/" class="nav-logo">
                <img src="../_static/py.svg" alt="Python logo"/>
            </a>
            <span class="version_switcher_placeholder"></span>
            <form role="search" class="search" action="../search.html" method="get">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" class="search-icon">
                    <path fill-rule="nonzero" fill="currentColor" d="M15.5 14h-.79l-.28-.27a6.5 6.5 0 001.48-5.34c-.47-2.78-2.79-5-5.59-5.34a6.505 6.505 0 00-7.27 7.27c.34 2.8 2.56 5.12 5.34 5.59a6.5 6.5 0 005.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0 .41-.41.41-1.08 0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path>
                </svg>
                <input placeholder="クイック検索" aria-label="クイック検索" type="search" name="q" />
                <input type="submit" value="検索"/>
            </form>
        </span>
    </nav>
    <div class="menu-wrapper">
        <nav class="menu" role="navigation" aria-label="main navigation">
            <div class="language_switcher_placeholder"></div>
            
<label class="theme-selector-label">
    Theme
    <select class="theme-selector" oninput="activateTheme(this.value)">
        <option value="auto" selected>Auto</option>
        <option value="light">Light</option>
        <option value="dark">Dark</option>
    </select>
</label>
  <div>
    <h3><a href="../contents.html">目次</a></h3>
    <ul>
<li><a class="reference internal" href="sqlite3.html#"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sqlite3</span></code> --- SQLite データベース用の DB-API 2.0 インターフェース</a><ul>
<li><a class="reference internal" href="sqlite3.html#tutorial">チュートリアル</a></li>
<li><a class="reference internal" href="sqlite3.html#reference">リファレンス</a><ul>
<li><a class="reference internal" href="sqlite3.html#module-functions">モジュール関数</a></li>
<li><a class="reference internal" href="sqlite3.html#module-constants">モジュール定数</a></li>
<li><a class="reference internal" href="sqlite3.html#connection-objects">Connection オブジェクト</a></li>
<li><a class="reference internal" href="sqlite3.html#cursor-objects">Cursor オブジェクト</a></li>
<li><a class="reference internal" href="sqlite3.html#row-objects">Row オブジェクト</a></li>
<li><a class="reference internal" href="sqlite3.html#blob-objects">Blob オブジェクト</a></li>
<li><a class="reference internal" href="sqlite3.html#prepareprotocol-objects">PrepareProtocol オブジェクト</a></li>
<li><a class="reference internal" href="sqlite3.html#exceptions">例外</a></li>
<li><a class="reference internal" href="sqlite3.html#sqlite-and-python-types">SQLite と Python の型</a></li>
<li><a class="reference internal" href="sqlite3.html#default-adapters-and-converters-deprecated">デフォルトの適合関数(adapters)とデフォルトの変換関数(converters)(非推奨)</a></li>
<li><a class="reference internal" href="sqlite3.html#command-line-interface">コマンドライン・インターフェース</a></li>
</ul>
</li>
<li><a class="reference internal" href="sqlite3.html#how-to-guides">ハウツー・ガイド</a><ul>
<li><a class="reference internal" href="sqlite3.html#how-to-use-placeholders-to-bind-values-in-sql-queries">プレースホルダを使用して SQL クエリに値を結び付ける方法</a></li>
<li><a class="reference internal" href="sqlite3.html#how-to-adapt-custom-python-types-to-sqlite-values">カスタム Python 型を SQLite 値に適合させる方法</a><ul>
<li><a class="reference internal" href="sqlite3.html#how-to-write-adaptable-objects">適合可能オブジェクトの書き方</a></li>
<li><a class="reference internal" href="sqlite3.html#how-to-register-adapter-callables">適合用呼び出し可能オブジェクト(adapter callables)の登録方法</a></li>
</ul>
</li>
<li><a class="reference internal" href="sqlite3.html#how-to-convert-sqlite-values-to-custom-python-types">SQLite 値をカスタム Python 型に変換する方法</a></li>
<li><a class="reference internal" href="sqlite3.html#adapter-and-converter-recipes">適合関数と変換関数のレシピ集</a></li>
<li><a class="reference internal" href="sqlite3.html#how-to-use-connection-shortcut-methods">接続(connection)ショートカット・メソッドの使い方</a></li>
<li><a class="reference internal" href="sqlite3.html#how-to-use-the-connection-context-manager">接続(connection)コンテキストマネージャの使い方</a></li>
<li><a class="reference internal" href="sqlite3.html#how-to-work-with-sqlite-uris">SQLite URI の操作方法</a></li>
<li><a class="reference internal" href="sqlite3.html#how-to-create-and-use-row-factories">行工場(row factories)の作成方法と使用方法</a></li>
<li><a class="reference internal" href="sqlite3.html#how-to-handle-non-utf-8-text-encodings">How to handle non-UTF-8 text encodings</a></li>
</ul>
</li>
<li><a class="reference internal" href="sqlite3.html#explanation">説明</a><ul>
<li><a class="reference internal" href="sqlite3.html#transaction-control">トランザクション制御</a><ul>
<li><a class="reference internal" href="sqlite3.html#transaction-control-via-the-autocommit-attribute"><code class="docutils literal notranslate"><span class="pre">autocommit</span></code> 属性に依るトランザクション制御</a></li>
<li><a class="reference internal" href="sqlite3.html#transaction-control-via-the-isolation-level-attribute"><code class="docutils literal notranslate"><span class="pre">isolation_level</span></code> 属性に依るトランザクション制御</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>前のトピックへ</h4>
    <p class="topless"><a href="dbm.html"
                          title="前の章へ"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dbm</span></code> --- Unix &quot;データベース&quot; へのインターフェース</a></p>
  </div>
  <div>
    <h4>次のトピックへ</h4>
    <p class="topless"><a href="archiving.html"
                          title="次の章へ">データ圧縮とアーカイブ</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>このページ</h3>
    <ul class="this-page-menu">
      <li><a href="../bugs.html">バグ報告</a></li>
      <li>
        <a href="https://github.com/python/cpython/blob/main/Doc/library/sqlite3.rst"
            rel="nofollow">ソースの表示
        </a>
      </li>
    </ul>
  </div>
        </nav>
    </div>
</div>

  
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="総合索引"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Pythonモジュール索引"
             >モジュール</a> |</li>
        <li class="right" >
          <a href="archiving.html" title="データ圧縮とアーカイブ"
             accesskey="N">次へ</a> |</li>
        <li class="right" >
          <a href="dbm.html" title="dbm --- Unix &#34;データベース&#34; へのインターフェース"
             accesskey="P">前へ</a> |</li>

          <li><img src="../_static/py.svg" alt="Python logo" style="vertical-align: middle; margin-top: -1px"/></li>
          <li><a href="https://www.python.org/">Python</a> &#187;</li>
          <li class="switchers">
            <div class="language_switcher_placeholder"></div>
            <div class="version_switcher_placeholder"></div>
          </li>
          <li>
              
          </li>
    <li id="cpython-language-and-version">
      <a href="../index.html">3.12.4 Documentation</a> &#187;
    </li>

          <li class="nav-item nav-item-1"><a href="index.html" >Python 標準ライブラリ</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="persistence.html" accesskey="U">データの永続化</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="sqlite3.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sqlite3</span></code> --- SQLite データベース用の DB-API 2.0 インターフェース</a></li>
                <li class="right">
                    

    <div class="inline-search" role="search">
        <form class="inline-search" action="../search.html" method="get">
          <input placeholder="クイック検索" aria-label="クイック検索" type="search" name="q" id="search-box" />
          <input type="submit" value="検索" />
        </form>
    </div>
                     |
                </li>
            <li class="right">
<label class="theme-selector-label">
    Theme
    <select class="theme-selector" oninput="activateTheme(this.value)">
        <option value="auto" selected>Auto</option>
        <option value="light">Light</option>
        <option value="dark">Dark</option>
    </select>
</label> |</li>
            
      </ul>
    </div>    

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="module-sqlite3">
<span id="sqlite3-db-api-2-0-interface-for-sqlite-databases"></span><h1><code class="xref py py-mod docutils literal notranslate"><span class="pre">sqlite3</span></code> --- SQLite データベース用の DB-API 2.0 インターフェース<a class="headerlink" href="sqlite3.html#module-sqlite3" title="Link to this heading">¶</a></h1>
<p><strong>ソースコード:</strong> <a class="reference external" href="https://github.com/python/cpython/tree/3.12/Lib/sqlite3/">Lib/sqlite3/</a></p>
<p id="sqlite3-intro">SQLite は、軽量なディスク上のデータベースを提供する C ライブラリです。別のサーバプロセスを用意する必要なく、 SQL クエリー言語の非標準的な一種を使用してデータベースにアクセスできます。一部のアプリケーションは内部データ保存に SQLite を使えます。また、SQLite を使ってアプリケーションのプロトタイプを作り、その後そのコードを PostgreSQL や Oracle のような大規模データベースに移植するということも可能です。</p>
<p>The <code class="xref py py-mod docutils literal notranslate"><span class="pre">sqlite3</span></code> module was written by Gerhard Häring.  It provides an SQL interface
compliant with the DB-API 2.0 specification described by <span class="target" id="index-0"></span><a class="pep reference external" href="https://peps.python.org/pep-0249/"><strong>PEP 249</strong></a>, and
requires SQLite 3.7.15 or newer.</p>
<p>この文書には大きく分けて 4 つの節があります:</p>
<ul class="simple">
<li><p><a class="reference internal" href="sqlite3.html#sqlite3-tutorial"><span class="std std-ref">チュートリアル</span></a> <code class="xref py py-mod docutils literal notranslate"><span class="pre">sqlite3</span></code> モジュールの使い方を学びます。</p></li>
<li><p><a class="reference internal" href="sqlite3.html#sqlite3-reference"><span class="std std-ref">リファレンス</span></a> このモジュールが定義するクラスと関数について説明します。</p></li>
<li><p><a class="reference internal" href="sqlite3.html#sqlite3-howtos"><span class="std std-ref">ハウツー・ガイド</span></a> 特定のタスクの処理方法について詳しく説明します。</p></li>
<li><p><a class="reference internal" href="sqlite3.html#sqlite3-explanation"><span class="std std-ref">説明</span></a> トランザクション制御の背景をより深く掘り下げて説明します。</p></li>
</ul>
<div class="admonition seealso">
<p class="admonition-title">参考</p>
<dl class="simple">
<dt><a class="reference external" href="https://www.sqlite.org">https://www.sqlite.org</a></dt><dd><p>SQLite のウェブページ。ここの文書ではサポートされる SQL 方言の文法と使えるデータ型を説明しています。</p>
</dd>
<dt><a class="reference external" href="https://www.w3schools.com/sql/">https://www.w3schools.com/sql/</a></dt><dd><p>SQL 学習に効くチュートリアル、リファレンス、実例集。</p>
</dd>
<dt><span class="target" id="index-1"></span><a class="pep reference external" href="https://peps.python.org/pep-0249/"><strong>PEP 249</strong></a> - Database API Specification 2.0</dt><dd><p>Marc-Andre Lemburg により書かれた PEP。</p>
</dd>
</dl>
</div>
<section id="tutorial">
<span id="sqlite3-tutorial"></span><h2>チュートリアル<a class="headerlink" href="sqlite3.html#tutorial" title="Link to this heading">¶</a></h2>
<p>このチュートリアルでは、あなたは基本的な <code class="xref py py-mod docutils literal notranslate"><span class="pre">sqlite3</span></code> 機能を使用して、 例としてモンティ・パイソンの映画のデータベースを作成します。 あなたがカーソル(<a class="reference external" href="https://en.wikipedia.org/wiki/Cursor_(databases)">cursors</a>)やトランザクション(<a class="reference external" href="https://en.wikipedia.org/wiki/Database_transaction">transactions</a>)を含むデータベースの基本概念を理解していることを前提としています。</p>
<p>最初に、新しいデータベースを作成し、データベース接続(connection)を開いて <code class="xref py py-mod docutils literal notranslate"><span class="pre">sqlite3</span></code> が動作できるようにする必要があります。 <a class="reference internal" href="sqlite3.html#sqlite3.connect" title="sqlite3.connect"><code class="xref py py-func docutils literal notranslate"><span class="pre">sqlite3.connect()</span></code></a> を呼び出して、データベース <code class="file docutils literal notranslate"><span class="pre">tutorial.db</span></code> への接続を現在の作業ディレクトリに作成します。存在しない場合は暗黙的に作成します。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sqlite3</span>
<span class="n">con</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;tutorial.db&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>返された <a class="reference internal" href="sqlite3.html#sqlite3.Connection" title="sqlite3.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> オブジェクト <code class="docutils literal notranslate"><span class="pre">con</span></code> は、ディスク上のデータベースへの接続を表します。</p>
<p>SQL 文を実行し、SQL クエリから結果を取得するには、データベース・カーソルを使用する必要があります。 <a class="reference internal" href="sqlite3.html#sqlite3.Connection.cursor" title="sqlite3.Connection.cursor"><code class="xref py py-meth docutils literal notranslate"><span class="pre">con.cursor()</span></code></a> を呼び出して <a class="reference internal" href="sqlite3.html#sqlite3.Cursor" title="sqlite3.Cursor"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cursor</span></code></a> を作成してください:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cur</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
</pre></div>
</div>
<p>さて、今やデータベース接続とカーソルを取得したので、タイトル(title)とリリース年(year)と、レビュー・スコア(score)の列(columns)を持つデータベース・テーブル <code class="docutils literal notranslate"><span class="pre">movie</span></code> を作成できます。 簡単にするために、テーブル宣言では列名だけを使用できます。SQLite の 柔軟な型付け(<a class="reference external" href="https://www.sqlite.org/flextypegood.html">flexible typing</a>)機能のおかげで、データ型の指定はオプションになっています。 <a class="reference internal" href="sqlite3.html#sqlite3.Cursor.execute" title="sqlite3.Cursor.execute"><code class="xref py py-meth docutils literal notranslate"><span class="pre">cur.execute(...)</span></code></a> を呼び出して <code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">TABLE</span></code> 文を実行してください:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;CREATE TABLE movie(title, year, score)&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>SQLite に組み込みの <code class="docutils literal notranslate"><span class="pre">sqlite_master</span></code> テーブルに対してクエリを実行することで、新しいテーブルが作成されたことを確認できます。このテーブルには、 <code class="docutils literal notranslate"><span class="pre">movie</span></code> テーブル定義のエントリが含まれているはずです(詳細は <a class="reference external" href="https://www.sqlite.org/schematab.html">The Schema Table</a> 参照)。 <a class="reference internal" href="sqlite3.html#sqlite3.Cursor.execute" title="sqlite3.Cursor.execute"><code class="xref py py-meth docutils literal notranslate"><span class="pre">cur.execute(...)</span></code></a> を呼び出してクエリを実行して、その結果を <code class="docutils literal notranslate"><span class="pre">res</span></code> に代入し、結果の行(row)を取得するために <a class="reference internal" href="sqlite3.html#sqlite3.Cursor.fetchone" title="sqlite3.Cursor.fetchone"><code class="xref py py-meth docutils literal notranslate"><span class="pre">res.fetchone()</span></code></a> を呼び出します:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT name FROM sqlite_master&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span>
<span class="go">(&#39;movie&#39;,)</span>
</pre></div>
</div>
<p>クエリがテーブルの名前を含む <a class="reference internal" href="stdtypes.html#tuple" title="tuple"><code class="xref py py-class docutils literal notranslate"><span class="pre">タプル</span></code></a> を返すので、テーブルが作成されたことがわかります。 存在しないテーブル <code class="docutils literal notranslate"><span class="pre">spam</span></code> に対して <code class="docutils literal notranslate"><span class="pre">sqlite_master</span></code> をクエリすると、 <code class="xref py py-meth docutils literal notranslate"><span class="pre">res.fetchone()</span></code> は <code class="docutils literal notranslate"><span class="pre">None</span></code> を返します:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT name FROM sqlite_master WHERE name=&#39;spam&#39;&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span> <span class="ow">is</span> <span class="kc">None</span>
<span class="go">True</span>
</pre></div>
</div>
<p>ここで、 INSERT 文を実行して SQL のリテラルとして提供された 2 行のデータを追加し、 再度 <a class="reference internal" href="sqlite3.html#sqlite3.Cursor.execute" title="sqlite3.Cursor.execute"><code class="xref py py-meth docutils literal notranslate"><span class="pre">cur.execute(...)</span></code></a> を呼び出して追加します:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    INSERT INTO movie VALUES</span>
<span class="s2">        (&#39;Monty Python and the Holy Grail&#39;, 1975, 8.2),</span>
<span class="s2">        (&#39;And Now for Something Completely Different&#39;, 1971, 7.5)</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">INSERT</span></code> 文は、変更がデータベースに保存される前にコミットする必要がある、トランザクションを暗黙的に開きます(詳細は、 <a class="reference internal" href="sqlite3.html#sqlite3-controlling-transactions"><span class="std std-ref">トランザクション制御</span></a> 参照)。 トランザクションをコミットするために接続オブジェクト(connection object)の <a class="reference internal" href="sqlite3.html#sqlite3.Connection.commit" title="sqlite3.Connection.commit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">con.commit()</span></code></a> を呼び出して下さい:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">con</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">SELECT</span></code> クエリを実行することで、データが正しく挿入されたことを確認できます。 結果のすべての行を返すには、おなじみの <a class="reference internal" href="sqlite3.html#sqlite3.Cursor.execute" title="sqlite3.Cursor.execute"><code class="xref py py-meth docutils literal notranslate"><span class="pre">cur.execute(...)</span></code></a> を使用して結果を <code class="docutils literal notranslate"><span class="pre">res</span></code> に代入し、 <a class="reference internal" href="sqlite3.html#sqlite3.Cursor.fetchall" title="sqlite3.Cursor.fetchall"><code class="xref py py-meth docutils literal notranslate"><span class="pre">res.fetchall()</span></code></a> を呼び出して下さい:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT score FROM movie&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<span class="go">[(8.2,), (7.5,)]</span>
</pre></div>
</div>
<p>結果は、2 つの <code class="xref py py-class docutils literal notranslate"><span class="pre">タプル</span></code> の <a class="reference internal" href="stdtypes.html#list" title="list"><code class="xref py py-class docutils literal notranslate"><span class="pre">リスト</span></code></a> で、 それぞれのタプルにその行の <code class="docutils literal notranslate"><span class="pre">score</span></code> 値が含まれています。</p>
<p>ここで、 <a class="reference internal" href="sqlite3.html#sqlite3.Cursor.executemany" title="sqlite3.Cursor.executemany"><code class="xref py py-meth docutils literal notranslate"><span class="pre">cur.executemany(...)</span></code></a> を呼び出して、さらに 3 行挿入します:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s2">&quot;Monty Python Live at the Hollywood Bowl&quot;</span><span class="p">,</span> <span class="mi">1982</span><span class="p">,</span> <span class="mf">7.9</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Monty Python&#39;s The Meaning of Life&quot;</span><span class="p">,</span> <span class="mi">1983</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Monty Python&#39;s Life of Brian&quot;</span><span class="p">,</span> <span class="mi">1979</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">),</span>
<span class="p">]</span>
<span class="n">cur</span><span class="o">.</span><span class="n">executemany</span><span class="p">(</span><span class="s2">&quot;INSERT INTO movie VALUES(?, ?, ?)&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
<span class="n">con</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>  <span class="c1"># Remember to commit the transaction after executing INSERT.</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">data</span></code> をクエリに結び付け(bind)するために <code class="docutils literal notranslate"><span class="pre">?</span></code> プレースホルダが使用されていることに注意してください。 SQL インジェクション攻撃(<a class="reference external" href="https://en.wikipedia.org/wiki/SQL_injection">SQL injection attacks</a>)を避けるために、Python の値を SQL 文に結び付けするには、常に <a class="reference internal" href="../tutorial/inputoutput.html#tut-formatting"><span class="std std-ref">文字列フォーマット</span></a> の代わりにプレースホルダを使用してください(詳細は <a class="reference internal" href="sqlite3.html#sqlite3-placeholders"><span class="std std-ref">プレースホルダを使用して SQL クエリに値を結び付ける方法</span></a> 参照)。</p>
<p><code class="docutils literal notranslate"><span class="pre">SELECT</span></code> クエリを実行することで、新しい行が挿入されたことを確認できます。今回は、クエリの結果を反復処理します:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT year, title FROM movie ORDER BY year&quot;</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
<span class="go">(1971, &#39;And Now for Something Completely Different&#39;)</span>
<span class="go">(1975, &#39;Monty Python and the Holy Grail&#39;)</span>
<span class="go">(1979, &quot;Monty Python&#39;s Life of Brian&quot;)</span>
<span class="go">(1982, &#39;Monty Python Live at the Hollywood Bowl&#39;)</span>
<span class="go">(1983, &quot;Monty Python&#39;s The Meaning of Life&quot;)</span>
</pre></div>
</div>
<p>各行(row)は <a class="reference internal" href="stdtypes.html#tuple" title="tuple"><code class="xref py py-class docutils literal notranslate"><span class="pre">タプル</span></code></a> の <code class="docutils literal notranslate"><span class="pre">(year,</span> <span class="pre">title)</span></code> の 2 つの項目であり、クエリで選択された列(columns)にマッチします。</p>
<p>最後に、 <a class="reference internal" href="sqlite3.html#sqlite3.Connection.close" title="sqlite3.Connection.close"><code class="xref py py-meth docutils literal notranslate"><span class="pre">con.close()</span></code></a> を呼び出して既存の接続(connection)を閉じ、新しい接続を開き、新しいカーソルを作成してから、データベースに対してクエリを実行して、データベースがディスクに書き込まれたことを確認します:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">con</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_con</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;tutorial.db&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_cur</span> <span class="o">=</span> <span class="n">new_con</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">new_cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT title, year FROM movie ORDER BY score DESC&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">title</span><span class="p">,</span> <span class="n">year</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The highest scoring Monty Python movie is </span><span class="si">{</span><span class="n">title</span><span class="si">!r}</span><span class="s1">, released in </span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="go">The highest scoring Monty Python movie is &#39;Monty Python and the Holy Grail&#39;, released in 1975</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_con</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>これで、あなたは、 <code class="xref py py-mod docutils literal notranslate"><span class="pre">sqlite3</span></code> モジュールを使用して SQLite データベースを作成し、複数の方法でデータを挿入し、そこから値を取得することができるようになりました。</p>
<div class="admonition seealso">
<p class="admonition-title">参考</p>
<ul class="simple">
<li><p><a class="reference internal" href="sqlite3.html#sqlite3-howtos"><span class="std std-ref">ハウツー・ガイド</span></a> も参考にしてください:</p>
<ul>
<li><p><a class="reference internal" href="sqlite3.html#sqlite3-placeholders"><span class="std std-ref">プレースホルダを使用して SQL クエリに値を結び付ける方法</span></a></p></li>
<li><p><a class="reference internal" href="sqlite3.html#sqlite3-adapters"><span class="std std-ref">カスタム Python 型を SQLite 値に適合させる方法</span></a></p></li>
<li><p><a class="reference internal" href="sqlite3.html#sqlite3-converters"><span class="std std-ref">SQLite 値をカスタム Python 型に変換する方法</span></a></p></li>
<li><p><a class="reference internal" href="sqlite3.html#sqlite3-connection-context-manager"><span class="std std-ref">接続(connection)コンテキストマネージャの使い方</span></a></p></li>
<li><p><a class="reference internal" href="sqlite3.html#sqlite3-howto-row-factory"><span class="std std-ref">行工場(row factories)の作成方法と使用方法</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="sqlite3.html#sqlite3-explanation"><span class="std std-ref">トランザクション制御</span></a> トランザクション制御の背景についてより深く掘り下げた説明。</p></li>
</ul>
</div>
</section>
<section id="reference">
<span id="sqlite3-reference"></span><h2>リファレンス<a class="headerlink" href="sqlite3.html#reference" title="Link to this heading">¶</a></h2>
<section id="module-functions">
<span id="sqlite3-module-functions"></span><span id="sqlite3-module-contents"></span><h3>モジュール関数<a class="headerlink" href="sqlite3.html#module-functions" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="sqlite3.connect">
<span class="sig-prename descclassname"><span class="pre">sqlite3.</span></span><span class="sig-name descname"><span class="pre">connect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">database</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">detect_types</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">isolation_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'DEFERRED'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_same_thread</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">factory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">sqlite3.Connection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cached_statements</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uri</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">autocommit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">sqlite3.LEGACY_TRANSACTION_CONTROL</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="sqlite3.html#sqlite3.connect" title="Link to this definition">¶</a></dt>
<dd><p>SQLite データベースとの接続(connection)を開きます。</p>
<dl class="field-list simple">
<dt class="field-odd">パラメータ<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>database</strong> (<a class="reference internal" href="../glossary.html#term-path-like-object"><span class="xref std std-term">path-like object</span></a>) -- The path to the database file to be opened.
You can pass <code class="docutils literal notranslate"><span class="pre">&quot;:memory:&quot;</span></code> to create an <a class="reference external" href="https://sqlite.org/inmemorydb.html">SQLite database existing only
in memory</a>, and open a connection
to it.</p></li>
<li><p><strong>timeout</strong> (<a class="reference internal" href="functions.html#float" title="float"><em>float</em></a>) -- テーブルがロックされている場合、 <a class="reference internal" href="sqlite3.html#sqlite3.OperationalError" title="sqlite3.OperationalError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">OperationalError</span></code></a> を送出する前に接続を待機する秒数。 別の接続がテーブルを変更するためにトランザクションを開くと、そのテーブルはトランザクションがコミットされるまでロックされます。 デフォルトは 5 秒です。</p></li>
<li><p><strong>detect_types</strong> (<a class="reference internal" href="functions.html#int" title="int"><em>int</em></a>) -- <a class="reference internal" href="sqlite3.html#sqlite3.register_converter" title="sqlite3.register_converter"><code class="xref py py-func docutils literal notranslate"><span class="pre">register_converter()</span></code></a> で登録された変換関数を使用して、 <a class="reference internal" href="sqlite3.html#sqlite3-types"><span class="std std-ref">SQLite でネイティブにサポートされている型</span></a> 以外のデータ型を検出して、 Python 型に変換するかどうか、そして、その変換方法を制御します。 これは、 <a class="reference internal" href="sqlite3.html#sqlite3.PARSE_DECLTYPES" title="sqlite3.PARSE_DECLTYPES"><code class="xref py py-const docutils literal notranslate"><span class="pre">PARSE_DECLTYPES</span></code></a> と <a class="reference internal" href="sqlite3.html#sqlite3.PARSE_COLNAMES" title="sqlite3.PARSE_COLNAMES"><code class="xref py py-const docutils literal notranslate"><span class="pre">PARSE_COLNAMES</span></code></a> を(ビット論理和 <code class="docutils literal notranslate"><span class="pre">|</span></code> を使用して)任意の組み合わせで設定することで有効になります。 両方のフラグが設定されている場合、宣言された型よりも列名が優先されます。 <em>detect_types</em> パラメータが設定されている場合でも、 生成されたフィールド(たとえば <code class="docutils literal notranslate"><span class="pre">max(data)</span></code>)の型は検出できず、代わりに <a class="reference internal" href="stdtypes.html#str" title="str"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> が返されます。デフォルト (<code class="docutils literal notranslate"><span class="pre">0</span></code>) では、データ型検出は無効になっています。</p></li>
<li><p><strong>isolation_level</strong> (<a class="reference internal" href="stdtypes.html#str" title="str"><em>str</em></a><em> | </em><em>None</em>) -- Control legacy transaction handling behaviour.
See <a class="reference internal" href="sqlite3.html#sqlite3.Connection.isolation_level" title="sqlite3.Connection.isolation_level"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Connection.isolation_level</span></code></a> and
<a class="reference internal" href="sqlite3.html#sqlite3-transaction-control-isolation-level"><span class="std std-ref">isolation_level 属性に依るトランザクション制御</span></a> for more information.
Can be <code class="docutils literal notranslate"><span class="pre">&quot;DEFERRED&quot;</span></code> (default), <code class="docutils literal notranslate"><span class="pre">&quot;EXCLUSIVE&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;IMMEDIATE&quot;</span></code>;
or <code class="docutils literal notranslate"><span class="pre">None</span></code> to disable opening transactions implicitly.
Has no effect unless <a class="reference internal" href="sqlite3.html#sqlite3.Connection.autocommit" title="sqlite3.Connection.autocommit"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Connection.autocommit</span></code></a> is set to
<a class="reference internal" href="sqlite3.html#sqlite3.LEGACY_TRANSACTION_CONTROL" title="sqlite3.LEGACY_TRANSACTION_CONTROL"><code class="xref py py-const docutils literal notranslate"><span class="pre">LEGACY_TRANSACTION_CONTROL</span></code></a> (the default).</p></li>
<li><p><strong>check_same_thread</strong> (<a class="reference internal" href="functions.html#bool" title="bool"><em>bool</em></a>) -- <code class="docutils literal notranslate"><span class="pre">True</span></code> (これがデフォルトです)なら、データベース接続を作成したスレッド以外のスレッドがデータベース接続を使用すると、 <a class="reference internal" href="sqlite3.html#sqlite3.ProgrammingError" title="sqlite3.ProgrammingError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ProgrammingError</span></code></a> が送出されます。 <code class="docutils literal notranslate"><span class="pre">False</span></code> なら、接続は複数のスレッドからアクセスできます。ただし、データの破損を避けるために、ユーザーによる書き込み操作の直列化が必要になることがあります。詳細は <a class="reference internal" href="sqlite3.html#sqlite3.threadsafety" title="sqlite3.threadsafety"><code class="xref py py-attr docutils literal notranslate"><span class="pre">threadsafety</span></code></a>  を参照してください。</p></li>
<li><p><strong>factory</strong> (<a class="reference internal" href="sqlite3.html#sqlite3.Connection" title="sqlite3.Connection"><em>Connection</em></a>) -- デフォルトの <a class="reference internal" href="sqlite3.html#sqlite3.Connection" title="sqlite3.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> クラスでない場合に接続(connection)を作成する <a class="reference internal" href="sqlite3.html#sqlite3.Connection" title="sqlite3.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> のカスタム・サブクラスです。</p></li>
<li><p><strong>cached_statements</strong> (<a class="reference internal" href="functions.html#int" title="int"><em>int</em></a>) -- <code class="xref py py-mod docutils literal notranslate"><span class="pre">sqlite3</span></code> がこの接続(connection)のために内部的にキャッシュするSQL文(statements)の数で、 パース時のオーバーヘッドを回避します。 デフォルトでは、128 文(statements)です。</p></li>
<li><p><strong>uri</strong> (<a class="reference internal" href="functions.html#bool" title="bool"><em>bool</em></a>) -- <code class="docutils literal notranslate"><span class="pre">True</span></code> に設定すると、 <em>database</em> は、ファイル・パス(path)とオプションのクエリ文字列を含む <abbr title="Uniform Resource Identifier">URI</abbr> として解釈されます。 スキームの部分は <code class="docutils literal notranslate"><span class="pre">&quot;file:&quot;</span></code> でなければならず、パス(path)は相対パスまたは絶対パスにすることができます。 クエリ文字列により、 パラメーターを SQLite に渡すことができ、さまざまな <a class="reference internal" href="sqlite3.html#sqlite3-uri-tricks"><span class="std std-ref">SQLite URI の操作方法</span></a> が有効になります。</p></li>
<li><p><strong>autocommit</strong> (<a class="reference internal" href="functions.html#bool" title="bool"><em>bool</em></a>) -- Control <span class="target" id="index-2"></span><a class="pep reference external" href="https://peps.python.org/pep-0249/"><strong>PEP 249</strong></a> transaction handling behaviour.
See <a class="reference internal" href="sqlite3.html#sqlite3.Connection.autocommit" title="sqlite3.Connection.autocommit"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Connection.autocommit</span></code></a> and
<a class="reference internal" href="sqlite3.html#sqlite3-transaction-control-autocommit"><span class="std std-ref">autocommit 属性に依るトランザクション制御</span></a> for more information.
<em>autocommit</em> currently defaults to
<a class="reference internal" href="sqlite3.html#sqlite3.LEGACY_TRANSACTION_CONTROL" title="sqlite3.LEGACY_TRANSACTION_CONTROL"><code class="xref py py-const docutils literal notranslate"><span class="pre">LEGACY_TRANSACTION_CONTROL</span></code></a>.
The default will change to <code class="docutils literal notranslate"><span class="pre">False</span></code> in a future Python release.</p></li>
</ul>
</dd>
<dt class="field-even">戻り値の型<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="sqlite3.html#sqlite3.Connection" title="sqlite3.Connection"><em>Connection</em></a></p>
</dd>
</dl>
<p class="audit-hook">引数 <code class="docutils literal notranslate"><span class="pre">database</span></code> を指定して <a class="reference internal" href="sys.html#auditing"><span class="std std-ref">監査イベント</span></a> <code class="docutils literal notranslate"><span class="pre">sqlite3.connect</span></code> を送出します。</p>
<p class="audit-hook">引数 <code class="docutils literal notranslate"><span class="pre">connection_handle</span></code> を指定して <a class="reference internal" href="sys.html#auditing"><span class="std std-ref">監査イベント</span></a> <code class="docutils literal notranslate"><span class="pre">sqlite3.connect/handle</span></code> を送出します。</p>
<div class="versionchanged">
<p><span class="versionmodified changed">バージョン 3.4 で変更: </span><code class="docutils literal notranslate"><span class="pre">uri</span></code> パラメータが追加されました。</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">バージョン 3.7 で変更: </span><em>database</em> は、文字列だけでなく、 <a class="reference internal" href="../glossary.html#term-path-like-object"><span class="xref std std-term">path-like object</span></a> にすることもできるようになりました。</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">バージョン 3.10 で変更: </span>Added the <code class="docutils literal notranslate"><span class="pre">sqlite3.connect/handle</span></code> auditing event.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">バージョン 3.12 で変更: </span>Added the <em>autocommit</em> parameter.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sqlite3.complete_statement">
<span class="sig-prename descclassname"><span class="pre">sqlite3.</span></span><span class="sig-name descname"><span class="pre">complete_statement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">statement</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="sqlite3.html#sqlite3.complete_statement" title="Link to this definition">¶</a></dt>
<dd><p>文字列 <em>statement</em> が 1 つ以上の完全な SQL 文を含んでいるように見える場合、 <code class="docutils literal notranslate"><span class="pre">True</span></code> を返します。 閉じられていない文字列リテラルがないことと、文がセミコロンで終了していることを確認する以外の、構文の検証やパースは行われません。</p>
<p>例えば:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sqlite3</span><span class="o">.</span><span class="n">complete_statement</span><span class="p">(</span><span class="s2">&quot;SELECT foo FROM bar;&quot;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sqlite3</span><span class="o">.</span><span class="n">complete_statement</span><span class="p">(</span><span class="s2">&quot;SELECT foo&quot;</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<p>この関数は、コマンドライン入力時に便利で、入力されたテキストが完全な SQL 文を形成しているように見えるかどうか、または <a class="reference internal" href="sqlite3.html#sqlite3.Cursor.execute" title="sqlite3.Cursor.execute"><code class="xref py py-meth docutils literal notranslate"><span class="pre">execute()</span></code></a> を呼び出す前に追加の入力が必要かどうかを判断するのに使えます。</p>
<p>実際の使用例については、 <a class="reference external" href="https://github.com/python/cpython/tree/3.12/Lib/sqlite3/__main__.py">Lib/sqlite3/__main__.py</a> の <code class="xref py py-func docutils literal notranslate"><span class="pre">runsource()</span></code> を参照してください。</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sqlite3.enable_callback_tracebacks">
<span class="sig-prename descclassname"><span class="pre">sqlite3.</span></span><span class="sig-name descname"><span class="pre">enable_callback_tracebacks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flag</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="sqlite3.html#sqlite3.enable_callback_tracebacks" title="Link to this definition">¶</a></dt>
<dd><p>コールバックのトレースバックを有効または無効にします。  デフォルトでは、ユーザー定義関数や集計関数や変換関数や authorizer コールバックなどではトレースバックを取得しません。それらをデバッグしたい場合は、 <em>flag</em> を <code class="docutils literal notranslate"><span class="pre">True</span></code> に設定してこの関数を呼び出し。その後、 <a class="reference internal" href="sys.html#sys.stderr" title="sys.stderr"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.stderr</span></code></a> のコールバックからトレースバックを取得します。 機能を再び無効にするには <code class="docutils literal notranslate"><span class="pre">False</span></code> を使用します。</p>
<div class="admonition note">
<p class="admonition-title">注釈</p>
<p>Errors in user-defined function callbacks are logged as unraisable exceptions.
Use an <a class="reference internal" href="sys.html#sys.unraisablehook" title="sys.unraisablehook"><code class="xref py py-func docutils literal notranslate"><span class="pre">unraisable</span> <span class="pre">hook</span> <span class="pre">handler</span></code></a> for
introspection of the failed callback.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sqlite3.register_adapter">
<span class="sig-prename descclassname"><span class="pre">sqlite3.</span></span><span class="sig-name descname"><span class="pre">register_adapter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adapter</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="sqlite3.html#sqlite3.register_adapter" title="Link to this definition">¶</a></dt>
<dd><p><em>adapter</em> <a class="reference internal" href="../glossary.html#term-callable"><span class="xref std std-term">呼び出し可能オブジェクト</span></a> を登録して、 Python 型の <em>type</em> を SQLite の型に適合させます。適合関数(adapter)アダプターは、 Python 型 <em>type</em> の Python オブジェクトを唯一の引数として使用して呼び出され、 <a class="reference internal" href="sqlite3.html#sqlite3-types"><span class="std std-ref">SQLite がネイティブに理解する型</span></a> の値を返す必要があります。</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sqlite3.register_converter">
<span class="sig-prename descclassname"><span class="pre">sqlite3.</span></span><span class="sig-name descname"><span class="pre">register_converter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">typename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">converter</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="sqlite3.html#sqlite3.register_converter" title="Link to this definition">¶</a></dt>
<dd><p><em>converter</em> <a class="reference internal" href="../glossary.html#term-callable"><span class="xref std std-term">呼び出し可能オブジェクト</span></a> を登録して、 <em>typename</em> 型の SQLite オブジェクトを指定の型の Python オブジェクトに変換します。変換関数(converter)、 <em>typename</em> 型のすべての SQLite 値に対して呼び出されます。 変換関数には <a class="reference internal" href="stdtypes.html#bytes" title="bytes"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></a> オブジェクトが渡され、目的の Python 型のオブジェクトを返す必要があります。型検出の仕組みについては、 <a class="reference internal" href="sqlite3.html#sqlite3.connect" title="sqlite3.connect"><code class="xref py py-func docutils literal notranslate"><span class="pre">connect()</span></code></a> のパラメーター <em>detect_types</em> を参照してください。</p>
<p>注釈: <em>typename</em> とクエリ内の型の名前は、大文字小文字を区別せずにマッチングされます。</p>
</dd></dl>

</section>
<section id="module-constants">
<span id="sqlite3-module-constants"></span><h3>モジュール定数<a class="headerlink" href="sqlite3.html#module-constants" title="Link to this heading">¶</a></h3>
<dl class="py data">
<dt class="sig sig-object py" id="sqlite3.LEGACY_TRANSACTION_CONTROL">
<span class="sig-prename descclassname"><span class="pre">sqlite3.</span></span><span class="sig-name descname"><span class="pre">LEGACY_TRANSACTION_CONTROL</span></span><a class="headerlink" href="sqlite3.html#sqlite3.LEGACY_TRANSACTION_CONTROL" title="Link to this definition">¶</a></dt>
<dd><p>古いスタイル (Python 3.12 より前) のトランザクション制御の振る舞いを選択するには、 <a class="reference internal" href="sqlite3.html#sqlite3.Connection.autocommit" title="sqlite3.Connection.autocommit"><code class="xref py py-attr docutils literal notranslate"><span class="pre">autocommit</span></code></a> に、この定数を設定します。詳細については <a class="reference internal" href="sqlite3.html#sqlite3-transaction-control-isolation-level"><span class="std std-ref">isolation_level 属性に依るトランザクション制御</span></a> を参照してください。</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="sqlite3.PARSE_COLNAMES">
<span class="sig-prename descclassname"><span class="pre">sqlite3.</span></span><span class="sig-name descname"><span class="pre">PARSE_COLNAMES</span></span><a class="headerlink" href="sqlite3.html#sqlite3.PARSE_COLNAMES" title="Link to this definition">¶</a></dt>
<dd><p>このフラグ値を <a class="reference internal" href="sqlite3.html#sqlite3.connect" title="sqlite3.connect"><code class="xref py py-func docutils literal notranslate"><span class="pre">connect()</span></code></a> の <em>detect_types</em> パラメーターに渡し、クエリの列(column)名からパースされた型名を変換関数辞書(converter dictionary)のキーとして使用して変換関数を探します。型名は角括弧(<code class="docutils literal notranslate"><span class="pre">[]</span></code>)で囲む必要があります。</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="ss">&quot;p [point]&quot;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">test</span><span class="p">;</span><span class="w">  </span><span class="o">!</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">look</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">converter</span><span class="w"> </span><span class="ss">&quot;point&quot;</span>
</pre></div>
</div>
<p>このフラグは <code class="docutils literal notranslate"><span class="pre">|</span></code> (ビット論理和)演算子を使用して <a class="reference internal" href="sqlite3.html#sqlite3.PARSE_DECLTYPES" title="sqlite3.PARSE_DECLTYPES"><code class="xref py py-const docutils literal notranslate"><span class="pre">PARSE_DECLTYPES</span></code></a> と組み合わせることができます。</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="sqlite3.PARSE_DECLTYPES">
<span class="sig-prename descclassname"><span class="pre">sqlite3.</span></span><span class="sig-name descname"><span class="pre">PARSE_DECLTYPES</span></span><a class="headerlink" href="sqlite3.html#sqlite3.PARSE_DECLTYPES" title="Link to this definition">¶</a></dt>
<dd><p>このフラグ値を <a class="reference internal" href="sqlite3.html#sqlite3.connect" title="sqlite3.connect"><code class="xref py py-func docutils literal notranslate"><span class="pre">connect()</span></code></a> の <em>detect_types</em> パラメーターに渡して、各列(column)で宣言した型を使用して変換関数を探します。型は、データベース・テーブルの作成時に宣言します。 <code class="xref py py-mod docutils literal notranslate"><span class="pre">sqlite3</span></code> は、宣言された型の、最初の単語を、変換関数辞書(converter dictionary)のキーとして使用して、変換関数を探します。例えば:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">test</span><span class="p">(</span>
<span class="w">   </span><span class="n">i</span><span class="w"> </span><span class="nb">integer</span><span class="w"> </span><span class="k">primary</span><span class="w"> </span><span class="k">key</span><span class="p">,</span><span class="w">  </span><span class="o">!</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">look</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">converter</span><span class="w"> </span><span class="n">named</span><span class="w"> </span><span class="ss">&quot;integer&quot;</span>
<span class="w">   </span><span class="n">p</span><span class="w"> </span><span class="n">point</span><span class="p">,</span><span class="w">                </span><span class="o">!</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">look</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">converter</span><span class="w"> </span><span class="n">named</span><span class="w"> </span><span class="ss">&quot;point&quot;</span>
<span class="w">   </span><span class="n">n</span><span class="w"> </span><span class="nb">number</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w">            </span><span class="o">!</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">look</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">converter</span><span class="w"> </span><span class="n">named</span><span class="w"> </span><span class="ss">&quot;number&quot;</span>
<span class="w"> </span><span class="p">)</span>
</pre></div>
</div>
<p>このフラグは <code class="docutils literal notranslate"><span class="pre">|</span></code> (ビット論理和)演算子を使用して <a class="reference internal" href="sqlite3.html#sqlite3.PARSE_COLNAMES" title="sqlite3.PARSE_COLNAMES"><code class="xref py py-const docutils literal notranslate"><span class="pre">PARSE_COLNAMES</span></code></a> と組み合わせることができます。</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="sqlite3.SQLITE_OK">
<span class="sig-prename descclassname"><span class="pre">sqlite3.</span></span><span class="sig-name descname"><span class="pre">SQLITE_OK</span></span><a class="headerlink" href="sqlite3.html#sqlite3.SQLITE_OK" title="Link to this definition">¶</a></dt>
<dt class="sig sig-object py" id="sqlite3.SQLITE_DENY">
<span class="sig-prename descclassname"><span class="pre">sqlite3.</span></span><span class="sig-name descname"><span class="pre">SQLITE_DENY</span></span><a class="headerlink" href="sqlite3.html#sqlite3.SQLITE_DENY" title="Link to this definition">¶</a></dt>
<dt class="sig sig-object py" id="sqlite3.SQLITE_IGNORE">
<span class="sig-prename descclassname"><span class="pre">sqlite3.</span></span><span class="sig-name descname"><span class="pre">SQLITE_IGNORE</span></span><a class="headerlink" href="sqlite3.html#sqlite3.SQLITE_IGNORE" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="sqlite3.html#sqlite3.Connection.set_authorizer" title="sqlite3.Connection.set_authorizer"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Connection.set_authorizer()</span></code></a> に渡す <a class="reference internal" href="../glossary.html#term-callable"><span class="xref std std-term">呼び出し可能オブジェクト</span></a> が返す必要のあるフラグ。これらは以下の意味です:</p>
<ul class="simple">
<li><p>アクセスは許可されました(<code class="xref py py-const docutils literal notranslate"><span class="pre">SQLITE_OK</span></code>)</p></li>
<li><p>当該SQL文全体の実行をエラーで中止(abort)する必要があります(<code class="xref py py-const docutils literal notranslate"><span class="pre">SQLITE_DENY</span></code>)</p></li>
<li><p>列(column)は <code class="docutils literal notranslate"><span class="pre">NULL</span></code> 値として扱う必要がありますが、当該SQL文の実行は続行する必要があります(<code class="xref py py-const docutils literal notranslate"><span class="pre">SQLITE_IGNORE</span></code>)</p></li>
</ul>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="sqlite3.apilevel">
<span class="sig-prename descclassname"><span class="pre">sqlite3.</span></span><span class="sig-name descname"><span class="pre">apilevel</span></span><a class="headerlink" href="sqlite3.html#sqlite3.apilevel" title="Link to this definition">¶</a></dt>
<dd><p>サポートされている DB-API レベルを示す文字列定数。 DB-API で必要です。 <code class="docutils literal notranslate"><span class="pre">&quot;2.0&quot;</span></code> とハードコーディングされています。</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="sqlite3.paramstyle">
<span class="sig-prename descclassname"><span class="pre">sqlite3.</span></span><span class="sig-name descname"><span class="pre">paramstyle</span></span><a class="headerlink" href="sqlite3.html#sqlite3.paramstyle" title="Link to this definition">¶</a></dt>
<dd><p><code class="xref py py-mod docutils literal notranslate"><span class="pre">sqlite3</span></code> モジュールが期待するパラメータ・マーカーのフォーマットの種類をあらわす文字列定数です。 DB-API で必要です。 <code class="docutils literal notranslate"><span class="pre">&quot;qmark&quot;</span></code> とハードコーディングされています。</p>
<div class="admonition note">
<p class="admonition-title">注釈</p>
<p><code class="docutils literal notranslate"><span class="pre">named</span></code> DB-API パラメータ・スタイルもサポートされています。</p>
</div>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="sqlite3.sqlite_version">
<span class="sig-prename descclassname"><span class="pre">sqlite3.</span></span><span class="sig-name descname"><span class="pre">sqlite_version</span></span><a class="headerlink" href="sqlite3.html#sqlite3.sqlite_version" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="stdtypes.html#str" title="str"><code class="xref py py-class docutils literal notranslate"><span class="pre">文字列</span></code></a> としての、ランタイム SQLite ライブラリのバージョン番号。</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="sqlite3.sqlite_version_info">
<span class="sig-prename descclassname"><span class="pre">sqlite3.</span></span><span class="sig-name descname"><span class="pre">sqlite_version_info</span></span><a class="headerlink" href="sqlite3.html#sqlite3.sqlite_version_info" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="functions.html#int" title="int"><code class="xref py py-class docutils literal notranslate"><span class="pre">整数</span></code></a> の <a class="reference internal" href="stdtypes.html#tuple" title="tuple"><code class="xref py py-class docutils literal notranslate"><span class="pre">タプル</span></code></a> としての、ランタイム SQLite ライブラリのバージョン番号。</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="sqlite3.threadsafety">
<span class="sig-prename descclassname"><span class="pre">sqlite3.</span></span><span class="sig-name descname"><span class="pre">threadsafety</span></span><a class="headerlink" href="sqlite3.html#sqlite3.threadsafety" title="Link to this definition">¶</a></dt>
<dd><p><code class="xref py py-mod docutils literal notranslate"><span class="pre">sqlite3</span></code> モジュールがサポートするスレッドセーフのレベルを示す、DB-API 2.0 で必要な整数定数。 この属性は、背後の SQLite ライブラリのコンパイル時のデフォルトの SQLite スレッド・モード (<a class="reference external" href="https://sqlite.org/threadsafe.html">threading mode</a>)に基づいて設定されます。 SQLite のスレッド・モードは以下のとおりです:</p>
<ol class="arabic simple">
<li><p><strong>シングル・スレッド</strong>: このモードでは、すべてのミューテックスが無効になり、一度に複数のスレッドで SQLite を使用するのは安全ではありません。</p></li>
<li><p><strong>マルチ・スレッド</strong>: このモードでは、 1 つのデータベース接続が 2 つ以上のスレッドで同時に使用されない限り、複数のスレッドで SQLite を安全に使用できます。</p></li>
<li><p><strong>直列化</strong>: 直列化(serialized)モードでは、 SQLite を複数のスレッドで制限なく安全に使用できます。</p></li>
</ol>
<p>SQLite スレッド・モードと、 DB-API 2.0 のスレッドセーフ・レベルとの対応は以下のとおりです:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>SQLite スレッド・モード</p></th>
<th class="head"><p>スレッドセーフ・レベル(<a class="reference external" href="https://peps.python.org/pep-0249/#threadsafety">threadsafety</a>)</p></th>
<th class="head"><p><a class="reference external" href="https://sqlite.org/compile.html#threadsafe">SQLITE_THREADSAFE</a></p></th>
<th class="head"><p>DB-API 2.0 での意味</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>シングル・スレッド</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>スレッドはモジュールを共有できません</p></td>
</tr>
<tr class="row-odd"><td><p>マルチ・スレッド</p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td><p>スレッドはモジュールを共有できますが、接続は共有できません</p></td>
</tr>
<tr class="row-even"><td><p>直列化</p></td>
<td><p>3</p></td>
<td><p>1</p></td>
<td><p>スレッドは、モジュールや接続やカーソルを共有できます</p></td>
</tr>
</tbody>
</table>
<div class="versionchanged">
<p><span class="versionmodified changed">バージョン 3.11 で変更: </span><code class="docutils literal notranslate"><span class="pre">1</span></code> とハード・コーディングする代わりに <em>threadsafety</em> を動的に設定します。</p>
</div>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="sqlite3.version">
<span class="sig-prename descclassname"><span class="pre">sqlite3.</span></span><span class="sig-name descname"><span class="pre">version</span></span><a class="headerlink" href="sqlite3.html#sqlite3.version" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="stdtypes.html#str" title="str"><code class="xref py py-class docutils literal notranslate"><span class="pre">文字列</span></code></a> としての、このモジュールのバージョン番号。これは SQLite ライブラリのバージョン番号ではありません。</p>
<div class="deprecated-removed">
<p><span class="versionmodified">バージョン 3.12 で非推奨、バージョン 3.14 で削除予定: </span>この定数は、 <code class="xref py py-mod docutils literal notranslate"><span class="pre">sqlite3</span></code> へのアップストリーム変更に使用されていたサードパーティ・ライブラリである、 <code class="docutils literal notranslate"><span class="pre">pysqlite</span></code> パッケージのバージョン番号を反映していました。今やこれには何の意味も無いし実用的な価値もありません。</p>
</div>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="sqlite3.version_info">
<span class="sig-prename descclassname"><span class="pre">sqlite3.</span></span><span class="sig-name descname"><span class="pre">version_info</span></span><a class="headerlink" href="sqlite3.html#sqlite3.version_info" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="functions.html#int" title="int"><code class="xref py py-class docutils literal notranslate"><span class="pre">整数</span></code></a> の <a class="reference internal" href="stdtypes.html#tuple" title="tuple"><code class="xref py py-class docutils literal notranslate"><span class="pre">タプル</span></code></a> としての、このモジュールのバージョン番号。これは SQLite ライブラリのバージョン番号ではありません。</p>
<div class="deprecated-removed">
<p><span class="versionmodified">バージョン 3.12 で非推奨、バージョン 3.14 で削除予定: </span>この定数は、 <code class="xref py py-mod docutils literal notranslate"><span class="pre">sqlite3</span></code> へのアップストリーム変更に使用されていたサードパーティ・ライブラリである、 <code class="docutils literal notranslate"><span class="pre">pysqlite</span></code> パッケージのバージョン番号を反映していました。今やこれには何の意味も無いし実用的な価値もありません。</p>
</div>
</dd></dl>

<dl class="py data" id="sqlite3-dbconfig-constants">
<dt class="sig sig-object py" id="sqlite3.SQLITE_DBCONFIG_DEFENSIVE">
<span class="sig-prename descclassname"><span class="pre">sqlite3.</span></span><span class="sig-name descname"><span class="pre">SQLITE_DBCONFIG_DEFENSIVE</span></span><a class="headerlink" href="sqlite3.html#sqlite3.SQLITE_DBCONFIG_DEFENSIVE" title="Link to this definition">¶</a></dt>
<dt class="sig sig-object py" id="sqlite3.SQLITE_DBCONFIG_DQS_DDL">
<span class="sig-prename descclassname"><span class="pre">sqlite3.</span></span><span class="sig-name descname"><span class="pre">SQLITE_DBCONFIG_DQS_DDL</span></span><a class="headerlink" href="sqlite3.html#sqlite3.SQLITE_DBCONFIG_DQS_DDL" title="Link to this definition">¶</a></dt>
<dt class="sig sig-object py" id="sqlite3.SQLITE_DBCONFIG_DQS_DML">
<span class="sig-prename descclassname"><span class="pre">sqlite3.</span></span><span class="sig-name descname"><span class="pre">SQLITE_DBCONFIG_DQS_DML</span></span><a class="headerlink" href="sqlite3.html#sqlite3.SQLITE_DBCONFIG_DQS_DML" title="Link to this definition">¶</a></dt>
<dt class="sig sig-object py" id="sqlite3.SQLITE_DBCONFIG_ENABLE_FKEY">
<span class="sig-prename descclassname"><span class="pre">sqlite3.</span></span><span class="sig-name descname"><span class="pre">SQLITE_DBCONFIG_ENABLE_FKEY</span></span><a class="headerlink" href="sqlite3.html#sqlite3.SQLITE_DBCONFIG_ENABLE_FKEY" title="Link to this definition">¶</a></dt>
<dt class="sig sig-object py" id="sqlite3.SQLITE_DBCONFIG_ENABLE_FTS3_TOKENIZER">
<span class="sig-prename descclassname"><span class="pre">sqlite3.</span></span><span class="sig-name descname"><span class="pre">SQLITE_DBCONFIG_ENABLE_FTS3_TOKENIZER</span></span><a class="headerlink" href="sqlite3.html#sqlite3.SQLITE_DBCONFIG_ENABLE_FTS3_TOKENIZER" title="Link to this definition">¶</a></dt>
<dt class="sig sig-object py" id="sqlite3.SQLITE_DBCONFIG_ENABLE_LOAD_EXTENSION">
<span class="sig-prename descclassname"><span class="pre">sqlite3.</span></span><span class="sig-name descname"><span class="pre">SQLITE_DBCONFIG_ENABLE_LOAD_EXTENSION</span></span><a class="headerlink" href="sqlite3.html#sqlite3.SQLITE_DBCONFIG_ENABLE_LOAD_EXTENSION" title="Link to this definition">¶</a></dt>
<dt class="sig sig-object py" id="sqlite3.SQLITE_DBCONFIG_ENABLE_QPSG">
<span class="sig-prename descclassname"><span class="pre">sqlite3.</span></span><span class="sig-name descname"><span class="pre">SQLITE_DBCONFIG_ENABLE_QPSG</span></span><a class="headerlink" href="sqlite3.html#sqlite3.SQLITE_DBCONFIG_ENABLE_QPSG" title="Link to this definition">¶</a></dt>
<dt class="sig sig-object py" id="sqlite3.SQLITE_DBCONFIG_ENABLE_TRIGGER">
<span class="sig-prename descclassname"><span class="pre">sqlite3.</span></span><span class="sig-name descname"><span class="pre">SQLITE_DBCONFIG_ENABLE_TRIGGER</span></span><a class="headerlink" href="sqlite3.html#sqlite3.SQLITE_DBCONFIG_ENABLE_TRIGGER" title="Link to this definition">¶</a></dt>
<dt class="sig sig-object py" id="sqlite3.SQLITE_DBCONFIG_ENABLE_VIEW">
<span class="sig-prename descclassname"><span class="pre">sqlite3.</span></span><span class="sig-name descname"><span class="pre">SQLITE_DBCONFIG_ENABLE_VIEW</span></span><a class="headerlink" href="sqlite3.html#sqlite3.SQLITE_DBCONFIG_ENABLE_VIEW" title="Link to this definition">¶</a></dt>
<dt class="sig sig-object py" id="sqlite3.SQLITE_DBCONFIG_LEGACY_ALTER_TABLE">
<span class="sig-prename descclassname"><span class="pre">sqlite3.</span></span><span class="sig-name descname"><span class="pre">SQLITE_DBCONFIG_LEGACY_ALTER_TABLE</span></span><a class="headerlink" href="sqlite3.html#sqlite3.SQLITE_DBCONFIG_LEGACY_ALTER_TABLE" title="Link to this definition">¶</a></dt>
<dt class="sig sig-object py" id="sqlite3.SQLITE_DBCONFIG_LEGACY_FILE_FORMAT">
<span class="sig-prename descclassname"><span class="pre">sqlite3.</span></span><span class="sig-name descname"><span class="pre">SQLITE_DBCONFIG_LEGACY_FILE_FORMAT</span></span><a class="headerlink" href="sqlite3.html#sqlite3.SQLITE_DBCONFIG_LEGACY_FILE_FORMAT" title="Link to this definition">¶</a></dt>
<dt class="sig sig-object py" id="sqlite3.SQLITE_DBCONFIG_NO_CKPT_ON_CLOSE">
<span class="sig-prename descclassname"><span class="pre">sqlite3.</span></span><span class="sig-name descname"><span class="pre">SQLITE_DBCONFIG_NO_CKPT_ON_CLOSE</span></span><a class="headerlink" href="sqlite3.html#sqlite3.SQLITE_DBCONFIG_NO_CKPT_ON_CLOSE" title="Link to this definition">¶</a></dt>
<dt class="sig sig-object py" id="sqlite3.SQLITE_DBCONFIG_RESET_DATABASE">
<span class="sig-prename descclassname"><span class="pre">sqlite3.</span></span><span class="sig-name descname"><span class="pre">SQLITE_DBCONFIG_RESET_DATABASE</span></span><a class="headerlink" href="sqlite3.html#sqlite3.SQLITE_DBCONFIG_RESET_DATABASE" title="Link to this definition">¶</a></dt>
<dt class="sig sig-object py" id="sqlite3.SQLITE_DBCONFIG_TRIGGER_EQP">
<span class="sig-prename descclassname"><span class="pre">sqlite3.</span></span><span class="sig-name descname"><span class="pre">SQLITE_DBCONFIG_TRIGGER_EQP</span></span><a class="headerlink" href="sqlite3.html#sqlite3.SQLITE_DBCONFIG_TRIGGER_EQP" title="Link to this definition">¶</a></dt>
<dt class="sig sig-object py" id="sqlite3.SQLITE_DBCONFIG_TRUSTED_SCHEMA">
<span class="sig-prename descclassname"><span class="pre">sqlite3.</span></span><span class="sig-name descname"><span class="pre">SQLITE_DBCONFIG_TRUSTED_SCHEMA</span></span><a class="headerlink" href="sqlite3.html#sqlite3.SQLITE_DBCONFIG_TRUSTED_SCHEMA" title="Link to this definition">¶</a></dt>
<dt class="sig sig-object py" id="sqlite3.SQLITE_DBCONFIG_WRITABLE_SCHEMA">
<span class="sig-prename descclassname"><span class="pre">sqlite3.</span></span><span class="sig-name descname"><span class="pre">SQLITE_DBCONFIG_WRITABLE_SCHEMA</span></span><a class="headerlink" href="sqlite3.html#sqlite3.SQLITE_DBCONFIG_WRITABLE_SCHEMA" title="Link to this definition">¶</a></dt>
<dd><p>これらの定数は、 <a class="reference internal" href="sqlite3.html#sqlite3.Connection.setconfig" title="sqlite3.Connection.setconfig"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Connection.setconfig()</span></code></a> メソッド や <a class="reference internal" href="sqlite3.html#sqlite3.Connection.getconfig" title="sqlite3.Connection.getconfig"><code class="xref py py-meth docutils literal notranslate"><span class="pre">getconfig()</span></code></a> メソッドで使用されます。</p>
<p>これらの定数が利用できるかどうかは、 Python にコンパイルされた SQLite のバージョンによって異なります。</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 3.12.</span></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">参考</p>
<dl class="simple">
<dt><a class="reference external" href="https://www.sqlite.org/c3ref/c_dbconfig_defensive.html">https://www.sqlite.org/c3ref/c_dbconfig_defensive.html</a></dt><dd><p>SQLite docs: Database Connection Configuration Options</p>
</dd>
</dl>
</div>
</dd></dl>

</section>
<section id="connection-objects">
<span id="sqlite3-connection-objects"></span><h3>Connection オブジェクト<a class="headerlink" href="sqlite3.html#connection-objects" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="sqlite3.Connection">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlite3.</span></span><span class="sig-name descname"><span class="pre">Connection</span></span><a class="headerlink" href="sqlite3.html#sqlite3.Connection" title="Link to this definition">¶</a></dt>
<dd><p>開いた SQLite データベースの各々は、 <a class="reference internal" href="sqlite3.html#sqlite3.connect" title="sqlite3.connect"><code class="xref py py-func docutils literal notranslate"><span class="pre">sqlite3.connect()</span></code></a> を使用して作成される <code class="docutils literal notranslate"><span class="pre">Connection</span></code> オブジェクトによって表されます。<code class="docutils literal notranslate"><span class="pre">Connection</span></code> オブジェクトの主な目的は <a class="reference internal" href="sqlite3.html#sqlite3.Cursor" title="sqlite3.Cursor"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cursor</span></code></a> オブジェクトの作成と <a class="reference internal" href="sqlite3.html#sqlite3-controlling-transactions"><span class="std std-ref">トランザクション制御</span></a> です。</p>
<div class="admonition seealso">
<p class="admonition-title">参考</p>
<ul class="simple">
<li><p><a class="reference internal" href="sqlite3.html#sqlite3-connection-shortcuts"><span class="std std-ref">接続(connection)ショートカット・メソッドの使い方</span></a></p></li>
<li><p><a class="reference internal" href="sqlite3.html#sqlite3-connection-context-manager"><span class="std std-ref">接続(connection)コンテキストマネージャの使い方</span></a></p></li>
</ul>
</div>
<p>SQLite データベース接続(connection)には、以下の属性とメソッドがあります:</p>
<dl class="py method">
<dt class="sig sig-object py" id="sqlite3.Connection.cursor">
<span class="sig-name descname"><span class="pre">cursor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">factory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Cursor</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="sqlite3.html#sqlite3.Connection.cursor" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="sqlite3.html#sqlite3.Cursor" title="sqlite3.Cursor"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cursor</span></code></a> オブジェクトを作成して返します。 cursor メソッドは、単一のオプション・パラメーター <em>factory</em> を受け入れます。 <em>factory</em> を指定する場合、これは <a class="reference internal" href="sqlite3.html#sqlite3.Cursor" title="sqlite3.Cursor"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cursor</span></code></a> またはそのサブクラスのインスタンスを返す <a class="reference internal" href="../glossary.html#term-callable"><span class="xref std std-term">呼び出し可能オブジェクト</span></a> である必要があります。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlite3.Connection.blobopen">
<span class="sig-name descname"><span class="pre">blobopen</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">column</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">row</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">readonly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'main'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="sqlite3.html#sqlite3.Connection.blobopen" title="Link to this definition">¶</a></dt>
<dd><p>既存の <abbr title="Binary Large OBject">BLOB</abbr> への <a class="reference internal" href="sqlite3.html#sqlite3.Blob" title="sqlite3.Blob"><code class="xref py py-class docutils literal notranslate"><span class="pre">Blob</span></code></a> ハンドルを開きます。</p>
<dl class="field-list simple">
<dt class="field-odd">パラメータ<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>table</strong> (<a class="reference internal" href="stdtypes.html#str" title="str"><em>str</em></a>) -- 当該 BLOB が配置されているテーブルの名前。</p></li>
<li><p><strong>column</strong> (<a class="reference internal" href="stdtypes.html#str" title="str"><em>str</em></a>) -- 当該 BLOB が配置されている列(column)の名前。</p></li>
<li><p><strong>row</strong> (<a class="reference internal" href="stdtypes.html#str" title="str"><em>str</em></a>) -- 当該 BLOB が配置されている行(row)の名前。</p></li>
<li><p><strong>readonly</strong> (<a class="reference internal" href="functions.html#bool" title="bool"><em>bool</em></a>) -- 書き込み権限なしで BLOB を開く必要がある場合は、 <code class="docutils literal notranslate"><span class="pre">True</span></code> に設定します。 デフォルトは <code class="docutils literal notranslate"><span class="pre">False</span></code> です。</p></li>
<li><p><strong>name</strong> (<a class="reference internal" href="stdtypes.html#str" title="str"><em>str</em></a>) -- 当該 BLOB が配置されているデータベース名。 デフォルトは <code class="docutils literal notranslate"><span class="pre">&quot;main&quot;</span></code> です。</p></li>
</ul>
</dd>
<dt class="field-even">例外<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="sqlite3.html#sqlite3.OperationalError" title="sqlite3.OperationalError"><strong>OperationalError</strong></a> -- <code class="docutils literal notranslate"><span class="pre">WITHOUT</span> <span class="pre">ROWID</span></code> テーブルで BLOB を開こうとしたとき。</p>
</dd>
<dt class="field-odd">戻り値の型<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="sqlite3.html#sqlite3.Blob" title="sqlite3.Blob">Blob</a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">注釈</p>
<p><a class="reference internal" href="sqlite3.html#sqlite3.Blob" title="sqlite3.Blob"><code class="xref py py-class docutils literal notranslate"><span class="pre">Blob</span></code></a> クラスを使用して BLOB のサイズを変更することはできません。 SQL 関数 <code class="docutils literal notranslate"><span class="pre">zeroblob</span></code> を使用すると、固定サイズのブロブを作成します。</p>
</div>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 3.11.</span></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlite3.Connection.commit">
<span class="sig-name descname"><span class="pre">commit</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="sqlite3.html#sqlite3.Connection.commit" title="Link to this definition">¶</a></dt>
<dd><p>保留中のトランザクションをデータベースにコミットします。  <a class="reference internal" href="sqlite3.html#sqlite3.Connection.autocommit" title="sqlite3.Connection.autocommit"><code class="xref py py-attr docutils literal notranslate"><span class="pre">autocommit</span></code></a> が <code class="docutils literal notranslate"><span class="pre">True</span></code> または開いているトランザクションがない場合、このメソッドは何も行いません。 <code class="xref py py-attr docutils literal notranslate"><span class="pre">autocommit</span></code> が <code class="docutils literal notranslate"><span class="pre">False</span></code> の場合に保留中のトランザクションがこのメソッドによってコミットされた場合、新しいトランザクションが暗黙に開かれます。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlite3.Connection.rollback">
<span class="sig-name descname"><span class="pre">rollback</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="sqlite3.html#sqlite3.Connection.rollback" title="Link to this definition">¶</a></dt>
<dd><p>保留中のトランザクションの先頭にロールバックします。 <a class="reference internal" href="sqlite3.html#sqlite3.Connection.autocommit" title="sqlite3.Connection.autocommit"><code class="xref py py-attr docutils literal notranslate"><span class="pre">autocommit</span></code></a> が <code class="docutils literal notranslate"><span class="pre">True</span></code> または開いているトランザクションがない場合、このメソッドは何も行いません。 <code class="xref py py-attr docutils literal notranslate"><span class="pre">autocommit</span></code> が <code class="docutils literal notranslate"><span class="pre">False</span></code> の場合に保留中のトランザクションがこのメソッドによってロールバックされた場合、新しいトランザクションが暗黙に開かれます。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlite3.Connection.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="sqlite3.html#sqlite3.Connection.close" title="Link to this definition">¶</a></dt>
<dd><p>データベース接続を閉じます。 <a class="reference internal" href="sqlite3.html#sqlite3.Connection.autocommit" title="sqlite3.Connection.autocommit"><code class="xref py py-attr docutils literal notranslate"><span class="pre">autocommit</span></code></a> が <code class="docutils literal notranslate"><span class="pre">False</span></code> の場合、保留中のトランザクションは暗黙にロールバックされます。 <code class="xref py py-attr docutils literal notranslate"><span class="pre">autocommit</span></code> が <code class="docutils literal notranslate"><span class="pre">True</span></code> または <a class="reference internal" href="sqlite3.html#sqlite3.LEGACY_TRANSACTION_CONTROL" title="sqlite3.LEGACY_TRANSACTION_CONTROL"><code class="xref py py-data docutils literal notranslate"><span class="pre">LEGACY_TRANSACTION_CONTROL</span></code></a> の場合、暗黙のトランザクション制御は実行されませんので、保留中の変更が失われないように、データベース接続を閉じる前に必ず <a class="reference internal" href="sqlite3.html#sqlite3.Connection.commit" title="sqlite3.Connection.commit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">commit()</span></code></a> を行ってください。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlite3.Connection.execute">
<span class="sig-name descname"><span class="pre">execute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sql</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="sqlite3.html#sqlite3.Connection.execute" title="Link to this definition">¶</a></dt>
<dd><p>新しい <a class="reference internal" href="sqlite3.html#sqlite3.Cursor" title="sqlite3.Cursor"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cursor</span></code></a> オブジェクトを作成し、指定の <em>sql</em> と <em>parameters</em> で <a class="reference internal" href="sqlite3.html#sqlite3.Cursor.execute" title="sqlite3.Cursor.execute"><code class="xref py py-meth docutils literal notranslate"><span class="pre">execute()</span></code></a> を呼び出します。新しいカーソル・オブジェクトを返します。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlite3.Connection.executemany">
<span class="sig-name descname"><span class="pre">executemany</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sql</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="sqlite3.html#sqlite3.Connection.executemany" title="Link to this definition">¶</a></dt>
<dd><p>新しい <a class="reference internal" href="sqlite3.html#sqlite3.Cursor" title="sqlite3.Cursor"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cursor</span></code></a> オブジェクトを作成し、与えられた <em>sql</em> と <em>parameters</em> で <a class="reference internal" href="sqlite3.html#sqlite3.Cursor.executemany" title="sqlite3.Cursor.executemany"><code class="xref py py-meth docutils literal notranslate"><span class="pre">executemany()</span></code></a> を呼び出します。新しいカーソル・オブジェクトを返します。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlite3.Connection.executescript">
<span class="sig-name descname"><span class="pre">executescript</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sql_script</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="sqlite3.html#sqlite3.Connection.executescript" title="Link to this definition">¶</a></dt>
<dd><p>新しい <a class="reference internal" href="sqlite3.html#sqlite3.Cursor" title="sqlite3.Cursor"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cursor</span></code></a> オブジェクトを作成し、指定された <em>sql_script</em> で <a class="reference internal" href="sqlite3.html#sqlite3.Cursor.executescript" title="sqlite3.Cursor.executescript"><code class="xref py py-meth docutils literal notranslate"><span class="pre">executescript()</span></code></a> を呼び出します。新しいカーソル・オブジェクトを返します。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlite3.Connection.create_function">
<span class="sig-name descname"><span class="pre">create_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">narg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deterministic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="sqlite3.html#sqlite3.Connection.create_function" title="Link to this definition">¶</a></dt>
<dd><p>ユーザ定義 SQL 関数を作成または削除します。</p>
<dl class="field-list simple">
<dt class="field-odd">パラメータ<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<a class="reference internal" href="stdtypes.html#str" title="str"><em>str</em></a>) -- SQL 関数の名前。</p></li>
<li><p><strong>narg</strong> (<a class="reference internal" href="functions.html#int" title="int"><em>int</em></a>) -- SQL 関数が受け入れることができる引数の数。 <code class="docutils literal notranslate"><span class="pre">-1</span></code> を指定すると、任意の数の引数を取ることができます。</p></li>
<li><p><strong>func</strong> (<a class="reference internal" href="../glossary.html#term-callback"><span class="xref std std-term">callback</span></a> | None) -- この SQL 関数が呼び出されたときに起動される <a class="reference internal" href="../glossary.html#term-callable"><span class="xref std std-term">呼び出し可能オブジェクト</span></a> 。 この呼び出し可能オブジェクトは、 <a class="reference internal" href="sqlite3.html#sqlite3-types"><span class="std std-ref">SQLite によってネイティブにサポートされる型</span></a> を返すす必要があります。 既存の SQL 関数を削除するには、 <code class="docutils literal notranslate"><span class="pre">None</span></code> に設定します。</p></li>
<li><p><strong>deterministic</strong> (<a class="reference internal" href="functions.html#bool" title="bool"><em>bool</em></a>) -- <code class="docutils literal notranslate"><span class="pre">True</span></code> の場合、作成された SQL 関数は決定論的(<a class="reference external" href="https://sqlite.org/deterministic.html">deterministic</a> : 入力が同一なら常に同一の答えを返す)としてマークされ、SQLite が追加の最適化を実行できるようになります。</p></li>
</ul>
</dd>
<dt class="field-even">例外<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="sqlite3.html#sqlite3.NotSupportedError" title="sqlite3.NotSupportedError"><strong>NotSupportedError</strong></a> -- If <em>deterministic</em> is used with SQLite versions older than 3.8.3.</p>
</dd>
</dl>
<div class="versionchanged">
<p><span class="versionmodified changed">バージョン 3.8 で変更: </span>Added the <em>deterministic</em> parameter.</p>
</div>
<p>例:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">md5sum</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;:memory:&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span><span class="o">.</span><span class="n">create_function</span><span class="p">(</span><span class="s2">&quot;md5&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">md5sum</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">con</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT md5(?)&quot;</span><span class="p">,</span> <span class="p">(</span><span class="sa">b</span><span class="s2">&quot;foo&quot;</span><span class="p">,)):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
<span class="go">(&#39;acbd18db4cc2f85cedef654fccc4a4d8&#39;,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlite3.Connection.create_aggregate">
<span class="sig-name descname"><span class="pre">create_aggregate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_arg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregate_class</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="sqlite3.html#sqlite3.Connection.create_aggregate" title="Link to this definition">¶</a></dt>
<dd><p>ユーザ定義集計関数を作成または削除します。</p>
<dl class="field-list simple">
<dt class="field-odd">パラメータ<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<a class="reference internal" href="stdtypes.html#str" title="str"><em>str</em></a>) -- SQL 集計関数の名前。</p></li>
<li><p><strong>n_arg</strong> (<a class="reference internal" href="functions.html#int" title="int"><em>int</em></a>) -- SQL 集計関数が受け入れることができる引数の数。 <code class="docutils literal notranslate"><span class="pre">-1</span></code> を指定すると、任意の数の引数を取ることができます。</p></li>
<li><p><strong>aggregate_class</strong> (<a class="reference internal" href="../glossary.html#term-class"><span class="xref std std-term">class</span></a> | None) -- <p>クラスは以下のメソッドを実装する必要があります:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">step()</span></code>: 集計に行(row)を足し込みます。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">finalize()</span></code>: 集計の最終結果を <a class="reference internal" href="sqlite3.html#sqlite3-types"><span class="std std-ref">SQLite でネイティブにサポートされている型</span></a> として返します。</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">step()</span></code> メソッドが受け入れなければならない引数の数は <em>n_arg</em> によって制御されます。</p>
<p>既存の SQL 集計関数を削除するには、 <code class="docutils literal notranslate"><span class="pre">None</span></code> に設定します。</p>
</p></li>
</ul>
</dd>
</dl>
<p>例:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MySum</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">+=</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">finalize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span>

<span class="n">con</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;:memory:&quot;</span><span class="p">)</span>
<span class="n">con</span><span class="o">.</span><span class="n">create_aggregate</span><span class="p">(</span><span class="s2">&quot;mysum&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MySum</span><span class="p">)</span>
<span class="n">cur</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;CREATE TABLE test(i)&quot;</span><span class="p">)</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;INSERT INTO test(i) VALUES(1)&quot;</span><span class="p">)</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;INSERT INTO test(i) VALUES(2)&quot;</span><span class="p">)</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT mysum(i) FROM test&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cur</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>

<span class="n">con</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlite3.Connection.create_window_function">
<span class="sig-name descname"><span class="pre">create_window_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregate_class</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="sqlite3.html#sqlite3.Connection.create_window_function" title="Link to this definition">¶</a></dt>
<dd><p>ユーザー定義の集計ウインドウ関数を作成または削除します。</p>
<dl class="field-list simple">
<dt class="field-odd">パラメータ<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<a class="reference internal" href="stdtypes.html#str" title="str"><em>str</em></a>) -- 作成または削除する SQL 集計ウインドウ関数の名前。</p></li>
<li><p><strong>num_params</strong> (<a class="reference internal" href="functions.html#int" title="int"><em>int</em></a>) -- SQL 集計ウィンドウ関数が受け入れることができる引数の数。 <code class="docutils literal notranslate"><span class="pre">-1</span></code> を指定した場合、任意の数の引数を取ることができます。</p></li>
<li><p><strong>aggregate_class</strong> (<a class="reference internal" href="../glossary.html#term-class"><span class="xref std std-term">class</span></a> | None) -- <p>クラスは以下のメソッドを実装する必要があります:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">step()</span></code>: 現在のウィンドウに行を足し込みます。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">value()</span></code>: 集計の現在の値を返します。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">inverse()</span></code>: 現在のウインドウから指定の行(row)の分を削除します。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">finalize()</span></code>: 集計の最終結果を <a class="reference internal" href="sqlite3.html#sqlite3-types"><span class="std std-ref">SQLite でネイティブにサポートされている型</span></a> として返します。</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">step()</span></code> メソッドと <code class="docutils literal notranslate"><span class="pre">value()</span></code> メソッドが受け入れなければならない引数の数は <em>num_params</em> によって制御されます。</p>
<p><code class="docutils literal notranslate"><span class="pre">None</span></code> に設定すると、既存の SQL 集計ウィンドウ関数が削除されます。</p>
</p></li>
</ul>
</dd>
<dt class="field-even">例外<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="sqlite3.html#sqlite3.NotSupportedError" title="sqlite3.NotSupportedError"><strong>NotSupportedError</strong></a> -- 集計ウィンドウ関数をサポートしていない 3.25.0 より古いバージョンの SQLite で使用した場合に送出されます。</p>
</dd>
</dl>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 3.11.</span></p>
</div>
<p>例:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example taken from https://www.sqlite.org/windowfunctions.html#udfwinfunc</span>
<span class="k">class</span> <span class="nc">WindowSumInt</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a row to the current window.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">+=</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">value</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the current value of the aggregate.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span>

    <span class="k">def</span> <span class="nf">inverse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Remove a row from the current window.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">-=</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">finalize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the final value of the aggregate.</span>

<span class="sd">        Any clean-up actions should be placed here.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span>


<span class="n">con</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;:memory:&quot;</span><span class="p">)</span>
<span class="n">cur</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;CREATE TABLE test(x, y)&quot;</span><span class="p">)</span>
<span class="n">values</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;e&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<span class="p">]</span>
<span class="n">cur</span><span class="o">.</span><span class="n">executemany</span><span class="p">(</span><span class="s2">&quot;INSERT INTO test VALUES(?, ?)&quot;</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>
<span class="n">con</span><span class="o">.</span><span class="n">create_window_function</span><span class="p">(</span><span class="s2">&quot;sumint&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">WindowSumInt</span><span class="p">)</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    SELECT x, sumint(y) OVER (</span>
<span class="s2">        ORDER BY x ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING</span>
<span class="s2">    ) AS sum_y</span>
<span class="s2">    FROM test ORDER BY x</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cur</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>
<span class="n">con</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlite3.Connection.create_collation">
<span class="sig-name descname"><span class="pre">create_collation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callable</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="sqlite3.html#sqlite3.Connection.create_collation" title="Link to this definition">¶</a></dt>
<dd><p>照合関数(collating function) <em>callable</em> を使用して <em>name</em> という名前の照合(collation)を作成します。 <em>callable</em> には 2 つの <a class="reference internal" href="stdtypes.html#str" title="str"><code class="xref py py-class docutils literal notranslate"><span class="pre">文字列</span></code></a> 引数が渡され、<a class="reference internal" href="functions.html#int" title="int"><code class="xref py py-class docutils literal notranslate"><span class="pre">整数</span></code></a> を返す必要があります:</p>
<ul class="simple">
<li><p>1 番目の文字列が 2 番目の文字列よりも高い順位ならば <code class="docutils literal notranslate"><span class="pre">1</span></code> を返す</p></li>
<li><p>1 番目の文字列が 2 番目の文字列よりも低い順位ならば <code class="docutils literal notranslate"><span class="pre">-1</span></code>  を返す</p></li>
<li><p>1 番目の文字列と 2 番目の文字列が同じ順位ならば <code class="docutils literal notranslate"><span class="pre">0</span></code>  を返す</p></li>
</ul>
<p>以下は逆順での照合例です:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">collate_reverse</span><span class="p">(</span><span class="n">string1</span><span class="p">,</span> <span class="n">string2</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">string1</span> <span class="o">==</span> <span class="n">string2</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">elif</span> <span class="n">string1</span> <span class="o">&lt;</span> <span class="n">string2</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>

<span class="n">con</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;:memory:&quot;</span><span class="p">)</span>
<span class="n">con</span><span class="o">.</span><span class="n">create_collation</span><span class="p">(</span><span class="s2">&quot;reverse&quot;</span><span class="p">,</span> <span class="n">collate_reverse</span><span class="p">)</span>

<span class="n">cur</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;CREATE TABLE test(x)&quot;</span><span class="p">)</span>
<span class="n">cur</span><span class="o">.</span><span class="n">executemany</span><span class="p">(</span><span class="s2">&quot;INSERT INTO test(x) VALUES(?)&quot;</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;a&quot;</span><span class="p">,),</span> <span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">,)])</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT x FROM test ORDER BY x COLLATE reverse&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">cur</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
<span class="n">con</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>照合関数を削除するには <em>callable</em> を <code class="docutils literal notranslate"><span class="pre">None</span></code> に設定します。</p>
<div class="versionchanged">
<p><span class="versionmodified changed">バージョン 3.11 で変更: </span>照合の名前には任意のユニコード文字を含めることができます。 以前は ASCII 文字のみが許可されていました。</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlite3.Connection.interrupt">
<span class="sig-name descname"><span class="pre">interrupt</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="sqlite3.html#sqlite3.Connection.interrupt" title="Link to this definition">¶</a></dt>
<dd><p>このメソッドを別のスレッドから呼び出して、この接続(connection)で、実行中のすべてのクエリを中止(abort)させます。 中止(abort)させられたクエリは <a class="reference internal" href="sqlite3.html#sqlite3.OperationalError" title="sqlite3.OperationalError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">OperationalError</span></code></a> を送出します。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlite3.Connection.set_authorizer">
<span class="sig-name descname"><span class="pre">set_authorizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">authorizer_callback</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="sqlite3.html#sqlite3.Connection.set_authorizer" title="Link to this definition">¶</a></dt>
<dd><p>データベース内のテーブルの列(column)にアクセスしようとするたびに起動される <a class="reference internal" href="../glossary.html#term-callable"><span class="xref std std-term">呼び出し可能オブジェクト</span></a> <em>authorizer_callback</em> を登録します。 このコールバックは背後の SQLite ライブラリによって列(column)へのアクセスがどのように処理されるかを通知するために、 <a class="reference internal" href="sqlite3.html#sqlite3.SQLITE_OK" title="sqlite3.SQLITE_OK"><code class="xref py py-const docutils literal notranslate"><span class="pre">SQLITE_OK</span></code></a> または <a class="reference internal" href="sqlite3.html#sqlite3.SQLITE_DENY" title="sqlite3.SQLITE_DENY"><code class="xref py py-const docutils literal notranslate"><span class="pre">SQLITE_DENY</span></code></a> または <a class="reference internal" href="sqlite3.html#sqlite3.SQLITE_IGNORE" title="sqlite3.SQLITE_IGNORE"><code class="xref py py-const docutils literal notranslate"><span class="pre">SQLITE_IGNORE</span></code></a> のいずれかを返さなければなりません。</p>
<p>コールバックの最初の引数は、承認(authorize)される操作の種類を示します。 2 番目と 3 番目の引数は、最初の引数に応じて、引数または <code class="docutils literal notranslate"><span class="pre">None</span></code> になります。 4 番目の引数は、該当する場合、データベースの名前(&quot;main&quot; や &quot;temp&quot; 等)です。 5 番目の引数は、 アクセス試行を担当する最も内側のトリガーまたはビューの名前です。このアクセス試行が入力 SQL コードから直接行われた場合は <code class="docutils literal notranslate"><span class="pre">None</span></code> です。</p>
<p>最初の引数に指定可能な値と、 最初の引数に応じた 2 番目と 3 番目の引数の意味については、 SQLite のドキュメントを参照してください。 必要なすべての定数は <code class="xref py py-mod docutils literal notranslate"><span class="pre">sqlite3</span></code> モジュールで利用できます。</p>
<p><em>authorizer_callback</em> として <code class="docutils literal notranslate"><span class="pre">None</span></code> を渡すと、承認機構(authorizer)が無効になります。</p>
<div class="versionchanged">
<p><span class="versionmodified changed">バージョン 3.11 で変更: </span><code class="docutils literal notranslate"><span class="pre">None</span></code> を使用して承認機構(authorizer)を無効にするサポートが追加されました。</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlite3.Connection.set_progress_handler">
<span class="sig-name descname"><span class="pre">set_progress_handler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">progress_handler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="sqlite3.html#sqlite3.Connection.set_progress_handler" title="Link to this definition">¶</a></dt>
<dd><p>SQLite 仮想マシンの命令を <em>n</em> 個実行するごとに呼び出されるように、 <a class="reference internal" href="../glossary.html#term-callable"><span class="xref std std-term">呼び出し可能オブジェクト</span></a> <em>progress_handler</em> を登録します。これは、 GUI の更新など、長時間実行される操作中に SQLite から呼び出されるようにしたい場合に便利です。</p>
<p>以前にインストールした progress ハンドラーをクリアしたい場合は、 <em>progress_handler</em> に <code class="docutils literal notranslate"><span class="pre">None</span></code> を指定してメソッドを呼び出します。</p>
<p>ハンドラー関数からゼロ以外の値を返すと、現在実行中のクエリを終了(terminate)し、 <a class="reference internal" href="sqlite3.html#sqlite3.DatabaseError" title="sqlite3.DatabaseError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">DatabaseError</span></code></a> 例外を送出します。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlite3.Connection.set_trace_callback">
<span class="sig-name descname"><span class="pre">set_trace_callback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trace_callback</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="sqlite3.html#sqlite3.Connection.set_trace_callback" title="Link to this definition">¶</a></dt>
<dd><p>SQLite バックエンドによって実際に実行される SQL 文ごとに起動される <a class="reference internal" href="../glossary.html#term-callable"><span class="xref std std-term">呼び出し可能オブジェクト</span></a> <em>trace_callback</em> を登録します。</p>
<p>コールバックに渡される唯一の引数は、(<a class="reference internal" href="stdtypes.html#str" title="str"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> として渡される)実行中のSQL文です。 コールバックの戻り値は無視されます。 バックエンドは、 <a class="reference internal" href="sqlite3.html#sqlite3.Cursor.execute" title="sqlite3.Cursor.execute"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Cursor.execute()</span></code></a> メソッドに渡されたSQL文を実行するだけではないことに注意してください。 <code class="xref py py-mod docutils literal notranslate"><span class="pre">sqlite3</span></code> モジュールの <a class="reference internal" href="sqlite3.html#sqlite3-controlling-transactions"><span class="std std-ref">トランザクション管理</span></a> や、現在のデータベース内で定義されたトリガーの実行その他も行います。</p>
<p><em>trace_callback</em> として <code class="docutils literal notranslate"><span class="pre">None</span></code> を渡すと、トレース・コールバックが無効になります。</p>
<div class="admonition note">
<p class="admonition-title">注釈</p>
<p>トレース・コールバックで送出した例外は伝播されません。 開発およびデバッグの補助として、 <a class="reference internal" href="sqlite3.html#sqlite3.enable_callback_tracebacks" title="sqlite3.enable_callback_tracebacks"><code class="xref py py-meth docutils literal notranslate"><span class="pre">enable_callback_tracebacks()</span></code></a> を使用して、トレース・コールバックで送出した例外からのトレースバックの出力を有効にします。</p>
</div>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 3.3.</span></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlite3.Connection.enable_load_extension">
<span class="sig-name descname"><span class="pre">enable_load_extension</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">enabled</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="sqlite3.html#sqlite3.Connection.enable_load_extension" title="Link to this definition">¶</a></dt>
<dd><p><em>enabled</em> が <code class="docutils literal notranslate"><span class="pre">True</span></code> の場合、 SQLite エンジンが共有ライブラリから SQLite 拡張機能をロードできるようにします。 <code class="docutils literal notranslate"><span class="pre">True</span></code> 以外の場合は、 SQLite 拡張機能の読み込みを許可しません。 SQLite 拡張機能では、新しい関数の定義、または集計の定義、またはまったく新しい仮想テーブルの実装を定義できます。 よく知られている拡張機能の 1 つは、SQLite と共に配布される全文検索拡張機能です。</p>
<div class="admonition note">
<p class="admonition-title">注釈</p>
<p><code class="xref py py-mod docutils literal notranslate"><span class="pre">sqlite3</span></code> モジュールは、デフォルトではロード可能な拡張機能をサポートするようにビルドされていません。一部のプラットフォーム(特に macOS)には、この機能なしでコンパイルされた SQLite ライブラリがあるためです。 ロード可能な拡張機能のサポートを得るには、 <strong class="program">configure</strong> に <a class="reference internal" href="../using/configure.html#cmdoption-enable-loadable-sqlite-extensions"><code class="xref std std-option docutils literal notranslate"><span class="pre">--enable-loadable-sqlite-extensions</span></code></a> オプションを渡す必要があります。</p>
</div>
<p class="audit-hook">引数 <code class="docutils literal notranslate"><span class="pre">connection</span></code>, <code class="docutils literal notranslate"><span class="pre">enabled</span></code> を指定して <a class="reference internal" href="sys.html#auditing"><span class="std std-ref">監査イベント</span></a> <code class="docutils literal notranslate"><span class="pre">sqlite3.enable_load_extension</span></code> を送出します。</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 3.2.</span></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">バージョン 3.10 で変更: </span><code class="docutils literal notranslate"><span class="pre">sqlite3.enable_load_extension</span></code> 監査イベントを追加しました。</p>
</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">con</span><span class="o">.</span><span class="n">enable_load_extension</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Load the fulltext search extension</span>
<span class="n">con</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;select load_extension(&#39;./fts3.so&#39;)&quot;</span><span class="p">)</span>

<span class="c1"># alternatively you can load the extension using an API call:</span>
<span class="c1"># con.load_extension(&quot;./fts3.so&quot;)</span>

<span class="c1"># disable extension loading again</span>
<span class="n">con</span><span class="o">.</span><span class="n">enable_load_extension</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># example from SQLite wiki</span>
<span class="n">con</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;CREATE VIRTUAL TABLE recipe USING fts3(name, ingredients)&quot;</span><span class="p">)</span>
<span class="n">con</span><span class="o">.</span><span class="n">executescript</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    INSERT INTO recipe (name, ingredients) VALUES(&#39;broccoli stew&#39;, &#39;broccoli peppers cheese tomatoes&#39;);</span>
<span class="s2">    INSERT INTO recipe (name, ingredients) VALUES(&#39;pumpkin stew&#39;, &#39;pumpkin onions garlic celery&#39;);</span>
<span class="s2">    INSERT INTO recipe (name, ingredients) VALUES(&#39;broccoli pie&#39;, &#39;broccoli cheese onions flour&#39;);</span>
<span class="s2">    INSERT INTO recipe (name, ingredients) VALUES(&#39;pumpkin pie&#39;, &#39;pumpkin sugar flour butter&#39;);</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">con</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT rowid, name, ingredients FROM recipe WHERE name MATCH &#39;pie&#39;&quot;</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlite3.Connection.load_extension">
<span class="sig-name descname"><span class="pre">load_extension</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entrypoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="sqlite3.html#sqlite3.Connection.load_extension" title="Link to this definition">¶</a></dt>
<dd><p>共有ライブラリから SQLite 拡張機能(extension)をロードします。このメソッドを呼び出す前に <a class="reference internal" href="sqlite3.html#sqlite3.Connection.enable_load_extension" title="sqlite3.Connection.enable_load_extension"><code class="xref py py-meth docutils literal notranslate"><span class="pre">enable_load_extension()</span></code></a> で拡張機能の読み込みを有効にしてください。</p>
<dl class="field-list simple">
<dt class="field-odd">パラメータ<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<a class="reference internal" href="stdtypes.html#str" title="str"><em>str</em></a>) -- SQLite 拡張機能(extension)へのパス(path)。</p></li>
<li><p><strong>entrypoint</strong> (<a class="reference internal" href="stdtypes.html#str" title="str"><em>str</em></a><em> | </em><em>None</em>) -- エントリ・ポイント名。 <code class="docutils literal notranslate"><span class="pre">None</span></code> (デフォルト) の場合、 SQLite は自分自身でエントリ・ポイント名を推測します。 詳細については、SQLite ドキュメント <a class="reference external" href="https://www.sqlite.org/loadext.html#loading_an_extension">Loading an Extension</a> を参照してください。</p></li>
</ul>
</dd>
</dl>
<p class="audit-hook">引数 <code class="docutils literal notranslate"><span class="pre">connection</span></code>, <code class="docutils literal notranslate"><span class="pre">path</span></code> を指定して <a class="reference internal" href="sys.html#auditing"><span class="std std-ref">監査イベント</span></a> <code class="docutils literal notranslate"><span class="pre">sqlite3.load_extension</span></code> を送出します。</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 3.2.</span></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">バージョン 3.10 で変更: </span><code class="docutils literal notranslate"><span class="pre">sqlite3.load_extension</span></code> 監査イベントを追加しました。</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">バージョン 3.12 で変更: </span>Added the <em>entrypoint</em> parameter.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlite3.Connection.iterdump">
<span class="sig-name descname"><span class="pre">iterdump</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="sqlite3.html#sqlite3.Connection.iterdump" title="Link to this definition">¶</a></dt>
<dd><p>データベースを SQL ソース・コードとしてダンプする <a class="reference internal" href="../glossary.html#term-iterator"><span class="xref std std-term">iterator</span></a> を返します。 後で復元するためにメモリ内データベースを保存する場合に便利です。 <strong class="program">sqlite3</strong> シェルの <code class="docutils literal notranslate"><span class="pre">.dump</span></code> コマンドに似ています。</p>
<p>例:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert file example.db to SQL dump file dump.sql</span>
<span class="n">con</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;example.db&#39;</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;dump.sql&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">con</span><span class="o">.</span><span class="n">iterdump</span><span class="p">():</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">line</span><span class="p">)</span>
<span class="n">con</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">参考</p>
<p><a class="reference internal" href="sqlite3.html#sqlite3-howto-encoding"><span class="std std-ref">How to handle non-UTF-8 text encodings</span></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlite3.Connection.backup">
<span class="sig-name descname"><span class="pre">backup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pages</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'main'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sleep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.250</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="sqlite3.html#sqlite3.Connection.backup" title="Link to this definition">¶</a></dt>
<dd><p>SQLite データベースのバックアップを作成します。</p>
<p>データベースが他のクライアントによってアクセスされている場合、または同一の接続によって並行にアクセスされている場合でも機能します。</p>
<dl class="field-list simple">
<dt class="field-odd">パラメータ<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target</strong> (<a class="reference internal" href="sqlite3.html#sqlite3.Connection" title="sqlite3.Connection"><em>Connection</em></a>) -- バックアップ先のデータベース接続(connection)。</p></li>
<li><p><strong>pages</strong> (<a class="reference internal" href="functions.html#int" title="int"><em>int</em></a>) -- 一度にコピーするページ数。 <code class="docutils literal notranslate"><span class="pre">0</span></code> 以下の場合、データベース全体がワンステップでコピーされます。 デフォルトは <code class="docutils literal notranslate"><span class="pre">-1</span></code> です。</p></li>
<li><p><strong>progress</strong> (<a class="reference internal" href="../glossary.html#term-callback"><span class="xref std std-term">callback</span></a> | None) -- <span class="xref std std-term">呼び出し可能オブジェクト &lt;callable&gt;`を設定すると、バックアップの指定ページ数単位の反復ごとに 3 つの整数引数で呼び出されます。 *status* は、最後の反復時のステータスで、 *remaining* はまだコピーされていない残りのページ数で、 *total* はコピーされるページの合計です。 デフォルトは ``None`</span> です。</p></li>
<li><p><strong>name</strong> (<a class="reference internal" href="stdtypes.html#str" title="str"><em>str</em></a>) -- バックアップするデータベース名。 <code class="docutils literal notranslate"><span class="pre">&quot;main&quot;</span></code> (メイン・データベース。これがデフォルトです)、または <code class="docutils literal notranslate"><span class="pre">&quot;temp&quot;</span></code> (一時データベース)、 または <code class="docutils literal notranslate"><span class="pre">ATTACH</span> <span class="pre">DATABASE</span></code> SQL文を使用して取り付けられたカスタム・データベース名の、いずれかです。</p></li>
<li><p><strong>sleep</strong> (<a class="reference internal" href="functions.html#float" title="float"><em>float</em></a>) -- バックアップの指定ページ数単位の反復ごとにスリープする秒数。</p></li>
</ul>
</dd>
</dl>
<p>例 1. 既存のデータベースを別のデータベースにコピーします:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">progress</span><span class="p">(</span><span class="n">status</span><span class="p">,</span> <span class="n">remaining</span><span class="p">,</span> <span class="n">total</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Copied </span><span class="si">{</span><span class="n">total</span><span class="o">-</span><span class="n">remaining</span><span class="si">}</span><span class="s1"> of </span><span class="si">{</span><span class="n">total</span><span class="si">}</span><span class="s1"> pages...&#39;</span><span class="p">)</span>

<span class="n">src</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;example.db&#39;</span><span class="p">)</span>
<span class="n">dst</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;backup.db&#39;</span><span class="p">)</span>
<span class="k">with</span> <span class="n">dst</span><span class="p">:</span>
    <span class="n">src</span><span class="o">.</span><span class="n">backup</span><span class="p">(</span><span class="n">dst</span><span class="p">,</span> <span class="n">pages</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">progress</span><span class="o">=</span><span class="n">progress</span><span class="p">)</span>
<span class="n">dst</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">src</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>例 2. 既存のデータベースを臨時コピー(transient copy)にコピーします。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">src</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;example.db&#39;</span><span class="p">)</span>
<span class="n">dst</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;:memory:&#39;</span><span class="p">)</span>
<span class="n">src</span><span class="o">.</span><span class="n">backup</span><span class="p">(</span><span class="n">dst</span><span class="p">)</span>
<span class="n">dst</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">src</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 3.7.</span></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">参考</p>
<p><a class="reference internal" href="sqlite3.html#sqlite3-howto-encoding"><span class="std std-ref">How to handle non-UTF-8 text encodings</span></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlite3.Connection.getlimit">
<span class="sig-name descname"><span class="pre">getlimit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">category</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="sqlite3.html#sqlite3.Connection.getlimit" title="Link to this definition">¶</a></dt>
<dd><p>接続(connection)の実行時制限を取得します。</p>
<dl class="field-list simple">
<dt class="field-odd">パラメータ<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>category</strong> (<a class="reference internal" href="functions.html#int" title="int"><em>int</em></a>) -- 問い合わせを行う実行時制限カテゴリー(<a class="reference external" href="https://www.sqlite.org/c3ref/c_limit_attached.html">SQLite limit category</a>)。</p>
</dd>
<dt class="field-even">戻り値の型<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="functions.html#int" title="int">int</a></p>
</dd>
<dt class="field-odd">例外<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="sqlite3.html#sqlite3.ProgrammingError" title="sqlite3.ProgrammingError"><strong>ProgrammingError</strong></a> -- <em>category</em> に、 背後の SQLite ライブラリが認識できないカテゴリーを指定した場合に送出されます。</p>
</dd>
</dl>
<p>例: <a class="reference internal" href="sqlite3.html#sqlite3.Connection" title="sqlite3.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> の <code class="docutils literal notranslate"><span class="pre">con</span></code> の SQL 文の最大長を照会します (デフォルトは 1000000000 です):</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">con</span><span class="o">.</span><span class="n">getlimit</span><span class="p">(</span><span class="n">sqlite3</span><span class="o">.</span><span class="n">SQLITE_LIMIT_SQL_LENGTH</span><span class="p">)</span>
<span class="go">1000000000</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 3.11.</span></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlite3.Connection.setlimit">
<span class="sig-name descname"><span class="pre">setlimit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">category</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limit</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="sqlite3.html#sqlite3.Connection.setlimit" title="Link to this definition">¶</a></dt>
<dd><p>接続の実行時制限を設定します。 コンパイル時上限を超えて制限を増やそうとすると、 暗黙のうちにコンパイル時上限に切り捨てられます。 制限が変更されたかどうかに関係なく、 制限の以前の値が返されます。</p>
<dl class="field-list simple">
<dt class="field-odd">パラメータ<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>category</strong> (<a class="reference internal" href="functions.html#int" title="int"><em>int</em></a>) -- <a class="reference external" href="https://www.sqlite.org/c3ref/c_limit_attached.html">SQLite limit category</a> を設定する。</p></li>
<li><p><strong>limit</strong> (<a class="reference internal" href="functions.html#int" title="int"><em>int</em></a>) -- 新しい制限の値。 負数の場合、 現在の制限は変更されません。</p></li>
</ul>
</dd>
<dt class="field-even">戻り値の型<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="functions.html#int" title="int">int</a></p>
</dd>
<dt class="field-odd">例外<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="sqlite3.html#sqlite3.ProgrammingError" title="sqlite3.ProgrammingError"><strong>ProgrammingError</strong></a> -- <em>category</em> に、 背後の SQLite ライブラリが認識できないカテゴリーを指定した場合に送出されます。</p>
</dd>
</dl>
<p>class:<cite>Connection</cite> の <code class="docutils literal notranslate"><span class="pre">con</span></code> に対して、取り付けられるデータベース(attached databases)の数を 1 に制限します (デフォルトの制限は 10 です):</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">con</span><span class="o">.</span><span class="n">setlimit</span><span class="p">(</span><span class="n">sqlite3</span><span class="o">.</span><span class="n">SQLITE_LIMIT_ATTACHED</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span><span class="o">.</span><span class="n">getlimit</span><span class="p">(</span><span class="n">sqlite3</span><span class="o">.</span><span class="n">SQLITE_LIMIT_ATTACHED</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 3.11.</span></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlite3.Connection.getconfig">
<span class="sig-name descname"><span class="pre">getconfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">op</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="sqlite3.html#sqlite3.Connection.getconfig" title="Link to this definition">¶</a></dt>
<dd><p>ブール値の接続構成オプションを問い合わせます。</p>
<dl class="field-list simple">
<dt class="field-odd">パラメータ<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>op</strong> (<a class="reference internal" href="functions.html#int" title="int"><em>int</em></a>) -- <a class="reference internal" href="sqlite3.html#sqlite3-dbconfig-constants"><span class="std std-ref">SQLITE_DBCONFIG code</span></a> を指定します。</p>
</dd>
<dt class="field-even">戻り値の型<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="functions.html#bool" title="bool">bool</a></p>
</dd>
</dl>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 3.12.</span></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlite3.Connection.setconfig">
<span class="sig-name descname"><span class="pre">setconfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">op</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="sqlite3.html#sqlite3.Connection.setconfig" title="Link to this definition">¶</a></dt>
<dd><p>ブール値の接続構成オプションを設定します。</p>
<dl class="field-list simple">
<dt class="field-odd">パラメータ<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>op</strong> (<a class="reference internal" href="functions.html#int" title="int"><em>int</em></a>) -- <a class="reference internal" href="sqlite3.html#sqlite3-dbconfig-constants"><span class="std std-ref">SQLITE_DBCONFIG code</span></a> を指定します。</p></li>
<li><p><strong>enable</strong> (<a class="reference internal" href="functions.html#bool" title="bool"><em>bool</em></a>) -- 設定オプションを有効にする必要がある場合は <code class="docutils literal notranslate"><span class="pre">True</span></code> (デフォルト)。 無効にする場合は <code class="docutils literal notranslate"><span class="pre">False</span></code> を指定します。</p></li>
</ul>
</dd>
</dl>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 3.12.</span></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlite3.Connection.serialize">
<span class="sig-name descname"><span class="pre">serialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'main'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="sqlite3.html#sqlite3.Connection.serialize" title="Link to this definition">¶</a></dt>
<dd><p>データベースを <a class="reference internal" href="stdtypes.html#bytes" title="bytes"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></a> オブジェクトに直列化(serialize)します。 通常のディスク上のデータベース・ファイルの場合、 直列化はディスク・ファイルの単なるコピーです。 インメモリ・データベースまたは &quot;temp&quot; データベースの場合、 直列化は、 そのデータベースがディスクにバックアップされた場合にディスクに書き込まれるバイト・シーケンスと同じです。</p>
<dl class="field-list simple">
<dt class="field-odd">パラメータ<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<a class="reference internal" href="stdtypes.html#str" title="str"><em>str</em></a>) -- 直列化するデータベース名。 デフォルトは <code class="docutils literal notranslate"><span class="pre">&quot;main&quot;</span></code> です。</p>
</dd>
<dt class="field-even">戻り値の型<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="stdtypes.html#bytes" title="bytes">bytes</a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">注釈</p>
<p>このメソッドは、 背後の SQLite ライブラリに直列化 API がある場合にのみ使用できます。</p>
</div>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 3.11.</span></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlite3.Connection.deserialize">
<span class="sig-name descname"><span class="pre">deserialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'main'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="sqlite3.html#sqlite3.Connection.deserialize" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="sqlite3.html#sqlite3.Connection.serialize" title="sqlite3.Connection.serialize"><code class="xref py py-meth docutils literal notranslate"><span class="pre">直列化</span></code></a> されたデータベースを <a class="reference internal" href="sqlite3.html#sqlite3.Connection" title="sqlite3.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> に、 脱直列化(deserialize)します。 このメソッドにより、 データベース接続はデータベース <em>name</em> から切断され、そして、  <em>data</em> に含まれる直列化データに基づいて、 データベース <em>name</em> がインメモリ・データベースとして再度開かれます。</p>
<dl class="field-list simple">
<dt class="field-odd">パラメータ<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<a class="reference internal" href="stdtypes.html#bytes" title="bytes"><em>bytes</em></a>) -- 直列化されたデータベース。</p></li>
<li><p><strong>name</strong> (<a class="reference internal" href="stdtypes.html#str" title="str"><em>str</em></a>) -- 脱直列化(deserialize)したデータを入れるデータベース名。 デフォルトは <code class="docutils literal notranslate"><span class="pre">&quot;main&quot;</span></code> です。</p></li>
</ul>
</dd>
<dt class="field-even">例外<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference internal" href="sqlite3.html#sqlite3.OperationalError" title="sqlite3.OperationalError"><strong>OperationalError</strong></a> -- データベース接続が読み取りトランザクションやバックアップ操作中の場合。</p></li>
<li><p><a class="reference internal" href="sqlite3.html#sqlite3.DatabaseError" title="sqlite3.DatabaseError"><strong>DatabaseError</strong></a> -- <em>data</em> に有効な SQLite データベースが含まれていない場合。</p></li>
<li><p><a class="reference internal" href="exceptions.html#OverflowError" title="OverflowError"><strong>OverflowError</strong></a> -- <a class="reference internal" href="functions.html#len" title="len"><code class="xref py py-func docutils literal notranslate"><span class="pre">len(data)</span></code></a> が <code class="docutils literal notranslate"><span class="pre">2**63</span> <span class="pre">-</span> <span class="pre">1</span></code> より大きい場合。</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">注釈</p>
<p>このメソッドは、 背後の SQLite ライブラリに脱直列化 API がある場合にのみ使用できます。</p>
</div>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 3.11.</span></p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sqlite3.Connection.autocommit">
<span class="sig-name descname"><span class="pre">autocommit</span></span><a class="headerlink" href="sqlite3.html#sqlite3.Connection.autocommit" title="Link to this definition">¶</a></dt>
<dd><p>この属性は、 <span class="target" id="index-21"></span><a class="pep reference external" href="https://peps.python.org/pep-0249/"><strong>PEP 249</strong></a> 対応のトランザクションの振る舞いを制御します。 <code class="xref py py-attr docutils literal notranslate"><span class="pre">auto​​commit</span></code> には以下の 3 つの値が指定できます:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">False</span></code>: <span class="target" id="index-22"></span><a class="pep reference external" href="https://peps.python.org/pep-0249/"><strong>PEP 249</strong></a> 対応のトランザクションの振る舞いを選びます。 これは、 <code class="xref py py-mod docutils literal notranslate"><span class="pre">sqlite3</span></code> が、 トランザクションが常に開いていることを保証することを意味します。トランザクションを閉じるには、 <a class="reference internal" href="sqlite3.html#sqlite3.Connection.commit" title="sqlite3.Connection.commit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">commit()</span></code></a> や <a class="reference internal" href="sqlite3.html#sqlite3.Connection.rollback" title="sqlite3.Connection.rollback"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rollback()</span></code></a> を使用します。</p>
<p>これが <code class="xref py py-attr docutils literal notranslate"><span class="pre">auto​​commit</span></code> の推奨値です。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">True</span></code>: SQLite の <a class="reference external" href="https://www.sqlite.org/lang_transaction.html#implicit_versus_explicit_transactions">autocommit mode</a> を使用します。このモードでは <a class="reference internal" href="sqlite3.html#sqlite3.Connection.commit" title="sqlite3.Connection.commit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">commit()</span></code></a> や <a class="reference internal" href="sqlite3.html#sqlite3.Connection.rollback" title="sqlite3.Connection.rollback"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rollback()</span></code></a> は効果がありません。</p></li>
<li><p><a class="reference internal" href="sqlite3.html#sqlite3.LEGACY_TRANSACTION_CONTROL" title="sqlite3.LEGACY_TRANSACTION_CONTROL"><code class="xref py py-data docutils literal notranslate"><span class="pre">LEGACY_TRANSACTION_CONTROL</span></code></a>: Python 3.12 より前(<span class="target" id="index-23"></span><a class="pep reference external" href="https://peps.python.org/pep-0249/"><strong>PEP 249</strong></a> 非対応)のトランザクション制御。 詳細については <a class="reference internal" href="sqlite3.html#sqlite3.Connection.isolation_level" title="sqlite3.Connection.isolation_level"><code class="xref py py-attr docutils literal notranslate"><span class="pre">isolation_level</span></code></a> を参照してください。</p>
<p>これが、今のところは、 <code class="xref py py-attr docutils literal notranslate"><span class="pre">auto​​commit</span></code> のデフォルト値です。</p>
</li>
</ul>
<p><code class="xref py py-attr docutils literal notranslate"><span class="pre">auto​​commit</span></code> を <code class="docutils literal notranslate"><span class="pre">False</span></code> に変更すると新しいトランザクションが開き、 <code class="docutils literal notranslate"><span class="pre">True</span></code> に変更すると保留中のトランザクションがコミットされます。</p>
<p>詳細は <a class="reference internal" href="sqlite3.html#sqlite3-transaction-control-autocommit"><span class="std std-ref">autocommit 属性に依るトランザクション制御</span></a> を参照してください。</p>
<div class="admonition note">
<p class="admonition-title">注釈</p>
<p><a class="reference internal" href="sqlite3.html#sqlite3.Connection.isolation_level" title="sqlite3.Connection.isolation_level"><code class="xref py py-attr docutils literal notranslate"><span class="pre">isolation_level</span></code></a> 属性は、 <a class="reference internal" href="sqlite3.html#sqlite3.Connection.autocommit" title="sqlite3.Connection.autocommit"><code class="xref py py-attr docutils literal notranslate"><span class="pre">autocommit</span></code></a> の値が <a class="reference internal" href="sqlite3.html#sqlite3.LEGACY_TRANSACTION_CONTROL" title="sqlite3.LEGACY_TRANSACTION_CONTROL"><code class="xref py py-data docutils literal notranslate"><span class="pre">LEGACY_TRANSACTION_CONTROL</span></code></a> でない限り、効果がありません。</p>
</div>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 3.12.</span></p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sqlite3.Connection.in_transaction">
<span class="sig-name descname"><span class="pre">in_transaction</span></span><a class="headerlink" href="sqlite3.html#sqlite3.Connection.in_transaction" title="Link to this definition">¶</a></dt>
<dd><p>この読み取り専用属性は、低レベルの SQLite <a class="reference external" href="https://www.sqlite.org/lang_transaction.html#implicit_versus_explicit_transactions">autocommit mode</a> に対応します。</p>
<p>トランザクションがアクティブな場合 (コミットされていない変更がある場合) は <code class="docutils literal notranslate"><span class="pre">True</span></code> 、それ以外の場合は <code class="docutils literal notranslate"><span class="pre">False</span></code> です。</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 3.2.</span></p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sqlite3.Connection.isolation_level">
<span class="sig-name descname"><span class="pre">isolation_level</span></span><a class="headerlink" href="sqlite3.html#sqlite3.Connection.isolation_level" title="Link to this definition">¶</a></dt>
<dd><p><code class="xref py py-mod docutils literal notranslate"><span class="pre">sqlite3</span></code> の <a class="reference internal" href="sqlite3.html#sqlite3-transaction-control-isolation-level"><span class="std std-ref">旧来のトランザクション処理モード</span></a> を制御します。 <code class="docutils literal notranslate"><span class="pre">None</span></code> に設定すると、トランザクションは暗黙に開かれることはありません。背後の SQLite の <a class="reference external" href="https://www.sqlite.org/lang_transaction.html#deferred_immediate_and_exclusive_transactions">SQLite transaction behaviour</a> に対応する <code class="docutils literal notranslate"><span class="pre">&quot;DEFERRED&quot;</span></code> または <code class="docutils literal notranslate"><span class="pre">&quot;IMMEDIATE&quot;</span></code> または <code class="docutils literal notranslate"><span class="pre">&quot;EXCLUSIVE&quot;</span></code> のいずれかに設定すると、 <span class="xref std std-ref">暗黙のトランザクション管理</span> が実行されます。</p>
<p><a class="reference internal" href="sqlite3.html#sqlite3.connect" title="sqlite3.connect"><code class="xref py py-func docutils literal notranslate"><span class="pre">connect()</span></code></a> の <em>isolation_level</em> パラメーターでオーバーライドされない場合、 デフォルトは <code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code> で、 これは <code class="docutils literal notranslate"><span class="pre">&quot;DEFERRED&quot;</span></code> の別名です。</p>
<div class="admonition note">
<p class="admonition-title">注釈</p>
<p>トランザクション処理を制御するには、 <code class="xref py py-attr docutils literal notranslate"><span class="pre">isolation_level</span></code> を使用するよりも <a class="reference internal" href="sqlite3.html#sqlite3.Connection.autocommit" title="sqlite3.Connection.autocommit"><code class="xref py py-attr docutils literal notranslate"><span class="pre">autocommit</span></code></a> を使用することをお勧めします。 <a class="reference internal" href="sqlite3.html#sqlite3.Connection.autocommit" title="sqlite3.Connection.autocommit"><code class="xref py py-attr docutils literal notranslate"><span class="pre">autocommit</span></code></a> が <a class="reference internal" href="sqlite3.html#sqlite3.LEGACY_TRANSACTION_CONTROL" title="sqlite3.LEGACY_TRANSACTION_CONTROL"><code class="xref py py-data docutils literal notranslate"><span class="pre">LEGACY_TRANSACTION_CONTROL</span></code></a> (これがデフォルトです)に設定されていない限り、 <code class="xref py py-attr docutils literal notranslate"><span class="pre">isolation_level</span></code> は効果がありません。</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sqlite3.Connection.row_factory">
<span class="sig-name descname"><span class="pre">row_factory</span></span><a class="headerlink" href="sqlite3.html#sqlite3.Connection.row_factory" title="Link to this definition">¶</a></dt>
<dd><p>この接続から作成された <a class="reference internal" href="sqlite3.html#sqlite3.Cursor" title="sqlite3.Cursor"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cursor</span></code></a> オブジェクトの初期 <a class="reference internal" href="sqlite3.html#sqlite3.Cursor.row_factory" title="sqlite3.Cursor.row_factory"><code class="xref py py-attr docutils literal notranslate"><span class="pre">row_factory</span></code></a> 。この属性に割り当てを行っても、 この接続に属する、すでに存在するカーソルの <code class="xref py py-attr docutils literal notranslate"><span class="pre">row_factory</span></code> には影響せず、 この属性に割り当てを行った後に作成する新しいカーソルのみに影響します。 デフォルトでは <code class="docutils literal notranslate"><span class="pre">None</span></code> です。つまり、各行は <a class="reference internal" href="stdtypes.html#tuple" title="tuple"><code class="xref py py-class docutils literal notranslate"><span class="pre">タプル</span></code></a> として返されます。</p>
<p>詳細は <a class="reference internal" href="sqlite3.html#sqlite3-howto-row-factory"><span class="std std-ref">行工場(row factories)の作成方法と使用方法</span></a> をご覧下さい。</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sqlite3.Connection.text_factory">
<span class="sig-name descname"><span class="pre">text_factory</span></span><a class="headerlink" href="sqlite3.html#sqlite3.Connection.text_factory" title="Link to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="../glossary.html#term-callable"><span class="xref std std-term">callable</span></a> that accepts a <a class="reference internal" href="stdtypes.html#bytes" title="bytes"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></a> parameter
and returns a text representation of it.
The callable is invoked for SQLite values with the <code class="docutils literal notranslate"><span class="pre">TEXT</span></code> data type.
By default, this attribute is set to <a class="reference internal" href="stdtypes.html#str" title="str"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>.</p>
<p>See <a class="reference internal" href="sqlite3.html#sqlite3-howto-encoding"><span class="std std-ref">How to handle non-UTF-8 text encodings</span></a> for more details.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sqlite3.Connection.total_changes">
<span class="sig-name descname"><span class="pre">total_changes</span></span><a class="headerlink" href="sqlite3.html#sqlite3.Connection.total_changes" title="Link to this definition">¶</a></dt>
<dd><p>データベース接続が開かれてから、変更または挿入または削除されたデータベース行の総数を返します。</p>
</dd></dl>

</dd></dl>

</section>
<section id="cursor-objects">
<span id="sqlite3-cursor-objects"></span><h3>Cursor オブジェクト<a class="headerlink" href="sqlite3.html#cursor-objects" title="Link to this heading">¶</a></h3>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">Cursor</span></code> オブジェクトは、 SQL 文を実行し、 取得操作(fetch operation)のコンテキストを管理するために使用されるデータベース・カーソル(<a class="reference external" href="https://en.wikipedia.org/wiki/Cursor_(databases)">database cursor</a>)を表します。カーソルは、 <a class="reference internal" href="sqlite3.html#sqlite3.Connection.cursor" title="sqlite3.Connection.cursor"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Connection.cursor()</span></code></a> または <a class="reference internal" href="sqlite3.html#sqlite3-connection-shortcuts"><span class="std std-ref">接続(connection)ショートカット・メソッド</span></a> の、いずれかを使用して作成されます。</p>
<p>カーソル・オブジェクトは <a class="reference internal" href="../glossary.html#term-iterator"><span class="xref std std-term">イテレータ</span></a> です。つまり、 <code class="docutils literal notranslate"><span class="pre">SELECT</span></code> クエリに対して <a class="reference internal" href="sqlite3.html#sqlite3.Cursor.execute" title="sqlite3.Cursor.execute"><code class="xref py py-meth docutils literal notranslate"><span class="pre">execute()</span></code></a> した場合、結果の行(rows)を取得するためには、カーソルを単純に反復(iterate)できます:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT t FROM data&quot;</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<dl class="py class">
<dt class="sig sig-object py" id="sqlite3.Cursor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlite3.</span></span><span class="sig-name descname"><span class="pre">Cursor</span></span><a class="headerlink" href="sqlite3.html#sqlite3.Cursor" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="sqlite3.html#sqlite3.Cursor" title="sqlite3.Cursor"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cursor</span></code></a> インスタンスは以下の属性やメソッドを持ちます。</p>
<dl class="py method" id="index-7">
<span id="index-6"></span><dt class="sig sig-object py" id="sqlite3.Cursor.execute">
<span class="sig-name descname"><span class="pre">execute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sql</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="sqlite3.html#sqlite3.Cursor.execute" title="Link to this definition">¶</a></dt>
<dd><p>Execute a single SQL statement,
optionally binding Python values using
<a class="reference internal" href="sqlite3.html#sqlite3-placeholders"><span class="std std-ref">placeholders</span></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">パラメータ<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sql</strong> (<a class="reference internal" href="stdtypes.html#str" title="str"><em>str</em></a>) -- 単一の SQL 文。</p></li>
<li><p><strong>parameters</strong> (<a class="reference internal" href="stdtypes.html#dict" title="dict"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> | <a class="reference internal" href="../glossary.html#term-sequence"><span class="xref std std-term">sequence</span></a>) -- <em>sql</em> のプレースホルダに結び付け(bind)する Python 値。 名前付きプレースホルダが使用されている場合は <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code> です。 名前のないプレースホルダが使用されている場合は <span class="xref std std-term">sequence</span> です。 <a class="reference internal" href="sqlite3.html#sqlite3-placeholders"><span class="std std-ref">プレースホルダを使用して SQL クエリに値を結び付ける方法</span></a> を参照してください。</p></li>
</ul>
</dd>
<dt class="field-even">例外<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="sqlite3.html#sqlite3.ProgrammingError" title="sqlite3.ProgrammingError"><strong>ProgrammingError</strong></a> -- <em>sql</em> に複数の SQL 文が含まれている場合。</p>
</dd>
</dl>
<p><a class="reference internal" href="sqlite3.html#sqlite3.Connection.autocommit" title="sqlite3.Connection.autocommit"><code class="xref py py-attr docutils literal notranslate"><span class="pre">autocommit</span></code></a> が <a class="reference internal" href="sqlite3.html#sqlite3.LEGACY_TRANSACTION_CONTROL" title="sqlite3.LEGACY_TRANSACTION_CONTROL"><code class="xref py py-data docutils literal notranslate"><span class="pre">LEGACY_TRANSACTION_CONTROL</span></code></a> で、かつ、 <a class="reference internal" href="sqlite3.html#sqlite3.Connection.isolation_level" title="sqlite3.Connection.isolation_level"><code class="xref py py-attr docutils literal notranslate"><span class="pre">isolation_level</span></code></a> が <code class="docutils literal notranslate"><span class="pre">None</span></code> で無く、 かつ、 <em>sql</em> が <code class="docutils literal notranslate"><span class="pre">INSERT</span></code> または <code class="docutils literal notranslate"><span class="pre">UPDATE</span></code> または <code class="docutils literal notranslate"><span class="pre">DELETE</span></code> または <code class="docutils literal notranslate"><span class="pre">REPLACE</span></code> 文で、かつ、開いているトランザクションがない場合、 <em>sql</em> を実行する前にトランザクションが暗黙に開かれます。</p>
<div class="deprecated-removed">
<p><span class="versionmodified">バージョン 3.12 で非推奨、バージョン 3.14 で削除予定: </span><a class="reference internal" href="sqlite3.html#sqlite3-placeholders"><span class="std std-ref">名前付きプレースホルダー</span></a> が使用され、かつ、パラメーターが <a class="reference internal" href="stdtypes.html#dict" title="dict"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> ではなくシーケンスである場合、 <a class="reference internal" href="exceptions.html#DeprecationWarning" title="DeprecationWarning"><code class="xref py py-exc docutils literal notranslate"><span class="pre">DeprecationWarning</span></code></a> を送出します。 Python 3.14 以降では、代わりに <a class="reference internal" href="sqlite3.html#sqlite3.ProgrammingError" title="sqlite3.ProgrammingError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ProgrammingError</span></code></a> を送出します。</p>
</div>
<p>複数の SQL 文を実行するには <a class="reference internal" href="sqlite3.html#sqlite3.Cursor.executescript" title="sqlite3.Cursor.executescript"><code class="xref py py-meth docutils literal notranslate"><span class="pre">executescript()</span></code></a> を使用します。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlite3.Cursor.executemany">
<span class="sig-name descname"><span class="pre">executemany</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sql</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="sqlite3.html#sqlite3.Cursor.executemany" title="Link to this definition">¶</a></dt>
<dd><p><em>parameters</em> のすべての item に対して、 <a class="reference internal" href="sqlite3.html#sqlite3-placeholders"><span class="std std-ref">パラメーター化</span></a> された <abbr title="Data Manipulation Language">DML</abbr> SQL 文である <em>sql</em> を繰り返し実行します。</p>
<p><a class="reference internal" href="sqlite3.html#sqlite3.Cursor.execute" title="sqlite3.Cursor.execute"><code class="xref py py-meth docutils literal notranslate"><span class="pre">execute()</span></code></a> と同一の暗黙のトランザクション処理を使用します。</p>
<dl class="field-list simple">
<dt class="field-odd">パラメータ<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sql</strong> (<a class="reference internal" href="stdtypes.html#str" title="str"><em>str</em></a>) -- 単一の DML 文。</p></li>
<li><p><strong>parameters</strong> (<a class="reference internal" href="../glossary.html#term-iterable"><span class="xref std std-term">iterable</span></a>) -- <em>sql</em> のプレースホルダに結び付け(bind)するためのパラメータの <span class="xref std std-term">iterable</span> 。 <a class="reference internal" href="sqlite3.html#sqlite3-placeholders"><span class="std std-ref">プレースホルダを使用して SQL クエリに値を結び付ける方法</span></a> 参照。</p></li>
</ul>
</dd>
<dt class="field-even">例外<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="sqlite3.html#sqlite3.ProgrammingError" title="sqlite3.ProgrammingError"><strong>ProgrammingError</strong></a> -- If <em>sql</em> contains more than one SQL statement,
or is not a DML statement.</p>
</dd>
</dl>
<p>例:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">rows</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s2">&quot;row1&quot;</span><span class="p">,),</span>
    <span class="p">(</span><span class="s2">&quot;row2&quot;</span><span class="p">,),</span>
<span class="p">]</span>
<span class="c1"># cur is an sqlite3.Cursor object</span>
<span class="n">cur</span><span class="o">.</span><span class="n">executemany</span><span class="p">(</span><span class="s2">&quot;INSERT INTO data VALUES(?)&quot;</span><span class="p">,</span> <span class="n">rows</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">注釈</p>
<p>RETURNING 句(<a class="reference external" href="https://www.sqlite.org/lang_returning.html">RETURNING clauses</a>)を含むDML文を含め、結果の行はすべて破棄されます。</p>
</div>
<div class="deprecated-removed">
<p><span class="versionmodified">バージョン 3.12 で非推奨、バージョン 3.14 で削除予定: </span><a class="reference internal" href="sqlite3.html#sqlite3-placeholders"><span class="std std-ref">名前付きプレースホルダー</span></a> が使用され、かつ、パラメーターが <a class="reference internal" href="stdtypes.html#dict" title="dict"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> ではなくシーケンスである場合、 <a class="reference internal" href="exceptions.html#DeprecationWarning" title="DeprecationWarning"><code class="xref py py-exc docutils literal notranslate"><span class="pre">DeprecationWarning</span></code></a> を送出します。 Python 3.14 以降では、代わりに <a class="reference internal" href="sqlite3.html#sqlite3.ProgrammingError" title="sqlite3.ProgrammingError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ProgrammingError</span></code></a> を送出します。</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlite3.Cursor.executescript">
<span class="sig-name descname"><span class="pre">executescript</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sql_script</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="sqlite3.html#sqlite3.Cursor.executescript" title="Link to this definition">¶</a></dt>
<dd><p><em>sql_script</em> 内の複数のSQL文を実行します。 <a class="reference internal" href="sqlite3.html#sqlite3.Connection.autocommit" title="sqlite3.Connection.autocommit"><code class="xref py py-attr docutils literal notranslate"><span class="pre">autocommit</span></code></a> が <a class="reference internal" href="sqlite3.html#sqlite3.LEGACY_TRANSACTION_CONTROL" title="sqlite3.LEGACY_TRANSACTION_CONTROL"><code class="xref py py-data docutils literal notranslate"><span class="pre">LEGACY_TRANSACTION_CONTROL</span></code></a> で、かつ、保留中のトランザクションがある場合、暗黙の <code class="docutils literal notranslate"><span class="pre">COMMIT</span></code> 文が最初に実行されます。その他の暗黙のトランザクション制御は実行されませんので、トランザクション制御を <em>sql_script</em> に追加しなければなりません。</p>
<p><em>sql_script</em> は <a class="reference internal" href="stdtypes.html#str" title="str"><code class="xref py py-class docutils literal notranslate"><span class="pre">文字列</span></code></a> でなければなりません。</p>
<p>例:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># cur is an sqlite3.Cursor object</span>
<span class="n">cur</span><span class="o">.</span><span class="n">executescript</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    BEGIN;</span>
<span class="s2">    CREATE TABLE person(firstname, lastname, age);</span>
<span class="s2">    CREATE TABLE book(title, author, published);</span>
<span class="s2">    CREATE TABLE publisher(name, address);</span>
<span class="s2">    COMMIT;</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlite3.Cursor.fetchone">
<span class="sig-name descname"><span class="pre">fetchone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="sqlite3.html#sqlite3.Cursor.fetchone" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="sqlite3.html#sqlite3.Cursor.row_factory" title="sqlite3.Cursor.row_factory"><code class="xref py py-attr docutils literal notranslate"><span class="pre">row_factory</span></code></a> が <code class="docutils literal notranslate"><span class="pre">None</span></code> の場合、 次の行のクエリ結果セットを <a class="reference internal" href="stdtypes.html#tuple" title="tuple"><code class="xref py py-class docutils literal notranslate"><span class="pre">タプル</span></code></a> として返します。それ以外の場合は、 それを行工場(row factory)に渡し、 その結果を返します。 これ以上データが無い場合は <code class="docutils literal notranslate"><span class="pre">None</span></code> を返します。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlite3.Cursor.fetchmany">
<span class="sig-name descname"><span class="pre">fetchmany</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">cursor.arraysize</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="sqlite3.html#sqlite3.Cursor.fetchmany" title="Link to this definition">¶</a></dt>
<dd><p>クエリ結果の次の行セットを <a class="reference internal" href="stdtypes.html#list" title="list"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> として返します。行がそれ以上ない場合は、空のリストを返します。</p>
<p>呼び出しごとに取得する行数は、<em>size</em> パラメーターで指定されます。 <em>size</em> が指定されていない場合、 <a class="reference internal" href="sqlite3.html#sqlite3.Cursor.arraysize" title="sqlite3.Cursor.arraysize"><code class="xref py py-attr docutils literal notranslate"><span class="pre">arraysize</span></code></a> が取得する行数を決定します。有効な行の数が <em>size</em> 未満の場合は、有効な数の行が返されます。</p>
<p><em>size</em> 引数とパフォーマンスの関係についての注意です。パフォーマンスを最適化するためには、大抵、 arraysize 属性を利用するのがベストです。 <em>size</em> 引数を利用したのであれば、次回の <a class="reference internal" href="sqlite3.html#sqlite3.Cursor.fetchmany" title="sqlite3.Cursor.fetchmany"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fetchmany()</span></code></a> の呼び出しでも <em>size</em> 引数に同一の値を指定するのがのがベストです。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlite3.Cursor.fetchall">
<span class="sig-name descname"><span class="pre">fetchall</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="sqlite3.html#sqlite3.Cursor.fetchall" title="Link to this definition">¶</a></dt>
<dd><p>クエリ結果の(残りの)すべての行を <a class="reference internal" href="stdtypes.html#list" title="list"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> として返します。 有効な行がない場合は、空のリストを返します。 <a class="reference internal" href="sqlite3.html#sqlite3.Cursor.arraysize" title="sqlite3.Cursor.arraysize"><code class="xref py py-attr docutils literal notranslate"><span class="pre">arraysize</span></code></a> 属性は、この操作のパフォーマンスに影響を与える可能性があることに注意してください。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlite3.Cursor.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="sqlite3.html#sqlite3.Cursor.close" title="Link to this definition">¶</a></dt>
<dd><p>(<code class="docutils literal notranslate"><span class="pre">__del__</span></code> が呼び出される時ではなく、) 今すぐカーソルを閉じます。</p>
<p>この時点から、このカーソルは使用できなくなります。今後、このカーソルで何らかの操作を試みると、 <a class="reference internal" href="sqlite3.html#sqlite3.ProgrammingError" title="sqlite3.ProgrammingError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ProgrammingError</span></code></a> 例外が送出されます。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlite3.Cursor.setinputsizes">
<span class="sig-name descname"><span class="pre">setinputsizes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sizes</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="sqlite3.html#sqlite3.Cursor.setinputsizes" title="Link to this definition">¶</a></dt>
<dd><p>DB-API で必要です。 <code class="xref py py-mod docutils literal notranslate"><span class="pre">sqlite3</span></code> では何もしません。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlite3.Cursor.setoutputsize">
<span class="sig-name descname"><span class="pre">setoutputsize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">column</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="sqlite3.html#sqlite3.Cursor.setoutputsize" title="Link to this definition">¶</a></dt>
<dd><p>DB-API で必要です。 <code class="xref py py-mod docutils literal notranslate"><span class="pre">sqlite3</span></code> では何もしません。</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sqlite3.Cursor.arraysize">
<span class="sig-name descname"><span class="pre">arraysize</span></span><a class="headerlink" href="sqlite3.html#sqlite3.Cursor.arraysize" title="Link to this definition">¶</a></dt>
<dd><p>fetchmany によって返される行(row)数を制御する、読み取りと書き込みが可能な属性。 デフォルト値は 1 で、これは呼び出しごとに 1 行が取得されることを意味します。</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sqlite3.Cursor.connection">
<span class="sig-name descname"><span class="pre">connection</span></span><a class="headerlink" href="sqlite3.html#sqlite3.Cursor.connection" title="Link to this definition">¶</a></dt>
<dd><p>カーソルが属する SQLite データベース <a class="reference internal" href="sqlite3.html#sqlite3.Connection" title="sqlite3.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> を提供する読み取り専用属性。 <a class="reference internal" href="sqlite3.html#sqlite3.Connection.cursor" title="sqlite3.Connection.cursor"><code class="xref py py-meth docutils literal notranslate"><span class="pre">con.cursor()</span></code></a> と呼び出して作成した <a class="reference internal" href="sqlite3.html#sqlite3.Cursor" title="sqlite3.Cursor"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cursor</span></code></a> オブジェクトには、<em>con</em> を参照する <a class="reference internal" href="sqlite3.html#sqlite3.Cursor.connection" title="sqlite3.Cursor.connection"><code class="xref py py-attr docutils literal notranslate"><span class="pre">connection</span></code></a> 属性があります:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">con</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;:memory:&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cur</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cur</span><span class="o">.</span><span class="n">connection</span> <span class="o">==</span> <span class="n">con</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sqlite3.Cursor.description">
<span class="sig-name descname"><span class="pre">description</span></span><a class="headerlink" href="sqlite3.html#sqlite3.Cursor.description" title="Link to this definition">¶</a></dt>
<dd><p>最後のクエリの列(column)名を提供する読み取り専用属性。 Python DB API との互換性を維持するために、各列ごとに 7 項目のタプルで、先頭の項目が列名、残りの6項目が <code class="docutils literal notranslate"><span class="pre">None</span></code> です。</p>
<p>この属性は <code class="docutils literal notranslate"><span class="pre">SELECT</span></code> 文にマッチする行(row)が1つもなかった場合でもセットされます。</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sqlite3.Cursor.lastrowid">
<span class="sig-name descname"><span class="pre">lastrowid</span></span><a class="headerlink" href="sqlite3.html#sqlite3.Cursor.lastrowid" title="Link to this definition">¶</a></dt>
<dd><p>最後に挿入された行の行 ID (row id) を提供する読み取り専用属性。 <a class="reference internal" href="sqlite3.html#sqlite3.Cursor.execute" title="sqlite3.Cursor.execute"><code class="xref py py-meth docutils literal notranslate"><span class="pre">execute()</span></code></a>  で <code class="docutils literal notranslate"><span class="pre">INSERT</span></code> または <code class="docutils literal notranslate"><span class="pre">REPLACE</span></code> 文が成功した後にのみ更新されます。他のSQL文や、 <a class="reference internal" href="sqlite3.html#sqlite3.Cursor.executemany" title="sqlite3.Cursor.executemany"><code class="xref py py-meth docutils literal notranslate"><span class="pre">executemany()</span></code></a> の後や、 <a class="reference internal" href="sqlite3.html#sqlite3.Cursor.executescript" title="sqlite3.Cursor.executescript"><code class="xref py py-meth docutils literal notranslate"><span class="pre">executescript()</span></code></a> の後や、 挿入が失敗した場合、 <code class="docutils literal notranslate"><span class="pre">lastrowid</span></code> の値は変更されません。<code class="docutils literal notranslate"><span class="pre">lastrowid</span></code> の初期値は <code class="docutils literal notranslate"><span class="pre">None</span></code> です。</p>
<div class="admonition note">
<p class="admonition-title">注釈</p>
<p><code class="docutils literal notranslate"><span class="pre">WITHOUT</span> <span class="pre">ROWID</span></code> テーブルへの挿入(insert)は記録されません。</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">バージョン 3.6 で変更: </span><code class="docutils literal notranslate"><span class="pre">REPLACE</span></code> 文のサポートが追加されました。</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sqlite3.Cursor.rowcount">
<span class="sig-name descname"><span class="pre">rowcount</span></span><a class="headerlink" href="sqlite3.html#sqlite3.Cursor.rowcount" title="Link to this definition">¶</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">INSERT</span></code> や <code class="docutils literal notranslate"><span class="pre">UPDATE</span></code> や <code class="docutils literal notranslate"><span class="pre">DELETE</span></code> や <code class="docutils literal notranslate"><span class="pre">REPLACE</span></code> 文で変更された行数を提供する読み取り専用属性。 <abbr title="共通テーブル式">CTE</abbr> クエリを含む他のSQL文は <code class="docutils literal notranslate"><span class="pre">-1</span></code> です。 <a class="reference internal" href="sqlite3.html#sqlite3.Cursor.execute" title="sqlite3.Cursor.execute"><code class="xref py py-meth docutils literal notranslate"><span class="pre">execute()</span></code></a> と <a class="reference internal" href="sqlite3.html#sqlite3.Cursor.executemany" title="sqlite3.Cursor.executemany"><code class="xref py py-meth docutils literal notranslate"><span class="pre">executemany()</span></code></a> メソッドのみにおいて、 SQL文(statement)実行の完了後に更新されます。 なぜなら <code class="xref py py-attr docutils literal notranslate"><span class="pre">rowcount</span></code> を更新するためには、結果の行を取得(fetch)しなければならないからです。</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sqlite3.Cursor.row_factory">
<span class="sig-name descname"><span class="pre">row_factory</span></span><a class="headerlink" href="sqlite3.html#sqlite3.Cursor.row_factory" title="Link to this definition">¶</a></dt>
<dd><p>この <code class="xref py py-class docutils literal notranslate"><span class="pre">カーソル</span></code> から取得された行の表現方法を制御します。 <code class="docutils literal notranslate"><span class="pre">None</span></code> の場合、行は <a class="reference internal" href="stdtypes.html#tuple" title="tuple"><code class="xref py py-class docutils literal notranslate"><span class="pre">タプル</span></code></a> として表されます。 <a class="reference internal" href="sqlite3.html#sqlite3.Row" title="sqlite3.Row"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlite3.Row</span></code></a> に設定することもできます。 そしてまた、 <a class="reference internal" href="sqlite3.html#sqlite3.Cursor" title="sqlite3.Cursor"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cursor</span></code></a> オブジェクトと、 行の値の <code class="xref py py-class docutils literal notranslate"><span class="pre">タプル</span></code> の、 2 つの引数を受け取り、 SQLite の行(row)を表すカスタム・オブジェクトを返す、 <a class="reference internal" href="../glossary.html#term-callable"><span class="xref std std-term">呼び出し可能オブジェクト</span></a> に設定することもできます。</p>
<p><code class="xref py py-class docutils literal notranslate"><span class="pre">カーソル・オブジェクト</span></code> の作成時に <a class="reference internal" href="sqlite3.html#sqlite3.Connection.row_factory" title="sqlite3.Connection.row_factory"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Connection.row_factory</span></code></a> の値をこの属性のデフォルト値として設定します。この属性に割り当てても、親接続(parent connection)の <a class="reference internal" href="sqlite3.html#sqlite3.Connection.row_factory" title="sqlite3.Connection.row_factory"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Connection.row_factory</span></code></a> には影響しません。</p>
<p>詳細は <a class="reference internal" href="sqlite3.html#sqlite3-howto-row-factory"><span class="std std-ref">行工場(row factories)の作成方法と使用方法</span></a> をご覧下さい。</p>
</dd></dl>

</dd></dl>

</section>
<section id="row-objects">
<span id="sqlite3-row-objects"></span><span id="sqlite3-columns-by-name"></span><h3>Row オブジェクト<a class="headerlink" href="sqlite3.html#row-objects" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="sqlite3.Row">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlite3.</span></span><span class="sig-name descname"><span class="pre">Row</span></span><a class="headerlink" href="sqlite3.html#sqlite3.Row" title="Link to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Row</span></code> インスタンスは、 <a class="reference internal" href="sqlite3.html#sqlite3.Connection" title="sqlite3.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> オブジェクトの、高度に最適化された <a class="reference internal" href="sqlite3.html#sqlite3.Connection.row_factory" title="sqlite3.Connection.row_factory"><code class="xref py py-attr docutils literal notranslate"><span class="pre">row_factory</span></code></a> の役割をします。 反復(iteration)や、等しいかどうかのテスト(equality testing)や、 <a class="reference internal" href="functions.html#len" title="len"><code class="xref py py-func docutils literal notranslate"><span class="pre">len()</span></code></a> 関数や 、 列名(column name)とインデックスによる <a class="reference internal" href="../glossary.html#term-mapping"><span class="xref std std-term">マッピング</span></a> のアクセスを、サポートします。</p>
<p>列名(column names)と値(values)が全く同一である 2 つの <code class="xref py py-class docutils literal notranslate"><span class="pre">Row</span></code>  オブジェクトを比較すると、等しいと見なされます。</p>
<p>詳細は <a class="reference internal" href="sqlite3.html#sqlite3-howto-row-factory"><span class="std std-ref">行工場(row factories)の作成方法と使用方法</span></a> をご覧下さい。</p>
<dl class="py method">
<dt class="sig sig-object py" id="sqlite3.Row.keys">
<span class="sig-name descname"><span class="pre">keys</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="sqlite3.html#sqlite3.Row.keys" title="Link to this definition">¶</a></dt>
<dd><p>列名(column names)の <a class="reference internal" href="stdtypes.html#list" title="list"><code class="xref py py-class docutils literal notranslate"><span class="pre">リスト</span></code></a> を <a class="reference internal" href="stdtypes.html#str" title="str"><code class="xref py py-class docutils literal notranslate"><span class="pre">文字列</span></code></a> として返します。 クエリの直後であれば、それは <a class="reference internal" href="sqlite3.html#sqlite3.Cursor.description" title="sqlite3.Cursor.description"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Cursor.description</span></code></a> の各タプルの最初のメンバーです。</p>
</dd></dl>

<div class="versionchanged">
<p><span class="versionmodified changed">バージョン 3.5 で変更: </span>スライスがサポートされました。</p>
</div>
</dd></dl>

</section>
<section id="blob-objects">
<span id="sqlite3-blob-objects"></span><h3>Blob オブジェクト<a class="headerlink" href="sqlite3.html#blob-objects" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="sqlite3.Blob">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlite3.</span></span><span class="sig-name descname"><span class="pre">Blob</span></span><a class="headerlink" href="sqlite3.html#sqlite3.Blob" title="Link to this definition">¶</a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">Added in version 3.11.</span></p>
</div>
<p><a class="reference internal" href="sqlite3.html#sqlite3.Blob" title="sqlite3.Blob"><code class="xref py py-class docutils literal notranslate"><span class="pre">Blob</span></code></a> インスタンスは、 SQLite の <abbr title="Binary Large OBject">BLOB</abbr> とデータを読み書きできる <a class="reference internal" href="../glossary.html#term-file-like-object"><span class="xref std std-term">file-like object</span></a> です。 <a class="reference internal" href="functions.html#len" title="len"><code class="xref py py-func docutils literal notranslate"><span class="pre">len(blob)</span></code></a> を呼び出して、 Blob のサイズ (バイト数) を取得します。 Blob データに直接アクセスするには、インデックスと <a class="reference internal" href="../glossary.html#term-slice"><span class="xref std std-term">スライス</span></a> を使用します。</p>
<p><a class="reference internal" href="sqlite3.html#sqlite3.Blob" title="sqlite3.Blob"><code class="xref py py-class docutils literal notranslate"><span class="pre">Blob</span></code></a> を <a class="reference internal" href="../glossary.html#term-context-manager"><span class="xref std std-term">コンテキストマネージャ</span></a> として使用して、 使用後に Blob ハンドルが確実に閉じられるようにします。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">con</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;:memory:&quot;</span><span class="p">)</span>
<span class="n">con</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;CREATE TABLE test(blob_col blob)&quot;</span><span class="p">)</span>
<span class="n">con</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;INSERT INTO test(blob_col) VALUES(zeroblob(13))&quot;</span><span class="p">)</span>

<span class="c1"># Write to our blob, using two write operations:</span>
<span class="k">with</span> <span class="n">con</span><span class="o">.</span><span class="n">blobopen</span><span class="p">(</span><span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="s2">&quot;blob_col&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">as</span> <span class="n">blob</span><span class="p">:</span>
    <span class="n">blob</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;hello, &quot;</span><span class="p">)</span>
    <span class="n">blob</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;world.&quot;</span><span class="p">)</span>
    <span class="c1"># Modify the first and last bytes of our blob</span>
    <span class="n">blob</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="s2">&quot;H&quot;</span><span class="p">)</span>
    <span class="n">blob</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="s2">&quot;!&quot;</span><span class="p">)</span>

<span class="c1"># Read the contents of our blob</span>
<span class="k">with</span> <span class="n">con</span><span class="o">.</span><span class="n">blobopen</span><span class="p">(</span><span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="s2">&quot;blob_col&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">as</span> <span class="n">blob</span><span class="p">:</span>
    <span class="n">greeting</span> <span class="o">=</span> <span class="n">blob</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">greeting</span><span class="p">)</span>  <span class="c1"># outputs &quot;b&#39;Hello, world!&#39;&quot;</span>
<span class="n">con</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sqlite3.Blob.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="sqlite3.html#sqlite3.Blob.close" title="Link to this definition">¶</a></dt>
<dd><p>Blob を閉じます。</p>
<p>この時点から、 BLOB は使用できなくなります。 BLOB に対してさらに操作を試みると、 <a class="reference internal" href="sqlite3.html#sqlite3.Error" title="sqlite3.Error"><code class="xref py py-class docutils literal notranslate"><span class="pre">Error</span></code></a> (またはそのサブクラスの) 例外を送出します。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlite3.Blob.read">
<span class="sig-name descname"><span class="pre">read</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="sqlite3.html#sqlite3.Blob.read" title="Link to this definition">¶</a></dt>
<dd><p>BLOB の現在のオフセット位置から <em>length</em> バイトのデータを読み取り返ます。 BLOB の現在のオフセット位置から末尾までの残りが <em>length</em> バイトよりも少ない場合、末尾までのデータを読み取ります。 <em>length</em> が指定されていない場合、 または負数の場合、 <a class="reference internal" href="sqlite3.html#sqlite3.Blob.read" title="sqlite3.Blob.read"><code class="xref py py-meth docutils literal notranslate"><span class="pre">read()</span></code></a> は BLOB の現在のオフセット位置から末尾までのデータを読み取ります。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlite3.Blob.write">
<span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="sqlite3.html#sqlite3.Blob.write" title="Link to this definition">¶</a></dt>
<dd><p>BLOB の現在のオフセット位置から <em>data</em> を書き込みます。 この関数では BLOB の長さを変更できません。 BLOB の末尾を超えて書き込もうとすると <a class="reference internal" href="exceptions.html#ValueError" title="ValueError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code></a> を送出します。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlite3.Blob.tell">
<span class="sig-name descname"><span class="pre">tell</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="sqlite3.html#sqlite3.Blob.tell" title="Link to this definition">¶</a></dt>
<dd><p>BLOBの現在のオフセット位置(current access position)を返します。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlite3.Blob.seek">
<span class="sig-name descname"><span class="pre">seek</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">offset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">origin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">os.SEEK_SET</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="sqlite3.html#sqlite3.Blob.seek" title="Link to this definition">¶</a></dt>
<dd><p>Set the current access position of the blob to <em>offset</em>.  The <em>origin</em>
argument defaults to <a class="reference internal" href="os.html#os.SEEK_SET" title="os.SEEK_SET"><code class="xref py py-const docutils literal notranslate"><span class="pre">os.SEEK_SET</span></code></a> (absolute blob positioning).
Other values for <em>origin</em> are <a class="reference internal" href="os.html#os.SEEK_CUR" title="os.SEEK_CUR"><code class="xref py py-const docutils literal notranslate"><span class="pre">os.SEEK_CUR</span></code></a> (seek relative to the
current position) and <a class="reference internal" href="os.html#os.SEEK_END" title="os.SEEK_END"><code class="xref py py-const docutils literal notranslate"><span class="pre">os.SEEK_END</span></code></a> (seek relative to the blob’s
end).</p>
</dd></dl>

</dd></dl>

</section>
<section id="prepareprotocol-objects">
<h3>PrepareProtocol オブジェクト<a class="headerlink" href="sqlite3.html#prepareprotocol-objects" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="sqlite3.PrepareProtocol">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlite3.</span></span><span class="sig-name descname"><span class="pre">PrepareProtocol</span></span><a class="headerlink" href="sqlite3.html#sqlite3.PrepareProtocol" title="Link to this definition">¶</a></dt>
<dd><p>PrepareProtocol 型の唯一の目的は、 <a class="reference internal" href="sqlite3.html#sqlite3-types"><span class="std std-ref">SQLite でネイティブにサポートされている型</span></a> に <a class="reference internal" href="sqlite3.html#sqlite3-conform"><span class="std std-ref">オブジェクト自身で適合(adapt)</span></a> できるオブジェクトの  <span class="target" id="index-24"></span><a class="pep reference external" href="https://peps.python.org/pep-0246/"><strong>PEP 246</strong></a> スタイルの適合プロトコルとして機能することです。</p>
</dd></dl>

</section>
<section id="exceptions">
<span id="sqlite3-exceptions"></span><h3>例外<a class="headerlink" href="sqlite3.html#exceptions" title="Link to this heading">¶</a></h3>
<p>例外の階層は DB-API 2.0 (<span class="target" id="index-25"></span><a class="pep reference external" href="https://peps.python.org/pep-0249/"><strong>PEP 249</strong></a>) で定義されています。</p>
<dl class="py exception">
<dt class="sig sig-object py" id="sqlite3.Warning">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlite3.</span></span><span class="sig-name descname"><span class="pre">Warning</span></span><a class="headerlink" href="sqlite3.html#sqlite3.Warning" title="Link to this definition">¶</a></dt>
<dd><p>この例外は、現在 <code class="xref py py-mod docutils literal notranslate"><span class="pre">sqlite3</span></code> モジュールでは送出しませんが、ユーザー定義関数が挿入処理中にデータを切り捨てる場合など、<code class="xref py py-mod docutils literal notranslate"><span class="pre">sqlite3</span></code> を使用するアプリケーションによって送出されるる可能性があります。 <code class="docutils literal notranslate"><span class="pre">Warning</span></code> は <a class="reference internal" href="exceptions.html#Exception" title="Exception"><code class="xref py py-exc docutils literal notranslate"><span class="pre">Exception</span></code></a> のサブクラスです。</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="sqlite3.Error">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlite3.</span></span><span class="sig-name descname"><span class="pre">Error</span></span><a class="headerlink" href="sqlite3.html#sqlite3.Error" title="Link to this definition">¶</a></dt>
<dd><p>このモジュールの他の例外の基底となるクラス。 これを使用すると、1 つの <a class="reference internal" href="../reference/compound_stmts.html#except"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">except</span></code></a> 文ですべてのエラーをキャッチできます。 <code class="docutils literal notranslate"><span class="pre">Error</span></code> は <a class="reference internal" href="exceptions.html#Exception" title="Exception"><code class="xref py py-exc docutils literal notranslate"><span class="pre">Exception</span></code></a> のサブクラスです。</p>
<p>例外が SQLite ライブラリ内で発生した場合、 以下の 2 つの属性が例外に追加されます:</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="sqlite3.Error.sqlite_errorcode">
<span class="sig-name descname"><span class="pre">sqlite_errorcode</span></span><a class="headerlink" href="sqlite3.html#sqlite3.Error.sqlite_errorcode" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://sqlite.org/rescode.html">SQLite API</a> からの数値エラー・コード</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 3.11.</span></p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sqlite3.Error.sqlite_errorname">
<span class="sig-name descname"><span class="pre">sqlite_errorname</span></span><a class="headerlink" href="sqlite3.html#sqlite3.Error.sqlite_errorname" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://sqlite.org/rescode.html">SQLite API</a> からの数値エラー・コードの記号名</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 3.11.</span></p>
</div>
</dd></dl>

</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="sqlite3.InterfaceError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlite3.</span></span><span class="sig-name descname"><span class="pre">InterfaceError</span></span><a class="headerlink" href="sqlite3.html#sqlite3.InterfaceError" title="Link to this definition">¶</a></dt>
<dd><p>低レベルの SQLite C API の誤用により送出される例外。 つまり、この例外が送出された場合、おそらく <code class="xref py py-mod docutils literal notranslate"><span class="pre">sqlite3</span></code> モジュールのバグを示しています。 <code class="docutils literal notranslate"><span class="pre">InterfaceError</span></code> は <a class="reference internal" href="sqlite3.html#sqlite3.Error" title="sqlite3.Error"><code class="xref py py-exc docutils literal notranslate"><span class="pre">Error</span></code></a> のサブクラスです。</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="sqlite3.DatabaseError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlite3.</span></span><span class="sig-name descname"><span class="pre">DatabaseError</span></span><a class="headerlink" href="sqlite3.html#sqlite3.DatabaseError" title="Link to this definition">¶</a></dt>
<dd><p>データベースに関連するエラーに対して送出される例外。 これは、いくつかの種類のデータベース・エラーの基底の例外として機能します。 これを特殊化(specialise)したサブクラスを介して暗黙的にのみ送出されます。 <code class="docutils literal notranslate"><span class="pre">DatabaseError</span></code> は <a class="reference internal" href="sqlite3.html#sqlite3.Error" title="sqlite3.Error"><code class="xref py py-exc docutils literal notranslate"><span class="pre">Error</span></code></a> のサブクラスです。</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="sqlite3.DataError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlite3.</span></span><span class="sig-name descname"><span class="pre">DataError</span></span><a class="headerlink" href="sqlite3.html#sqlite3.DataError" title="Link to this definition">¶</a></dt>
<dd><p>範囲外の数値や長すぎる文字列など、処理されたデータの問題によって発生したエラーに対して送出される例外。 <code class="docutils literal notranslate"><span class="pre">DataError</span></code> は <a class="reference internal" href="sqlite3.html#sqlite3.DatabaseError" title="sqlite3.DatabaseError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">DatabaseError</span></code></a> のサブクラスです。</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="sqlite3.OperationalError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlite3.</span></span><span class="sig-name descname"><span class="pre">OperationalError</span></span><a class="headerlink" href="sqlite3.html#sqlite3.OperationalError" title="Link to this definition">¶</a></dt>
<dd><p>データベースの操作に関連し、必ずしもプログラマの制御下にないエラーに対して発生する例外。 たとえば、データベース・パスが見つからないとか、トランザクションを処理できませんでした等。 <code class="docutils literal notranslate"><span class="pre">OperationalError</span></code> は <a class="reference internal" href="sqlite3.html#sqlite3.DatabaseError" title="sqlite3.DatabaseError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">DatabaseError</span></code></a> のサブクラスです。</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="sqlite3.IntegrityError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlite3.</span></span><span class="sig-name descname"><span class="pre">IntegrityError</span></span><a class="headerlink" href="sqlite3.html#sqlite3.IntegrityError" title="Link to this definition">¶</a></dt>
<dd><p>データベースの参照整合性が影響を受ける場合に発生する例外。 たとえば外部キーのチェック(foreign key check)が失敗したとき。 <a class="reference internal" href="sqlite3.html#sqlite3.DatabaseError" title="sqlite3.DatabaseError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">DatabaseError</span></code></a> のサブクラスです。</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="sqlite3.InternalError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlite3.</span></span><span class="sig-name descname"><span class="pre">InternalError</span></span><a class="headerlink" href="sqlite3.html#sqlite3.InternalError" title="Link to this definition">¶</a></dt>
<dd><p>SQLite が内部エラーに遭遇したときに発生する例外。 これが送出された場合、ランタイム SQLite ライブラリに問題があることを示している可能性があります。 <code class="docutils literal notranslate"><span class="pre">InternalError</span></code> は <a class="reference internal" href="sqlite3.html#sqlite3.DatabaseError" title="sqlite3.DatabaseError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">DatabaseError</span></code></a> のサブクラスです。</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="sqlite3.ProgrammingError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlite3.</span></span><span class="sig-name descname"><span class="pre">ProgrammingError</span></span><a class="headerlink" href="sqlite3.html#sqlite3.ProgrammingError" title="Link to this definition">¶</a></dt>
<dd><p><code class="xref py py-mod docutils literal notranslate"><span class="pre">sqlite3</span></code> API プログラミング・エラーに対して送出される例外。たとえば、クエリに間違った数のバインディング(結び付け)を指定したり、閉じた後の <a class="reference internal" href="sqlite3.html#sqlite3.Connection" title="sqlite3.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> を操作しようとしたりしたとき。 <code class="docutils literal notranslate"><span class="pre">ProgrammingError</span></code> は <a class="reference internal" href="sqlite3.html#sqlite3.DatabaseError" title="sqlite3.DatabaseError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">DatabaseError</span></code></a> のサブクラスです。</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="sqlite3.NotSupportedError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlite3.</span></span><span class="sig-name descname"><span class="pre">NotSupportedError</span></span><a class="headerlink" href="sqlite3.html#sqlite3.NotSupportedError" title="Link to this definition">¶</a></dt>
<dd><p>メソッドまたはデータベース API が 背後の SQLite ライブラリでサポートしていない場合に送出される例外。たとえば、背後の SQLite ライブラリが決定論的関数(deterministic functions)をサポートしていない場合に、<a class="reference internal" href="sqlite3.html#sqlite3.Connection.create_function" title="sqlite3.Connection.create_function"><code class="xref py py-meth docutils literal notranslate"><span class="pre">create_function()</span></code></a> で <em>deterministic</em> を <code class="docutils literal notranslate"><span class="pre">True</span></code> に設定したとき。 <code class="docutils literal notranslate"><span class="pre">NotSupportedError</span></code>  は <a class="reference internal" href="sqlite3.html#sqlite3.DatabaseError" title="sqlite3.DatabaseError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">DatabaseError</span></code></a> のサブクラスです。</p>
</dd></dl>

</section>
<section id="sqlite-and-python-types">
<span id="sqlite3-types"></span><h3>SQLite と Python の型<a class="headerlink" href="sqlite3.html#sqlite-and-python-types" title="Link to this heading">¶</a></h3>
<p>SQLite は以下の型をネイティブにサポートします: <code class="docutils literal notranslate"><span class="pre">NULL</span></code>, <code class="docutils literal notranslate"><span class="pre">INTEGER</span></code>, <code class="docutils literal notranslate"><span class="pre">REAL</span></code>, <code class="docutils literal notranslate"><span class="pre">TEXT</span></code>, <code class="docutils literal notranslate"><span class="pre">BLOB</span></code>。</p>
<p>したがって、次の Python の型は問題なく SQLite に送り込めます:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Python の型</p></th>
<th class="head"><p>SQLite の型</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">NULL</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="functions.html#int" title="int"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">INTEGER</span></code></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="functions.html#float" title="float"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">REAL</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="stdtypes.html#str" title="str"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">TEXT</span></code></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="stdtypes.html#bytes" title="bytes"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BLOB</span></code></p></td>
</tr>
</tbody>
</table>
<p>SQLite の型から Python の型へのデフォルトでの変換は以下の通りです:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>SQLite の型</p></th>
<th class="head"><p>Python の型</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">NULL</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">INTEGER</span></code></p></td>
<td><p><a class="reference internal" href="functions.html#int" title="int"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">REAL</span></code></p></td>
<td><p><a class="reference internal" href="functions.html#float" title="float"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">TEXT</span></code></p></td>
<td><p><a class="reference internal" href="sqlite3.html#sqlite3.Connection.text_factory" title="sqlite3.Connection.text_factory"><code class="xref py py-attr docutils literal notranslate"><span class="pre">text_factory</span></code></a> に依存する。デフォルトでは <a class="reference internal" href="stdtypes.html#str" title="str"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> 。</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">BLOB</span></code></p></td>
<td><p><a class="reference internal" href="stdtypes.html#bytes" title="bytes"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></a></p></td>
</tr>
</tbody>
</table>
<p><code class="xref py py-mod docutils literal notranslate"><span class="pre">sqlite3</span></code> モジュールの型システムは 2 つの方法で拡張可能です。 <a class="reference internal" href="sqlite3.html#sqlite3-adapters"><span class="std std-ref">オブジェクト適合関数(adapter)</span></a> を介して SQLite データベースに追加の Python 型を格納できます。 または、 <a class="reference internal" href="sqlite3.html#sqlite3-converters"><span class="std std-ref">変換関数(converter)</span></a> を介して <code class="xref py py-mod docutils literal notranslate"><span class="pre">sqlite3</span></code> モジュールが SQLite 型を Python 型に変換できます。</p>
</section>
<section id="default-adapters-and-converters-deprecated">
<span id="sqlite3-default-converters"></span><h3>デフォルトの適合関数(adapters)とデフォルトの変換関数(converters)(非推奨)<a class="headerlink" href="sqlite3.html#default-adapters-and-converters-deprecated" title="Link to this heading">¶</a></h3>
<div class="admonition note">
<p class="admonition-title">注釈</p>
<p>デフォルトの適合関数(adapters)とデフォルトの変換関数(converters)は、 Python 3.12 以降非推奨になりました。代わりに、 <a class="reference internal" href="sqlite3.html#sqlite3-adapter-converter-recipes"><span class="std std-ref">適合関数と変換関数のレシピ集</span></a> を利用して、あなたのニーズに合わせて仕立てて下さい。</p>
</div>
<p>非推奨の、デフォルトの適合関数(adapters)とデフォルトの変換関数(converters)は以下のもので構成されています:</p>
<ul class="simple">
<li><p><a class="reference internal" href="datetime.html#datetime.date" title="datetime.date"><code class="xref py py-class docutils literal notranslate"><span class="pre">datetime.date</span></code></a> オブジェクトを <a class="reference external" href="https://en.wikipedia.org/wiki/ISO_8601">ISO 8601</a> 形式の <a class="reference internal" href="stdtypes.html#str" title="str"><code class="xref py py-class docutils literal notranslate"><span class="pre">文字列</span></code></a> にする適合関数(adapter)。</p></li>
<li><p><a class="reference internal" href="datetime.html#datetime.datetime" title="datetime.datetime"><code class="xref py py-class docutils literal notranslate"><span class="pre">datetime.datetime</span></code></a> オブジェクトを ISO 8601 形式の文字列にする適合関数(adapter)。</p></li>
<li><p>&quot;date&quot; と <a class="reference internal" href="sqlite3.html#sqlite3-converters"><span class="std std-ref">宣言された</span></a> 型を <a class="reference internal" href="datetime.html#datetime.date" title="datetime.date"><code class="xref py py-class docutils literal notranslate"><span class="pre">datetime.date</span></code></a> オブジェクトにする変換関数(converter)。</p></li>
<li><p>&quot;timestamp&quot; と宣言された型を <a class="reference internal" href="datetime.html#datetime.datetime" title="datetime.datetime"><code class="xref py py-class docutils literal notranslate"><span class="pre">datetime.datetime</span></code></a> オブジェクトにする変換関数(converter)。小数部分は 6 桁 (マイクロ秒の精度) に切り捨てられます。</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">注釈</p>
<p>デフォルトの &quot;timestamp&quot; 変換関数は、データベース内の UTC オフセットを無視し、常に素朴(naive)な <a class="reference internal" href="datetime.html#datetime.datetime" title="datetime.datetime"><code class="xref py py-class docutils literal notranslate"><span class="pre">datetime.datetime</span></code></a> オブジェクトを返します。 timestamp で UTC オフセットを保持するには、変換関数を無効のままにするか、あるいは、オフセット対応の変換関数を <a class="reference internal" href="sqlite3.html#sqlite3.register_converter" title="sqlite3.register_converter"><code class="xref py py-func docutils literal notranslate"><span class="pre">register_converter()</span></code></a> に登録します。</p>
</div>
<div class="deprecated">
<p><span class="versionmodified deprecated">バージョン 3.12 で非推奨.</span></p>
</div>
</section>
<section id="command-line-interface">
<span id="sqlite3-cli"></span><h3>コマンドライン・インターフェース<a class="headerlink" href="sqlite3.html#command-line-interface" title="Link to this heading">¶</a></h3>
<p><code class="xref py py-mod docutils literal notranslate"><span class="pre">sqlite3</span></code> モジュールは、単純な SQLite シェルを提供するために、インタプリタで <a class="reference internal" href="../using/cmdline.html#cmdoption-m"><code class="xref std std-option docutils literal notranslate"><span class="pre">-m</span></code></a> スイッチを使用してスクリプトとして呼び出すことができます。引数は以下のとおりです:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">sqlite3</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">v</span><span class="p">]</span> <span class="p">[</span><span class="n">filename</span><span class="p">]</span> <span class="p">[</span><span class="n">sql</span><span class="p">]</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">.quit</span></code> または CTRL-D を入力するとシェルを終了(exit)します。</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-python-m-sqlite3-h-v-filename-sql-h">
<span id="cmdoption-python-m-sqlite3-h-v-filename-sql-help"></span><span class="sig-name descname"><span class="pre">-h</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--help</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="sqlite3.html#cmdoption-python-m-sqlite3-h-v-filename-sql-h" title="Link to this definition">¶</a></dt>
<dd><p>CLI ヘルプを表示。</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-python-m-sqlite3-h-v-filename-sql-v">
<span id="cmdoption-python-m-sqlite3-h-v-filename-sql-version"></span><span class="sig-name descname"><span class="pre">-v</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--version</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="sqlite3.html#cmdoption-python-m-sqlite3-h-v-filename-sql-v" title="Link to this definition">¶</a></dt>
<dd><p>背後の SQLite ライブラリのバージョンを出力します。</p>
</dd></dl>

<div class="versionadded">
<p><span class="versionmodified added">Added in version 3.12.</span></p>
</div>
</section>
</section>
<section id="how-to-guides">
<span id="sqlite3-howtos"></span><h2>ハウツー・ガイド<a class="headerlink" href="sqlite3.html#how-to-guides" title="Link to this heading">¶</a></h2>
<section id="how-to-use-placeholders-to-bind-values-in-sql-queries">
<span id="sqlite3-placeholders"></span><h3>プレースホルダを使用して SQL クエリに値を結び付ける方法<a class="headerlink" href="sqlite3.html#how-to-use-placeholders-to-bind-values-in-sql-queries" title="Link to this heading">¶</a></h3>
<p>たいてい、SQL 操作は Python 変数の値を使う必要があります。しかし、 Python の文字列操作を使用してクエリを組み立てるのはSQLインジェクション攻撃(<a class="reference external" href="https://en.wikipedia.org/wiki/SQL_injection">SQL injection attacks</a>)に対して脆弱なので注意が必要です。たとえば、攻撃者は以下のように単純にシングルクォートを閉じて <code class="docutils literal notranslate"><span class="pre">OR</span> <span class="pre">TRUE</span></code> を挿入してすべての行を選択できます:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Never do this -- insecure!</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">symbol</span> <span class="o">=</span> <span class="nb">input</span><span class="p">()</span>
<span class="go">&#39; OR TRUE; --</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM stocks WHERE symbol = &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="n">symbol</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">sql</span><span class="p">)</span>
<span class="go">SELECT * FROM stocks WHERE symbol = &#39;&#39; OR TRUE; --&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sql</span><span class="p">)</span>
</pre></div>
</div>
<p>代わりに、DB-API のパラメータ割り当てを使います。クエリ文字列にPythonの変数を挿入するには、クエリ文字列中でプレースホルダを使用し、 かつ、 カーソルの <a class="reference internal" href="sqlite3.html#sqlite3.Cursor.execute" title="sqlite3.Cursor.execute"><code class="xref py py-meth docutils literal notranslate"><span class="pre">execute()</span></code></a> メソッドの 2 番目の引数にPythonの変数を値の <a class="reference internal" href="stdtypes.html#tuple" title="tuple"><code class="xref py py-class docutils literal notranslate"><span class="pre">タプル</span></code></a> として指定することにより、 実際の値をクエリに割り当てます。</p>
<p>SQL 文では、疑問符 (qmark スタイル) または名前付きプレースホルダー (名前付きスタイル) の 2 種類のプレースホルダーのいずれかを使用できます。 qmark スタイルの場合、<em>parameters</em> は、 <a class="reference internal" href="../glossary.html#term-sequence"><span class="xref std std-term">シーケンス</span></a> でなければならず、シーケンスの長さがプレースホルダーの数と一致する必要があります。そうでなければ、 <a class="reference internal" href="sqlite3.html#sqlite3.ProgrammingError" title="sqlite3.ProgrammingError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ProgrammingError</span></code></a> を送出します。名前付きスタイルの場合、 <em>parameters</em> は <a class="reference internal" href="stdtypes.html#dict" title="dict"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> (またはそのサブクラス) のインスタンスである必要があり、すべての名前付きパラメーターのキーが含まれている必要があります。余分な項目は無視されます。両方のスタイルの例を以下に示します。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">con</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;:memory:&quot;</span><span class="p">)</span>
<span class="n">cur</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;CREATE TABLE lang(name, first_appeared)&quot;</span><span class="p">)</span>

<span class="c1"># This is the named style used with executemany():</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">1972</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Fortran&quot;</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">1957</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Python&quot;</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">1991</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Go&quot;</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">2009</span><span class="p">},</span>
<span class="p">)</span>
<span class="n">cur</span><span class="o">.</span><span class="n">executemany</span><span class="p">(</span><span class="s2">&quot;INSERT INTO lang VALUES(:name, :year)&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

<span class="c1"># This is the qmark style used in a SELECT query:</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1972</span><span class="p">,)</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM lang WHERE first_appeared = ?&quot;</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cur</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>
<span class="n">con</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">注釈</p>
<p><span class="target" id="index-26"></span><a class="pep reference external" href="https://peps.python.org/pep-0249/"><strong>PEP 249</strong></a> numeric プレースホルダは <em>サポートされていません</em> 。 使用すると、名前付きプレースホルダとして解釈されます。</p>
</div>
</section>
<section id="how-to-adapt-custom-python-types-to-sqlite-values">
<span id="sqlite3-adapters"></span><h3>カスタム Python 型を SQLite 値に適合させる方法<a class="headerlink" href="sqlite3.html#how-to-adapt-custom-python-types-to-sqlite-values" title="Link to this heading">¶</a></h3>
<p>SQLite は、 限られたデータ型のみをネイティブにサポートします。 カスタム Python 型を SQLite データベースに保存するには、 <a class="reference internal" href="sqlite3.html#sqlite3-types"><span class="std std-ref">SQLite がネイティブに理解できる Python 型</span></a> のいずれかに <em>適合</em> (adapt)させます。</p>
<p>Python オブジェクトを SQLite の型に適合させる方法は 2 つあります。それは、オブジェクト自体を適合させる方法と、 <em>adapter callable</em> を使用する方法です。 後者は前者よりも優先されます。 カスタム型をエクスポートするライブラリの場合、 その型がそれ自体を適合させる事ができるようにすることが理にかなっている場合があります。 アプリケーション開発者としては、カスタム適合関数を登録して直接制御する方が理にかなっている場合もあります。</p>
<section id="how-to-write-adaptable-objects">
<span id="sqlite3-conform"></span><h4>適合可能オブジェクトの書き方<a class="headerlink" href="sqlite3.html#how-to-write-adaptable-objects" title="Link to this heading">¶</a></h4>
<p>直交座標系(Cartesian coordinate system)で <code class="docutils literal notranslate"><span class="pre">x</span></code> と <code class="docutils literal notranslate"><span class="pre">y</span></code> のペアで座標を表す、 <code class="xref py py-class docutils literal notranslate"><span class="pre">Point</span></code> クラスがあるとします。 この <code class="docutils literal notranslate"><span class="pre">x</span></code> と <code class="docutils literal notranslate"><span class="pre">y</span></code> のペアはセミコロンで区切られたテキスト文字列としてデータベースに保存されます。 これは、適合した値を返す <code class="docutils literal notranslate"><span class="pre">__conform__(self,</span> <span class="pre">protocol)</span></code> メソッドを追加することで実装できます。 <em>protocol</em>  に渡されるオブジェクトは、 <a class="reference internal" href="sqlite3.html#sqlite3.PrepareProtocol" title="sqlite3.PrepareProtocol"><code class="xref py py-class docutils literal notranslate"><span class="pre">PrepareProtocol</span></code></a> 型になります。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Point</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>

    <span class="k">def</span> <span class="nf">__conform__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">protocol</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">protocol</span> <span class="ow">is</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">PrepareProtocol</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="si">}</span><span class="s2">;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="n">con</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;:memory:&quot;</span><span class="p">)</span>
<span class="n">cur</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT ?&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">Point</span><span class="p">(</span><span class="mf">4.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.2</span><span class="p">),))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cur</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">con</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="how-to-register-adapter-callables">
<h4>適合用呼び出し可能オブジェクト(adapter callables)の登録方法<a class="headerlink" href="sqlite3.html#how-to-register-adapter-callables" title="Link to this heading">¶</a></h4>
<p>別の策としては、Python オブジェクトを SQLite 互換の型に変換する関数を作成することが挙げられます。 この関数は、 <a class="reference internal" href="sqlite3.html#sqlite3.register_adapter" title="sqlite3.register_adapter"><code class="xref py py-func docutils literal notranslate"><span class="pre">register_adapter()</span></code></a> を使用して登録できます。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Point</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>

<span class="k">def</span> <span class="nf">adapt_point</span><span class="p">(</span><span class="n">point</span><span class="p">):</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">point</span><span class="o">.</span><span class="n">x</span><span class="si">}</span><span class="s2">;</span><span class="si">{</span><span class="n">point</span><span class="o">.</span><span class="n">y</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="n">sqlite3</span><span class="o">.</span><span class="n">register_adapter</span><span class="p">(</span><span class="n">Point</span><span class="p">,</span> <span class="n">adapt_point</span><span class="p">)</span>

<span class="n">con</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;:memory:&quot;</span><span class="p">)</span>
<span class="n">cur</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT ?&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">Point</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">),))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cur</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">con</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>
<section id="how-to-convert-sqlite-values-to-custom-python-types">
<span id="sqlite3-converters"></span><h3>SQLite 値をカスタム Python 型に変換する方法<a class="headerlink" href="sqlite3.html#how-to-convert-sqlite-values-to-custom-python-types" title="Link to this heading">¶</a></h3>
<p>適合関数(adapter)を使用すると、カスタム Python 型から SQLite 値に変換できます。SQLite 値 から カスタム Python 型に変換できるようにするためには、 <em>変換関数</em> (converters)を使用します。</p>
<p>それでは <code class="xref py py-class docutils literal notranslate"><span class="pre">Point</span></code> クラスの話に戻るとしましょう。 先程は x 座標と y 座標をセミコロンで区切られた文字列として SQLite に格納しました。</p>
<p>まず、 文字列をパラメーターとして受け取り、そこから <code class="xref py py-class docutils literal notranslate"><span class="pre">Point</span></code> オブジェクトを構築する変換関数を定義します。</p>
<div class="admonition note">
<p class="admonition-title">注釈</p>
<p>変換関数には、基になる SQLite データ型に関係なく、 <strong>常に</strong> <a class="reference internal" href="stdtypes.html#bytes" title="bytes"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></a> オブジェクトで渡されます。</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">convert_point</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;;&quot;</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p>与えられた SQLite 値をどの時点で変換すべきかを <code class="xref py py-mod docutils literal notranslate"><span class="pre">sqlite3</span></code> に伝える必要があります。これは、 <a class="reference internal" href="sqlite3.html#sqlite3.connect" title="sqlite3.connect"><code class="xref py py-func docutils literal notranslate"><span class="pre">connect()</span></code></a> の <em>detect_types</em> パラメータを使用して、データベースに接続する際に行います。 以下の 3 つの選択肢があります:</p>
<ul class="simple">
<li><p>暗黙的: <em>detect_types</em> に <a class="reference internal" href="sqlite3.html#sqlite3.PARSE_DECLTYPES" title="sqlite3.PARSE_DECLTYPES"><code class="xref py py-const docutils literal notranslate"><span class="pre">PARSE_DECLTYPES</span></code></a> と設定。</p></li>
<li><p>明示的: <em>detect_types</em> に <a class="reference internal" href="sqlite3.html#sqlite3.PARSE_COLNAMES" title="sqlite3.PARSE_COLNAMES"><code class="xref py py-const docutils literal notranslate"><span class="pre">PARSE_COLNAMES</span></code></a> と設定。</p></li>
<li><p>両方: <em>detect_types</em> に <code class="docutils literal notranslate"><span class="pre">sqlite3.PARSE_DECLTYPES</span> <span class="pre">|</span> <span class="pre">sqlite3.PARSE_COLNAMES</span></code> を設定。列名での指定は、宣言時の型よりも優先されます。</p></li>
</ul>
<p>以下の例では、暗黙的なアプローチと明示的なアプローチについて表しています:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Point</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Point(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="si">}</span><span class="s2">)&quot;</span>

<span class="k">def</span> <span class="nf">adapt_point</span><span class="p">(</span><span class="n">point</span><span class="p">):</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">point</span><span class="o">.</span><span class="n">x</span><span class="si">}</span><span class="s2">;</span><span class="si">{</span><span class="n">point</span><span class="o">.</span><span class="n">y</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="k">def</span> <span class="nf">convert_point</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;;&quot;</span><span class="p">)))</span>
    <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="c1"># Register the adapter and converter</span>
<span class="n">sqlite3</span><span class="o">.</span><span class="n">register_adapter</span><span class="p">(</span><span class="n">Point</span><span class="p">,</span> <span class="n">adapt_point</span><span class="p">)</span>
<span class="n">sqlite3</span><span class="o">.</span><span class="n">register_converter</span><span class="p">(</span><span class="s2">&quot;point&quot;</span><span class="p">,</span> <span class="n">convert_point</span><span class="p">)</span>

<span class="c1"># 1) Parse using declared types</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="mf">4.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.2</span><span class="p">)</span>
<span class="n">con</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;:memory:&quot;</span><span class="p">,</span> <span class="n">detect_types</span><span class="o">=</span><span class="n">sqlite3</span><span class="o">.</span><span class="n">PARSE_DECLTYPES</span><span class="p">)</span>
<span class="n">cur</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;CREATE TABLE test(p point)&quot;</span><span class="p">)</span>

<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;INSERT INTO test(p) VALUES(?)&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">p</span><span class="p">,))</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT p FROM test&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;with declared types:&quot;</span><span class="p">,</span> <span class="n">cur</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">cur</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">con</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="c1"># 2) Parse using column names</span>
<span class="n">con</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;:memory:&quot;</span><span class="p">,</span> <span class="n">detect_types</span><span class="o">=</span><span class="n">sqlite3</span><span class="o">.</span><span class="n">PARSE_COLNAMES</span><span class="p">)</span>
<span class="n">cur</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;CREATE TABLE test(p)&quot;</span><span class="p">)</span>

<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;INSERT INTO test(p) VALUES(?)&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">p</span><span class="p">,))</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;SELECT p AS &quot;p [point]&quot; FROM test&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;with column names:&quot;</span><span class="p">,</span> <span class="n">cur</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">cur</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">con</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="adapter-and-converter-recipes">
<span id="sqlite3-adapter-converter-recipes"></span><h3>適合関数と変換関数のレシピ集<a class="headerlink" href="sqlite3.html#adapter-and-converter-recipes" title="Link to this heading">¶</a></h3>
<p>この節では一般的な適合関数と変換関数のレシピを紹介します。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">sqlite3</span>

<span class="k">def</span> <span class="nf">adapt_date_iso</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adapt datetime.date to ISO 8601 date.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">val</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">adapt_datetime_iso</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adapt datetime.datetime to timezone-naive ISO 8601 date.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">val</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">adapt_datetime_epoch</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adapt datetime.datetime to Unix timestamp.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">val</span><span class="o">.</span><span class="n">timestamp</span><span class="p">())</span>

<span class="n">sqlite3</span><span class="o">.</span><span class="n">register_adapter</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">,</span> <span class="n">adapt_date_iso</span><span class="p">)</span>
<span class="n">sqlite3</span><span class="o">.</span><span class="n">register_adapter</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">,</span> <span class="n">adapt_datetime_iso</span><span class="p">)</span>
<span class="n">sqlite3</span><span class="o">.</span><span class="n">register_adapter</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">,</span> <span class="n">adapt_datetime_epoch</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">convert_date</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert ISO 8601 date to datetime.date object.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">fromisoformat</span><span class="p">(</span><span class="n">val</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>

<span class="k">def</span> <span class="nf">convert_datetime</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert ISO 8601 datetime to datetime.datetime object.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromisoformat</span><span class="p">(</span><span class="n">val</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>

<span class="k">def</span> <span class="nf">convert_timestamp</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert Unix epoch timestamp to datetime.datetime object.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>

<span class="n">sqlite3</span><span class="o">.</span><span class="n">register_converter</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="n">convert_date</span><span class="p">)</span>
<span class="n">sqlite3</span><span class="o">.</span><span class="n">register_converter</span><span class="p">(</span><span class="s2">&quot;datetime&quot;</span><span class="p">,</span> <span class="n">convert_datetime</span><span class="p">)</span>
<span class="n">sqlite3</span><span class="o">.</span><span class="n">register_converter</span><span class="p">(</span><span class="s2">&quot;timestamp&quot;</span><span class="p">,</span> <span class="n">convert_timestamp</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="how-to-use-connection-shortcut-methods">
<span id="sqlite3-connection-shortcuts"></span><h3>接続(connection)ショートカット・メソッドの使い方<a class="headerlink" href="sqlite3.html#how-to-use-connection-shortcut-methods" title="Link to this heading">¶</a></h3>
<p><a class="reference internal" href="sqlite3.html#sqlite3.Connection" title="sqlite3.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> クラスのメソッド <a class="reference internal" href="sqlite3.html#sqlite3.Connection.execute" title="sqlite3.Connection.execute"><code class="xref py py-meth docutils literal notranslate"><span class="pre">execute()</span></code></a> と <a class="reference internal" href="sqlite3.html#sqlite3.Connection.executemany" title="sqlite3.Connection.executemany"><code class="xref py py-meth docutils literal notranslate"><span class="pre">executemany()</span></code></a> と <a class="reference internal" href="sqlite3.html#sqlite3.Connection.executescript" title="sqlite3.Connection.executescript"><code class="xref py py-meth docutils literal notranslate"><span class="pre">executescript()</span></code></a> を使うことで、 (しばしば余計な) <a class="reference internal" href="sqlite3.html#sqlite3.Cursor" title="sqlite3.Cursor"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cursor</span></code></a> オブジェクトをわざわざ作り出さずに済むので、コードをより簡潔に書くことができます。 <a class="reference internal" href="sqlite3.html#sqlite3.Cursor" title="sqlite3.Cursor"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cursor</span></code></a> オブジェクトは暗黙裡に生成され、ショートカット・メソッドの戻り値として受け取ることができます。この方法を使えば、 <code class="docutils literal notranslate"><span class="pre">SELECT</span></code> 文を実行してその結果について反復することが、 <a class="reference internal" href="sqlite3.html#sqlite3.Connection" title="sqlite3.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> オブジェクトに対する呼び出し一つで行なえます。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create and fill the table.</span>
<span class="n">con</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;:memory:&quot;</span><span class="p">)</span>
<span class="n">con</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;CREATE TABLE lang(name, first_appeared)&quot;</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s2">&quot;C++&quot;</span><span class="p">,</span> <span class="mi">1985</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Objective-C&quot;</span><span class="p">,</span> <span class="mi">1984</span><span class="p">),</span>
<span class="p">]</span>
<span class="n">con</span><span class="o">.</span><span class="n">executemany</span><span class="p">(</span><span class="s2">&quot;INSERT INTO lang(name, first_appeared) VALUES(?, ?)&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

<span class="c1"># Print the table contents</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">con</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT name, first_appeared FROM lang&quot;</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;I just deleted&quot;</span><span class="p">,</span> <span class="n">con</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;DELETE FROM lang&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rowcount</span><span class="p">,</span> <span class="s2">&quot;rows&quot;</span><span class="p">)</span>

<span class="c1"># close() is not a shortcut method and it&#39;s not called automatically;</span>
<span class="c1"># the connection object should be closed manually</span>
<span class="n">con</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="how-to-use-the-connection-context-manager">
<span id="sqlite3-connection-context-manager"></span><h3>接続(connection)コンテキストマネージャの使い方<a class="headerlink" href="sqlite3.html#how-to-use-the-connection-context-manager" title="Link to this heading">¶</a></h3>
<p><a class="reference internal" href="sqlite3.html#sqlite3.Connection" title="sqlite3.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> オブジェクトは、コンテキスト・マネージャーとして使用でき、コンテキスト・マネージャーとして使用すると、 <a class="reference internal" href="../reference/compound_stmts.html#with"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">with</span></code></a> ブロックを離れるときに、開いているトランザクションを自動的にコミットまたはロールバックします。 <a class="reference internal" href="../reference/compound_stmts.html#with"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">with</span></code></a> 文のブロックが例外なく終了すると、トランザクションはコミットされます。このコミットが失敗した、または、 <code class="docutils literal notranslate"><span class="pre">with</span></code> 文のブロックでキャッチされなかった例外が発生した場合、トランザクションはロールバックされます。 <a class="reference internal" href="sqlite3.html#sqlite3.Connection.autocommit" title="sqlite3.Connection.autocommit"><code class="xref py py-attr docutils literal notranslate"><span class="pre">autocommit</span></code></a> が <code class="docutils literal notranslate"><span class="pre">False</span></code> の場合、コミット後またはロールバック後に新しいトランザクションが暗黙に開かれます。</p>
<p><code class="docutils literal notranslate"><span class="pre">with</span></code> 文のブロックを離れるときに開いているトランザクションがない、または、 <a class="reference internal" href="sqlite3.html#sqlite3.Connection.autocommit" title="sqlite3.Connection.autocommit"><code class="xref py py-attr docutils literal notranslate"><span class="pre">autocommit</span></code></a> が <code class="docutils literal notranslate"><span class="pre">True</span></code> の場合、コンテキスト・マネージャは何も行いません。</p>
<div class="admonition note">
<p class="admonition-title">注釈</p>
<p>The context manager neither implicitly opens a new transaction
nor closes the connection. If you need a closing context manager, consider
using <a class="reference internal" href="contextlib.html#contextlib.closing" title="contextlib.closing"><code class="xref py py-meth docutils literal notranslate"><span class="pre">contextlib.closing()</span></code></a>.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">con</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;:memory:&quot;</span><span class="p">)</span>
<span class="n">con</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;CREATE TABLE lang(id INTEGER PRIMARY KEY, name VARCHAR UNIQUE)&quot;</span><span class="p">)</span>

<span class="c1"># Successful, con.commit() is called automatically afterwards</span>
<span class="k">with</span> <span class="n">con</span><span class="p">:</span>
    <span class="n">con</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;INSERT INTO lang(name) VALUES(?)&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;Python&quot;</span><span class="p">,))</span>

<span class="c1"># con.rollback() is called after the with block finishes with an exception,</span>
<span class="c1"># the exception is still raised and must be caught</span>
<span class="k">try</span><span class="p">:</span>
    <span class="k">with</span> <span class="n">con</span><span class="p">:</span>
        <span class="n">con</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;INSERT INTO lang(name) VALUES(?)&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;Python&quot;</span><span class="p">,))</span>
<span class="k">except</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">IntegrityError</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;couldn&#39;t add Python twice&quot;</span><span class="p">)</span>

<span class="c1"># Connection object used as context manager only commits or rollbacks transactions,</span>
<span class="c1"># so the connection object should be closed manually</span>
<span class="n">con</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="how-to-work-with-sqlite-uris">
<span id="sqlite3-uri-tricks"></span><h3>SQLite URI の操作方法<a class="headerlink" href="sqlite3.html#how-to-work-with-sqlite-uris" title="Link to this heading">¶</a></h3>
<p>URI の小技をいくつか紹介します:</p>
<ul class="simple">
<li><p>データベースを読み取り専用で開きます:</p></li>
</ul>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">con</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;file:tutorial.db?mode=ro&quot;</span><span class="p">,</span> <span class="n">uri</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;CREATE TABLE readonly(data)&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="gr">OperationalError</span>: <span class="n">attempt to write a readonly database</span>
</pre></div>
</div>
<ul class="simple">
<li><p>まだ存在しない場合、新しいデータベース・ファイルを暗黙に作成しません。なお、新しいファイルが作成できない場合には <a class="reference internal" href="sqlite3.html#sqlite3.OperationalError" title="sqlite3.OperationalError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">OperationalError</span></code></a> が送出されます:</p></li>
</ul>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">con</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;file:nosuchdb.db?mode=rw&quot;</span><span class="p">,</span> <span class="n">uri</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="gr">OperationalError</span>: <span class="n">unable to open database file</span>
</pre></div>
</div>
<ul class="simple">
<li><p>共有の名前付きインメモリ・データベースを作成します:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">db</span> <span class="o">=</span> <span class="s2">&quot;file:mem1?mode=memory&amp;cache=shared&quot;</span>
<span class="n">con1</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="n">uri</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">con2</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="n">uri</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">with</span> <span class="n">con1</span><span class="p">:</span>
    <span class="n">con1</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;CREATE TABLE shared(data)&quot;</span><span class="p">)</span>
    <span class="n">con1</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;INSERT INTO shared VALUES(28)&quot;</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">con2</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT data FROM shared&quot;</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">res</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span> <span class="o">==</span> <span class="p">(</span><span class="mi">28</span><span class="p">,)</span>

<span class="n">con1</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">con2</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>パラメータのリストを含む、この機能の詳細については、 <a class="reference external" href="https://www.sqlite.org/uri.html">SQLite URI documentation</a> を参照してください。</p>
</section>
<section id="how-to-create-and-use-row-factories">
<span id="sqlite3-howto-row-factory"></span><h3>行工場(row factories)の作成方法と使用方法<a class="headerlink" href="sqlite3.html#how-to-create-and-use-row-factories" title="Link to this heading">¶</a></h3>
<p>デフォルトでは、 <code class="xref py py-mod docutils literal notranslate"><span class="pre">sqlite3</span></code> は各行(row)を <a class="reference internal" href="stdtypes.html#tuple" title="tuple"><code class="xref py py-class docutils literal notranslate"><span class="pre">タプル</span></code></a> として表します。 <code class="xref py py-class docutils literal notranslate"><span class="pre">タプル</span></code> があなたのニーズと合わない場合は、 <a class="reference internal" href="sqlite3.html#sqlite3.Row" title="sqlite3.Row"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlite3.Row</span></code></a> クラスまたはカスタム <a class="reference internal" href="sqlite3.html#sqlite3.Cursor.row_factory" title="sqlite3.Cursor.row_factory"><code class="xref py py-attr docutils literal notranslate"><span class="pre">row_factory</span></code></a> を使用できます。</p>
<p><code class="xref py py-attr docutils literal notranslate"><span class="pre">row_factory</span></code> は <a class="reference internal" href="sqlite3.html#sqlite3.Cursor" title="sqlite3.Cursor"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cursor</span></code></a> と <a class="reference internal" href="sqlite3.html#sqlite3.Connection" title="sqlite3.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> の両方に属性として存在しますが、 その接続(connection)から作成されたすべてのカーソルが同一の行工場(row factory)を使用するようにするために、 <a class="reference internal" href="sqlite3.html#sqlite3.Connection.row_factory" title="sqlite3.Connection.row_factory"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection.row_factory</span></code></a> を設定することをお勧めします。</p>
<p><code class="xref py py-class docutils literal notranslate"><span class="pre">Row</span></code> は、 <code class="xref py py-class docutils literal notranslate"><span class="pre">タプル</span></code> に対してメモリ・オーバーヘッドとパフォーマンスへの影響を最小限に抑えながら、列(row)へのインデックスによるアクセスと、列への(大文字と小文字を区別しない)名前によるアクセスを提供します。 <code class="xref py py-class docutils literal notranslate"><span class="pre">Row</span></code> を行工場(row factory)として使用するには、 <code class="xref py py-attr docutils literal notranslate"><span class="pre">row_factory</span></code> 属性に割り当てます:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">con</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;:memory:&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span><span class="o">.</span><span class="n">row_factory</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">Row</span>
</pre></div>
</div>
<p>このように設定すると、クエリは :class:<a href="sqlite3.html#id1"><span class="problematic" id="id2">`</span></a>!Row`オブジェクトを返すようになります:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT &#39;Earth&#39; AS name, 6378 AS radius&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">row</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">row</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="go">[&#39;name&#39;, &#39;radius&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>         <span class="c1"># Access by index.</span>
<span class="go">&#39;Earth&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>    <span class="c1"># Access by name.</span>
<span class="go">&#39;Earth&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;RADIUS&quot;</span><span class="p">]</span>  <span class="c1"># Column names are case-insensitive.</span>
<span class="go">6378</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">注釈</p>
<p>The <code class="docutils literal notranslate"><span class="pre">FROM</span></code> clause can be omitted in the <code class="docutils literal notranslate"><span class="pre">SELECT</span></code> statement, as in the
above example. In such cases, SQLite returns a single row with columns
defined by expressions, e.g. literals, with the given aliases
<code class="docutils literal notranslate"><span class="pre">expr</span> <span class="pre">AS</span> <span class="pre">alias</span></code>.</p>
</div>
<p>各列名が各値にマップされた <a class="reference internal" href="stdtypes.html#dict" title="dict"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> として行を返す、カスタム <a class="reference internal" href="sqlite3.html#sqlite3.Cursor.row_factory" title="sqlite3.Cursor.row_factory"><code class="xref py py-attr docutils literal notranslate"><span class="pre">row_factory</span></code></a> を作成することもできます:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">dict_factory</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="n">row</span><span class="p">):</span>
    <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="n">column</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">cursor</span><span class="o">.</span><span class="n">description</span><span class="p">]</span>
    <span class="k">return</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="n">value</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span> <span class="n">row</span><span class="p">)}</span>
</pre></div>
</div>
<p>これを使うと、クエリは <code class="xref py py-class docutils literal notranslate"><span class="pre">タプル</span></code> の代わりに <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code> を返すようになります:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">con</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;:memory:&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span><span class="o">.</span><span class="n">row_factory</span> <span class="o">=</span> <span class="n">dict_factory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">con</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT 1 AS a, 2 AS b&quot;</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
<span class="go">{&#39;a&#39;: 1, &#39;b&#39;: 2}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>以下の行工場(row factory)は <a class="reference internal" href="../glossary.html#term-named-tuple"><span class="xref std std-term">名前付きタプル</span></a> を返します:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">namedtuple</span>

<span class="k">def</span> <span class="nf">namedtuple_factory</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="n">row</span><span class="p">):</span>
    <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="n">column</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">cursor</span><span class="o">.</span><span class="n">description</span><span class="p">]</span>
    <span class="bp">cls</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s2">&quot;Row&quot;</span><span class="p">,</span> <span class="n">fields</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_make</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="xref py py-func docutils literal notranslate"><span class="pre">namedtuple_factory()</span></code> は以下のようにして使う事ができます:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">con</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;:memory:&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span><span class="o">.</span><span class="n">row_factory</span> <span class="o">=</span> <span class="n">namedtuple_factory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cur</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT 1 AS a, 2 AS b&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">row</span> <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">row</span>
<span class="go">Row(a=1, b=2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Indexed access.</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">row</span><span class="o">.</span><span class="n">b</span>   <span class="c1"># Attribute access.</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>上記レシピをチューニングすれば、 <a class="reference internal" href="collections.html#collections.namedtuple" title="collections.namedtuple"><code class="xref py py-class docutils literal notranslate"><span class="pre">namedtuple</span></code></a> の代わりに <a class="reference internal" href="dataclasses.html#dataclasses.dataclass" title="dataclasses.dataclass"><code class="xref py py-class docutils literal notranslate"><span class="pre">dataclass</span></code></a> または、その他のカスタム・クラスを使用するように適合(adapt)させることができます。</p>
</section>
<section id="how-to-handle-non-utf-8-text-encodings">
<span id="sqlite3-howto-encoding"></span><h3>How to handle non-UTF-8 text encodings<a class="headerlink" href="sqlite3.html#how-to-handle-non-utf-8-text-encodings" title="Link to this heading">¶</a></h3>
<p>By default, <code class="xref py py-mod docutils literal notranslate"><span class="pre">sqlite3</span></code> uses <a class="reference internal" href="stdtypes.html#str" title="str"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> to adapt SQLite values
with the <code class="docutils literal notranslate"><span class="pre">TEXT</span></code> data type.
This works well for UTF-8 encoded text, but it might fail for other encodings
and invalid UTF-8.
You can use a custom <a class="reference internal" href="sqlite3.html#sqlite3.Connection.text_factory" title="sqlite3.Connection.text_factory"><code class="xref py py-attr docutils literal notranslate"><span class="pre">text_factory</span></code></a> to handle such cases.</p>
<p>Because of SQLite's <a class="reference external" href="https://www.sqlite.org/flextypegood.html">flexible typing</a>, it is not uncommon to encounter table
columns with the <code class="docutils literal notranslate"><span class="pre">TEXT</span></code> data type containing non-UTF-8 encodings,
or even arbitrary data.
To demonstrate, let's assume we have a database with ISO-8859-2 (Latin-2)
encoded text, for example a table of Czech-English dictionary entries.
Assuming we now have a <a class="reference internal" href="sqlite3.html#sqlite3.Connection" title="sqlite3.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> instance <code class="xref py py-data docutils literal notranslate"><span class="pre">con</span></code>
connected to this database,
we can decode the Latin-2 encoded text using this <a class="reference internal" href="sqlite3.html#sqlite3.Connection.text_factory" title="sqlite3.Connection.text_factory"><code class="xref py py-attr docutils literal notranslate"><span class="pre">text_factory</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">con</span><span class="o">.</span><span class="n">text_factory</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;latin2&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>For invalid UTF-8 or arbitrary data in stored in <code class="docutils literal notranslate"><span class="pre">TEXT</span></code> table columns,
you can use the following technique, borrowed from the <a class="reference internal" href="../howto/unicode.html#unicode-howto"><span class="std std-ref">Unicode HOWTO</span></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">con</span><span class="o">.</span><span class="n">text_factory</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;surrogateescape&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">注釈</p>
<p>The <code class="xref py py-mod docutils literal notranslate"><span class="pre">sqlite3</span></code> module API does not support strings
containing surrogates.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">参考</p>
<p><a class="reference internal" href="../howto/unicode.html#unicode-howto"><span class="std std-ref">Unicode HOWTO</span></a></p>
</div>
</section>
</section>
<section id="explanation">
<span id="sqlite3-explanation"></span><h2>説明<a class="headerlink" href="sqlite3.html#explanation" title="Link to this heading">¶</a></h2>
<section id="transaction-control">
<span id="sqlite3-controlling-transactions"></span><span id="sqlite3-transaction-control"></span><h3>トランザクション制御<a class="headerlink" href="sqlite3.html#transaction-control" title="Link to this heading">¶</a></h3>
<p><code class="xref py py-mod docutils literal notranslate"><span class="pre">sqlite3</span></code> は、データベース・トランザクションを開くかどうか、いつ、どのように開くかを制御する複数の方法を提供します。 <a class="reference internal" href="sqlite3.html#sqlite3-transaction-control-autocommit"><span class="std std-ref">autocommit 属性に依るトランザクション制御</span></a> が推奨されますが、<a class="reference internal" href="sqlite3.html#sqlite3-transaction-control-isolation-level"><span class="std std-ref">isolation_level 属性に依るトランザクション制御</span></a> は Python 3.12 より前の動作を保持します。</p>
<section id="transaction-control-via-the-autocommit-attribute">
<span id="sqlite3-transaction-control-autocommit"></span><h4><code class="docutils literal notranslate"><span class="pre">autocommit</span></code> 属性に依るトランザクション制御<a class="headerlink" href="sqlite3.html#transaction-control-via-the-autocommit-attribute" title="Link to this heading">¶</a></h4>
<p>トランザクションの動作を制御する推奨方法は、 <a class="reference internal" href="sqlite3.html#sqlite3.Connection.autocommit" title="sqlite3.Connection.autocommit"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Connection.autocommit</span></code></a> 属性を使用することです。 この属性は <a class="reference internal" href="sqlite3.html#sqlite3.connect" title="sqlite3.connect"><code class="xref py py-func docutils literal notranslate"><span class="pre">connect()</span></code></a> の <em>autocommit</em> パラメータを使用して設定して頂けるとありがたいです。</p>
<p><em>autocommit</em> を <code class="docutils literal notranslate"><span class="pre">False</span></code> に設定することをお勧めします。そうすると <span class="target" id="index-27"></span><a class="pep reference external" href="https://peps.python.org/pep-0249/"><strong>PEP 249</strong></a> 対応のトランザクション制御を行います。これは以下のことを意味します:</p>
<ul class="simple">
<li><p><code class="xref py py-mod docutils literal notranslate"><span class="pre">sqlite3</span></code> はトランザクションが常に開いていることを保証します。そのため、 <a class="reference internal" href="sqlite3.html#sqlite3.connect" title="sqlite3.connect"><code class="xref py py-func docutils literal notranslate"><span class="pre">connect()</span></code></a> や <a class="reference internal" href="sqlite3.html#sqlite3.Connection.commit" title="sqlite3.Connection.commit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Connection.commit()</span></code></a> や <a class="reference internal" href="sqlite3.html#sqlite3.Connection.rollback" title="sqlite3.Connection.rollback"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Connection.rollback()</span></code></a> は暗黙に新しいトランザクションを開きます(1つ目については保留中のトランザクションを閉じた直後で、後の2つについてはその直後に、です)。 <code class="xref py py-mod docutils literal notranslate"><span class="pre">sqlite3</span></code> はトランザクションを開くときに <code class="docutils literal notranslate"><span class="pre">BEGIN</span> <span class="pre">DEFERRED</span></code> 文を使用します。</p></li>
<li><p>トランザクションは、 <code class="xref py py-meth docutils literal notranslate"><span class="pre">commit()</span></code> を使用して明示的にコミットする必要があります。</p></li>
<li><p>トランザクションは、 <code class="xref py py-meth docutils literal notranslate"><span class="pre">rollback()</span></code> を使用して明示的にロールバックする必要があります。</p></li>
<li><p>データベースの保留中に行った変更は <a class="reference internal" href="sqlite3.html#sqlite3.Connection.close" title="sqlite3.Connection.close"><code class="xref py py-meth docutils literal notranslate"><span class="pre">close()</span></code></a> された場合、暗黙のロールバックが実行されます。</p></li>
</ul>
<p><em>autocommit</em> を <code class="docutils literal notranslate"><span class="pre">True</span></code> に設定して、SQLite の <a class="reference external" href="https://www.sqlite.org/lang_transaction.html#implicit_versus_explicit_transactions">autocommit mode</a> を有効にします。このモードでは、 <a class="reference internal" href="sqlite3.html#sqlite3.Connection.commit" title="sqlite3.Connection.commit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Connection.commit()</span></code></a> と <a class="reference internal" href="sqlite3.html#sqlite3.Connection.rollback" title="sqlite3.Connection.rollback"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Connection.rollback()</span></code></a> は効果がありません。 SQLite の自動コミット・モード(autocommit mode)は、 <span class="target" id="index-28"></span><a class="pep reference external" href="https://peps.python.org/pep-0249/"><strong>PEP 249</strong></a> 対応の <a class="reference internal" href="sqlite3.html#sqlite3.Connection.autocommit" title="sqlite3.Connection.autocommit"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Connection.autocommit</span></code></a> 属性とは異なることに注意してください。 <a class="reference internal" href="sqlite3.html#sqlite3.Connection.in_transaction" title="sqlite3.Connection.in_transaction"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Connection.in_transaction</span></code></a> を使用して、低レベル SQLite 自動コミット・モードを問い合わせします。</p>
<p><em>autocommit</em> を <a class="reference internal" href="sqlite3.html#sqlite3.LEGACY_TRANSACTION_CONTROL" title="sqlite3.LEGACY_TRANSACTION_CONTROL"><code class="xref py py-data docutils literal notranslate"><span class="pre">LEGACY_TRANSACTION_CONTROL</span></code></a> に設定して、トランザクション制御の振る舞いを <a class="reference internal" href="sqlite3.html#sqlite3.Connection.isolation_level" title="sqlite3.Connection.isolation_level"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Connection.isolation_level</span></code></a> 属性に任せます。詳細については <a class="reference internal" href="sqlite3.html#sqlite3-transaction-control-isolation-level"><span class="std std-ref">isolation_level 属性に依るトランザクション制御</span></a> を参照してください。</p>
</section>
<section id="transaction-control-via-the-isolation-level-attribute">
<span id="sqlite3-transaction-control-isolation-level"></span><h4><code class="docutils literal notranslate"><span class="pre">isolation_level</span></code> 属性に依るトランザクション制御<a class="headerlink" href="sqlite3.html#transaction-control-via-the-isolation-level-attribute" title="Link to this heading">¶</a></h4>
<div class="admonition note">
<p class="admonition-title">注釈</p>
<p>推奨のトランザクション制御方法は、 <a class="reference internal" href="sqlite3.html#sqlite3.Connection.autocommit" title="sqlite3.Connection.autocommit"><code class="xref py py-attr docutils literal notranslate"><span class="pre">autocommit</span></code></a> 属性を使用することです。 <a class="reference internal" href="sqlite3.html#sqlite3-transaction-control-autocommit"><span class="std std-ref">autocommit 属性に依るトランザクション制御</span></a> を参照してください。</p>
</div>
<p><a class="reference internal" href="sqlite3.html#sqlite3.Connection.autocommit" title="sqlite3.Connection.autocommit"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Connection.autocommit</span></code></a> が <a class="reference internal" href="sqlite3.html#sqlite3.LEGACY_TRANSACTION_CONTROL" title="sqlite3.LEGACY_TRANSACTION_CONTROL"><code class="xref py py-data docutils literal notranslate"><span class="pre">LEGACY_TRANSACTION_CONTROL</span></code></a> (これがデフォルトです)に設定されている場合、トランザクションの振る舞いは <a class="reference internal" href="sqlite3.html#sqlite3.Connection.isolation_level" title="sqlite3.Connection.isolation_level"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Connection.isolation_level</span></code></a> 属性を使用して制御されます。 <a class="reference internal" href="sqlite3.html#sqlite3.LEGACY_TRANSACTION_CONTROL" title="sqlite3.LEGACY_TRANSACTION_CONTROL"><code class="xref py py-data docutils literal notranslate"><span class="pre">LEGACY_TRANSACTION_CONTROL</span></code></a> 以外の場合、 <code class="xref py py-attr docutils literal notranslate"><span class="pre">isolation_level</span></code> は効果がありません。</p>
<p>接続属性 <a class="reference internal" href="sqlite3.html#sqlite3.Connection.isolation_level" title="sqlite3.Connection.isolation_level"><code class="xref py py-attr docutils literal notranslate"><span class="pre">isolation_level</span></code></a> が <code class="docutils literal notranslate"><span class="pre">None</span></code> で無いのなら、 <a class="reference internal" href="sqlite3.html#sqlite3.Cursor.execute" title="sqlite3.Cursor.execute"><code class="xref py py-meth docutils literal notranslate"><span class="pre">execute()</span></code></a> や <a class="reference internal" href="sqlite3.html#sqlite3.Cursor.executemany" title="sqlite3.Cursor.executemany"><code class="xref py py-meth docutils literal notranslate"><span class="pre">executemany()</span></code></a> が  <code class="docutils literal notranslate"><span class="pre">INSERT</span></code> または <code class="docutils literal notranslate"><span class="pre">UPDATE</span></code> または <code class="docutils literal notranslate"><span class="pre">DELETE</span></code> または <code class="docutils literal notranslate"><span class="pre">REPLACE</span></code> 文を実行する前に新しいトランザクションが暗黙に開かれます。それ以外のSQL文では暗黙のトランザクション処理は行われません。 <a class="reference internal" href="sqlite3.html#sqlite3.Connection.commit" title="sqlite3.Connection.commit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">commit()</span></code></a> メソッドや <a class="reference internal" href="sqlite3.html#sqlite3.Connection.rollback" title="sqlite3.Connection.rollback"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rollback()</span></code></a> メソッドを使用して、 保留中のトランザクションをそれぞれコミットおよびロールバックします。あなたは、背後にある SQLite ライブラリのトランザクションの振る舞い(<a class="reference external" href="https://www.sqlite.org/lang_transaction.html#deferred_immediate_and_exclusive_transactions">SQLite transaction behaviour</a>) — つまり、 sqlite3 が暗黙に実行する <code class="docutils literal notranslate"><span class="pre">BEGIN</span></code> 文の有無とその種類 – を、 <a class="reference internal" href="sqlite3.html#sqlite3.Connection.isolation_level" title="sqlite3.Connection.isolation_level"><code class="xref py py-attr docutils literal notranslate"><span class="pre">isolation_level</span></code></a> 属性を介して選択できます。</p>
<p><a class="reference internal" href="sqlite3.html#sqlite3.Connection.isolation_level" title="sqlite3.Connection.isolation_level"><code class="xref py py-attr docutils literal notranslate"><span class="pre">isolation_level</span></code></a> が <code class="docutils literal notranslate"><span class="pre">None</span></code> に設定されていると、トランザクションは暗黙に開かれません。これにより、背後にある SQLite ライブラリを自動コミット・モード(<a class="reference external" href="https://www.sqlite.org/lang_transaction.html#implicit_versus_explicit_transactions">autocommit mode</a>)にしたまま、 明示的な SQL 文を使用して、 ユーザが独自のトランザクション処理を行えるようにします。背後にある SQLite ライブラリの自動コミット・モードは、 <a class="reference internal" href="sqlite3.html#sqlite3.Connection.in_transaction" title="sqlite3.Connection.in_transaction"><code class="xref py py-attr docutils literal notranslate"><span class="pre">in_transaction</span></code></a> 属性を使用して問い合わせできます。</p>
<p><a class="reference internal" href="sqlite3.html#sqlite3.Cursor.executescript" title="sqlite3.Cursor.executescript"><code class="xref py py-meth docutils literal notranslate"><span class="pre">executescript()</span></code></a> メソッドは、 <a class="reference internal" href="sqlite3.html#sqlite3.Connection.isolation_level" title="sqlite3.Connection.isolation_level"><code class="xref py py-attr docutils literal notranslate"><span class="pre">isolation_level</span></code></a> の値に関係なく、与えられた SQL スクリプトの実行前に、保留中のトランザクションを暗黙にコミットします。</p>
<div class="versionchanged">
<p><span class="versionmodified changed">バージョン 3.6 で変更: </span><code class="xref py py-mod docutils literal notranslate"><span class="pre">sqlite3</span></code> は、 DDL文の前に、開いているトランザクションを暗黙にコミットしていました。これはもはや当てはまりません。</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">バージョン 3.12 で変更: </span>推奨のトランザクションを制御方法は、 <a class="reference internal" href="sqlite3.html#sqlite3.Connection.autocommit" title="sqlite3.Connection.autocommit"><code class="xref py py-attr docutils literal notranslate"><span class="pre">autocommit</span></code></a> 属性を使用することです。</p>
</div>
</section>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../contents.html">目次</a></h3>
    <ul>
<li><a class="reference internal" href="sqlite3.html#"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sqlite3</span></code> --- SQLite データベース用の DB-API 2.0 インターフェース</a><ul>
<li><a class="reference internal" href="sqlite3.html#tutorial">チュートリアル</a></li>
<li><a class="reference internal" href="sqlite3.html#reference">リファレンス</a><ul>
<li><a class="reference internal" href="sqlite3.html#module-functions">モジュール関数</a></li>
<li><a class="reference internal" href="sqlite3.html#module-constants">モジュール定数</a></li>
<li><a class="reference internal" href="sqlite3.html#connection-objects">Connection オブジェクト</a></li>
<li><a class="reference internal" href="sqlite3.html#cursor-objects">Cursor オブジェクト</a></li>
<li><a class="reference internal" href="sqlite3.html#row-objects">Row オブジェクト</a></li>
<li><a class="reference internal" href="sqlite3.html#blob-objects">Blob オブジェクト</a></li>
<li><a class="reference internal" href="sqlite3.html#prepareprotocol-objects">PrepareProtocol オブジェクト</a></li>
<li><a class="reference internal" href="sqlite3.html#exceptions">例外</a></li>
<li><a class="reference internal" href="sqlite3.html#sqlite-and-python-types">SQLite と Python の型</a></li>
<li><a class="reference internal" href="sqlite3.html#default-adapters-and-converters-deprecated">デフォルトの適合関数(adapters)とデフォルトの変換関数(converters)(非推奨)</a></li>
<li><a class="reference internal" href="sqlite3.html#command-line-interface">コマンドライン・インターフェース</a></li>
</ul>
</li>
<li><a class="reference internal" href="sqlite3.html#how-to-guides">ハウツー・ガイド</a><ul>
<li><a class="reference internal" href="sqlite3.html#how-to-use-placeholders-to-bind-values-in-sql-queries">プレースホルダを使用して SQL クエリに値を結び付ける方法</a></li>
<li><a class="reference internal" href="sqlite3.html#how-to-adapt-custom-python-types-to-sqlite-values">カスタム Python 型を SQLite 値に適合させる方法</a><ul>
<li><a class="reference internal" href="sqlite3.html#how-to-write-adaptable-objects">適合可能オブジェクトの書き方</a></li>
<li><a class="reference internal" href="sqlite3.html#how-to-register-adapter-callables">適合用呼び出し可能オブジェクト(adapter callables)の登録方法</a></li>
</ul>
</li>
<li><a class="reference internal" href="sqlite3.html#how-to-convert-sqlite-values-to-custom-python-types">SQLite 値をカスタム Python 型に変換する方法</a></li>
<li><a class="reference internal" href="sqlite3.html#adapter-and-converter-recipes">適合関数と変換関数のレシピ集</a></li>
<li><a class="reference internal" href="sqlite3.html#how-to-use-connection-shortcut-methods">接続(connection)ショートカット・メソッドの使い方</a></li>
<li><a class="reference internal" href="sqlite3.html#how-to-use-the-connection-context-manager">接続(connection)コンテキストマネージャの使い方</a></li>
<li><a class="reference internal" href="sqlite3.html#how-to-work-with-sqlite-uris">SQLite URI の操作方法</a></li>
<li><a class="reference internal" href="sqlite3.html#how-to-create-and-use-row-factories">行工場(row factories)の作成方法と使用方法</a></li>
<li><a class="reference internal" href="sqlite3.html#how-to-handle-non-utf-8-text-encodings">How to handle non-UTF-8 text encodings</a></li>
</ul>
</li>
<li><a class="reference internal" href="sqlite3.html#explanation">説明</a><ul>
<li><a class="reference internal" href="sqlite3.html#transaction-control">トランザクション制御</a><ul>
<li><a class="reference internal" href="sqlite3.html#transaction-control-via-the-autocommit-attribute"><code class="docutils literal notranslate"><span class="pre">autocommit</span></code> 属性に依るトランザクション制御</a></li>
<li><a class="reference internal" href="sqlite3.html#transaction-control-via-the-isolation-level-attribute"><code class="docutils literal notranslate"><span class="pre">isolation_level</span></code> 属性に依るトランザクション制御</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>前のトピックへ</h4>
    <p class="topless"><a href="dbm.html"
                          title="前の章へ"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dbm</span></code> --- Unix &quot;データベース&quot; へのインターフェース</a></p>
  </div>
  <div>
    <h4>次のトピックへ</h4>
    <p class="topless"><a href="archiving.html"
                          title="次の章へ">データ圧縮とアーカイブ</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>このページ</h3>
    <ul class="this-page-menu">
      <li><a href="../bugs.html">バグ報告</a></li>
      <li>
        <a href="https://github.com/python/cpython/blob/main/Doc/library/sqlite3.rst"
            rel="nofollow">ソースの表示
        </a>
      </li>
    </ul>
  </div>
        </div>
<div id="sidebarbutton" title="サイドバーをたたむ">
<span>«</span>
</div>

      </div>
      <div class="clearer"></div>
    </div>  
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="総合索引"
             >索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Pythonモジュール索引"
             >モジュール</a> |</li>
        <li class="right" >
          <a href="archiving.html" title="データ圧縮とアーカイブ"
             >次へ</a> |</li>
        <li class="right" >
          <a href="dbm.html" title="dbm --- Unix &#34;データベース&#34; へのインターフェース"
             >前へ</a> |</li>

          <li><img src="../_static/py.svg" alt="Python logo" style="vertical-align: middle; margin-top: -1px"/></li>
          <li><a href="https://www.python.org/">Python</a> &#187;</li>
          <li class="switchers">
            <div class="language_switcher_placeholder"></div>
            <div class="version_switcher_placeholder"></div>
          </li>
          <li>
              
          </li>
    <li id="cpython-language-and-version">
      <a href="../index.html">3.12.4 Documentation</a> &#187;
    </li>

          <li class="nav-item nav-item-1"><a href="index.html" >Python 標準ライブラリ</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="persistence.html" >データの永続化</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="sqlite3.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sqlite3</span></code> --- SQLite データベース用の DB-API 2.0 インターフェース</a></li>
                <li class="right">
                    

    <div class="inline-search" role="search">
        <form class="inline-search" action="../search.html" method="get">
          <input placeholder="クイック検索" aria-label="クイック検索" type="search" name="q" id="search-box" />
          <input type="submit" value="検索" />
        </form>
    </div>
                     |
                </li>
            <li class="right">
<label class="theme-selector-label">
    Theme
    <select class="theme-selector" oninput="activateTheme(this.value)">
        <option value="auto" selected>Auto</option>
        <option value="light">Light</option>
        <option value="dark">Dark</option>
    </select>
</label> |</li>
            
      </ul>
    </div>  
    <div class="footer">
    &copy; 
      <a href="../copyright.html">
    
    Copyright
    
      </a>
     2001-2024, Python Software Foundation.
    <br />
    This page is licensed under the Python Software Foundation License Version 2.
    <br />
    Examples, recipes, and other code in the documentation are additionally licensed under the Zero Clause BSD License.
    <br />
    
      See <a href="../../../license.html">History and License</a> for more information.<br />
    
    
    <br />

    The Python Software Foundation is a non-profit corporation.
<a href="https://www.python.org/psf/donations/">Please donate.</a>
<br />
    <br />
      最終更新: Jun 11, 2024 (04:44 UTC)
    
      <a href="../../../bugs.html">Found a bug</a>?
    
    <br />

    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.3.7.
    </div>

    <script type="text/javascript" src="../_static/switchers.js"></script>
  </body>
</html>