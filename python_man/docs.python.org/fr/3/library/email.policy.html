<!DOCTYPE html>

<html lang="fr" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="email.policy: Policy Objects" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://docs.python.org/3/library/email.policy.html" />
<meta property="og:site_name" content="Python documentation" />
<meta property="og:description" content="Code source : Lib/email/policy.py Le principal objectif du paquet email est la gestion des messages électroniques comme décrit par les diverses RFC de messagerie et MIME. Cependant, le format génér..." />
<meta property="og:image" content="https://docs.python.org/3/_static/og-image.png" />
<meta property="og:image:alt" content="Python documentation" />
<meta name="description" content="Code source : Lib/email/policy.py Le principal objectif du paquet email est la gestion des messages électroniques comme décrit par les diverses RFC de messagerie et MIME. Cependant, le format génér..." />
<meta property="og:image:width" content="200" />
<meta property="og:image:height" content="200" />
<meta name="theme-color" content="#3776ab" />

    <title>email.policy: Policy Objects &#8212; Documentation Python 3.12.4</title><meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css%3Fv=80d5e7a1.css" />
    <link rel="stylesheet" type="text/css" href="../_static/pydoctheme.css%3Fv=bb723527.css" />
    <link id="pygments_dark_css" media="(prefers-color-scheme: dark)" rel="stylesheet" type="text/css" href="../_static/pygments_dark.css%3Fv=b20cc3f5.css" />
    
    <script src="../_static/documentation_options.js%3Fv=6f87fcbb"></script>
    <script src="../_static/doctools.js%3Fv=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js%3Fv=dc90522c"></script>
    <script src="../_static/translations.js%3Fv=bf059b8c"></script>
    
    <script src="../_static/sidebar.js"></script>
    
    <link rel="search" type="application/opensearchdescription+xml"
          title="Recherchez dans Documentation Python 3.12.4"
          href="../_static/opensearch.xml"/>
    <link rel="author" title="À propos de ces documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Recherche" href="../search.html" />
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="next" title="email.errors: Exception and Defect classes" href="email.errors.html" />
    <link rel="prev" title="email.generator: Generating MIME documents" href="email.generator.html" />
    
      <script defer data-domain="docs.python.org" src="https://plausible.io/js/script.js"></script>
    
    <link rel="canonical" href="../../../3/library/email.policy.html" />
    
      
    

    
    <style>
      @media only screen {
        table.full-width-table {
            width: 100%;
        }
      }
    </style>
<link rel="stylesheet" href="../_static/pydoctheme_dark.css" media="(prefers-color-scheme: dark)" id="pydoctheme_dark_css">
    <link rel="shortcut icon" type="image/png" href="../_static/py.svg" />
            <script type="text/javascript" src="../_static/copybutton.js"></script>
            <script type="text/javascript" src="../_static/menu.js"></script>
            <script type="text/javascript" src="../_static/search-focus.js"></script>
            <script type="text/javascript" src="../_static/themetoggle.js"></script> 
<meta name="readthedocs-addons-api-version" content="1">
<script type="text/javascript">
 function onSwitch(event) {
     const option = event.target.selectedIndex;
     const item = event.target.options[option];
     window.location.href = item.dataset.url;
 }

 document.addEventListener("readthedocs-addons-data-ready", function(event) {
   const config = event.detail.data()

   // Add some mocked hardcoded versions pointing to the official
   // documentation while migrating to Read the Docs.
   // These are only for testing purposes.
   // TODO: remove them when managing all the versions on Read the Docs,
   // since all the "active, built and not hidden" versions will be shown automatically.
   let versions = config.versions.active.concat([
       {
           slug: "dev (3.13)",
           urls: {
               documentation: "https://docs.python.org/3.13/",
           }
       },
       {
           slug: "3.12",
           urls: {
               documentation: "https://docs.python.org/3.12/",
           }
       },
       {
           slug: "3.11",
           urls: {
               documentation: "https://docs.python.org/3.11/",
           }
       },
   ]);

   const versionSelect = `
   <select id="version_select">
   ${ versions.map(
       (version) => `
       <option
           value="${ version.slug }"
           ${ config.versions.current.slug === version.slug ? 'selected="selected"' : '' }
           data-url="${ version.urls.documentation }">
           ${ version.slug }
       </option>`
   ).join("\n") }
   </select>
   `;

   // Prepend the current language to the options on the selector
   let languages = config.projects.translations.concat(config.projects.current);
   languages = languages.sort((a, b) => a.language.name.localeCompare(b.language.name));

   const languageSelect = `
   <select id="language_select">
   ${ languages.map(
       (translation) => `
       <option
           value="${ translation.slug }"
           ${ config.projects.current.slug === translation.slug ? 'selected="selected"' : '' }
           data-url="${ translation.urls.documentation }">
           ${ translation.language.name }
       </option>`
   ).join("\n") }
   </select>
   `;

   // Query all the placeholders because there are different ones for Desktop/Mobile
   const versionPlaceholders = document.querySelectorAll(".version_switcher_placeholder");
   for (placeholder of versionPlaceholders) {
       placeholder.innerHTML = versionSelect;
       let selectElement = placeholder.querySelector("select");
       selectElement.addEventListener("change", onSwitch);
   }

   const languagePlaceholders = document.querySelectorAll(".language_switcher_placeholder");
   for (placeholder of languagePlaceholders) {
       placeholder.innerHTML = languageSelect;
       let selectElement = placeholder.querySelector("select");
       selectElement.addEventListener("change", onSwitch);
   }
 });
</script>

  </head>
<body>
<div class="mobile-nav">
    <input type="checkbox" id="menuToggler" class="toggler__input" aria-controls="navigation"
           aria-pressed="false" aria-expanded="false" role="button" aria-label="Menu" />
    <nav class="nav-content" role="navigation">
        <label for="menuToggler" class="toggler__label">
            <span></span>
        </label>
        <span class="nav-items-wrapper">
            <a href="https://www.python.org/" class="nav-logo">
                <img src="../_static/py.svg" alt="Python logo"/>
            </a>
            <span class="version_switcher_placeholder"></span>
            <form role="search" class="search" action="../search.html" method="get">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" class="search-icon">
                    <path fill-rule="nonzero" fill="currentColor" d="M15.5 14h-.79l-.28-.27a6.5 6.5 0 001.48-5.34c-.47-2.78-2.79-5-5.59-5.34a6.505 6.505 0 00-7.27 7.27c.34 2.8 2.56 5.12 5.34 5.59a6.5 6.5 0 005.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0 .41-.41.41-1.08 0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path>
                </svg>
                <input placeholder="Recherche rapide" aria-label="Recherche rapide" type="search" name="q" />
                <input type="submit" value="Go"/>
            </form>
        </span>
    </nav>
    <div class="menu-wrapper">
        <nav class="menu" role="navigation" aria-label="main navigation">
            <div class="language_switcher_placeholder"></div>
            
<label class="theme-selector-label">
    Theme
    <select class="theme-selector" oninput="activateTheme(this.value)">
        <option value="auto" selected>Auto</option>
        <option value="light">Light</option>
        <option value="dark">Dark</option>
    </select>
</label>
  <div>
    <h4>Sujet précédent</h4>
    <p class="topless"><a href="email.generator.html"
                          title="Chapitre précédent"><code class="xref py py-mod docutils literal notranslate"><span class="pre">email.generator</span></code>: Generating MIME documents</a></p>
  </div>
  <div>
    <h4>Sujet suivant</h4>
    <p class="topless"><a href="email.errors.html"
                          title="Chapitre suivant"><code class="xref py py-mod docutils literal notranslate"><span class="pre">email.errors</span></code>: Exception and Defect classes</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>Cette page</h3>
    <ul class="this-page-menu">
      <li><a href="../bugs.html">Signalement de bogue</a></li>
      <li>
        <a href="https://github.com/python/cpython/blob/main/Doc/library/email.policy.rst"
            rel="nofollow">Voir la source
        </a>
      </li>
    </ul>
  </div>
        </nav>
    </div>
</div>

  
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="Index général"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Index des modules Python"
             >modules</a> |</li>
        <li class="right" >
          <a href="email.errors.html" title="email.errors: Exception and Defect classes"
             accesskey="N">suivant</a> |</li>
        <li class="right" >
          <a href="email.generator.html" title="email.generator: Generating MIME documents"
             accesskey="P">précédent</a> |</li>

          <li><img src="../_static/py.svg" alt="Python logo" style="vertical-align: middle; margin-top: -1px"/></li>
          <li><a href="https://www.python.org/">Python</a> &#187;</li>
          <li class="switchers">
            <div class="language_switcher_placeholder"></div>
            <div class="version_switcher_placeholder"></div>
          </li>
          <li>
              
          </li>
    <li id="cpython-language-and-version">
      <a href="../index.html">3.12.4 Documentation</a> &#187;
    </li>

          <li class="nav-item nav-item-1"><a href="index.html" >La bibliothèque standard</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="netdata.html" >Traitement des données provenant d'Internet</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="email.html" accesskey="U"><code class="xref py py-mod docutils literal notranslate"><span class="pre">email</span></code> --- An email and MIME handling package</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="email.policy.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">email.policy</span></code>: Policy Objects</a></li>
                <li class="right">
                    

    <div class="inline-search" role="search">
        <form class="inline-search" action="../search.html" method="get">
          <input placeholder="Recherche rapide" aria-label="Recherche rapide" type="search" name="q" id="search-box" />
          <input type="submit" value="Go" />
        </form>
    </div>
                     |
                </li>
            <li class="right">
<label class="theme-selector-label">
    Theme
    <select class="theme-selector" oninput="activateTheme(this.value)">
        <option value="auto" selected>Auto</option>
        <option value="light">Light</option>
        <option value="dark">Dark</option>
    </select>
</label> |</li>
            
      </ul>
    </div>    

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="module-email.policy">
<span id="email-policy-policy-objects"></span><h1><code class="xref py py-mod docutils literal notranslate"><span class="pre">email.policy</span></code>: Policy Objects<a class="headerlink" href="email.policy.html#module-email.policy" title="Lien vers cette rubrique">¶</a></h1>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 3.3.</span></p>
</div>
<p><strong>Code source :</strong> <a class="reference external" href="https://github.com/python/cpython/tree/3.12/Lib/email/policy.py">Lib/email/policy.py</a></p>
<hr class="docutils" />
<p>Le principal objectif du paquet <a class="reference internal" href="email.html#module-email" title="email: Package supporting the parsing, manipulating, and generating email messages."><code class="xref py py-mod docutils literal notranslate"><span class="pre">email</span></code></a> est la gestion des messages électroniques comme décrit par les diverses RFC de messagerie et MIME. Cependant, le format général des messages électroniques (un bloc de champs d'en-tête composés chacun d'un nom suivi de deux-points suivi d'une valeur, le bloc entier suivi d'une ligne vide et d'un « corps » arbitraire), est un format qui a trouvé son utilité en dehors du domaine du courrier électronique. Certaines de ces utilisations sont assez conformes aux principales RFC de messagerie, d'autres non. Même lorsque vous travaillez avec des e-mails, il est parfois souhaitable de ne pas respecter strictement les RFC, par exemple en générant des e-mails qui interagissent avec des serveurs de messagerie qui ne respectent pas eux-mêmes les normes ou qui implémentent des extensions que vous souhaitez utiliser d'une manière qui enfreint les normes.</p>
<p>Les objets de définition de politique donnent au paquet de messagerie la flexibilité nécessaire pour gérer tous ces cas d'utilisation disparates.</p>
<p>Un objet <a class="reference internal" href="email.policy.html#email.policy.Policy" title="email.policy.Policy"><code class="xref py py-class docutils literal notranslate"><span class="pre">Policy</span></code></a> encapsule un ensemble d'attributs et de méthodes qui contrôlent le comportement de divers composants du paquet de messagerie lors de son utilisation. Les instances <a class="reference internal" href="email.policy.html#email.policy.Policy" title="email.policy.Policy"><code class="xref py py-class docutils literal notranslate"><span class="pre">Policy</span></code></a> peuvent être transmises à diverses classes et méthodes dans le paquet de courrier électronique pour modifier le comportement par défaut. Les valeurs réglables et leurs valeurs par défaut sont décrites ci-dessous.</p>
<p>Il existe une politique par défaut utilisée par toutes les classes dans le paquet de messagerie. Pour toutes les classes <a class="reference internal" href="email.parser.html#module-email.parser" title="email.parser: Parse flat text email messages to produce a message object structure."><code class="xref py py-mod docutils literal notranslate"><span class="pre">parser</span></code></a> et les fonctions pratiques associées, et pour la classe <a class="reference internal" href="email.compat32-message.html#email.message.Message" title="email.message.Message"><code class="xref py py-class docutils literal notranslate"><span class="pre">Message</span></code></a>, il s'agit de la politique <a class="reference internal" href="email.policy.html#email.policy.Compat32" title="email.policy.Compat32"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compat32</span></code></a>, via son instance correspondante prédéfinie <a class="reference internal" href="email.policy.html#email.policy.compat32" title="email.policy.compat32"><code class="xref py py-const docutils literal notranslate"><span class="pre">compat32</span></code></a>. Cette politique fournit une rétrocompatibilité complète (dans certains cas, y compris la compatibilité des bogues) avec la version pré-Python3.3 du paquet de messagerie.</p>
<p>Cette valeur par défaut pour le paramètre nommé <em>policy</em> de <a class="reference internal" href="email.message.html#email.message.EmailMessage" title="email.message.EmailMessage"><code class="xref py py-class docutils literal notranslate"><span class="pre">EmailMessage</span></code></a> est la politique <a class="reference internal" href="email.policy.html#email.policy.EmailPolicy" title="email.policy.EmailPolicy"><code class="xref py py-class docutils literal notranslate"><span class="pre">EmailPolicy</span></code></a>, via son instance prédéfinie <a class="reference internal" href="email.policy.html#email.policy.default" title="email.policy.default"><code class="xref py py-data docutils literal notranslate"><span class="pre">default</span></code></a>.</p>
<p>Lorsqu'un objet <a class="reference internal" href="email.compat32-message.html#email.message.Message" title="email.message.Message"><code class="xref py py-class docutils literal notranslate"><span class="pre">Message</span></code></a> ou <a class="reference internal" href="email.message.html#email.message.EmailMessage" title="email.message.EmailMessage"><code class="xref py py-class docutils literal notranslate"><span class="pre">EmailMessage</span></code></a> est créé, il acquiert une politique. Si le message est créé par un <a class="reference internal" href="email.parser.html#module-email.parser" title="email.parser: Parse flat text email messages to produce a message object structure."><code class="xref py py-mod docutils literal notranslate"><span class="pre">parser</span></code></a>, la politique transmise à l'analyseur est la politique utilisée par le message qu'il crée. Si le message est créé par le programme, la stratégie peut être spécifiée lors de sa création. Lorsqu'un message est passé à un <a class="reference internal" href="email.generator.html#module-email.generator" title="email.generator: Generate flat text email messages from a message structure."><code class="xref py py-mod docutils literal notranslate"><span class="pre">generator</span></code></a>, le générateur utilise la politique du message par défaut, mais vous pouvez également passer une politique spécifique au générateur qui remplace celle stockée sur l'objet message.</p>
<p>La valeur par défaut du paramètre nommé <em>policy</em> pour les classes <a class="reference internal" href="email.parser.html#module-email.parser" title="email.parser: Parse flat text email messages to produce a message object structure."><code class="xref py py-mod docutils literal notranslate"><span class="pre">email.parser</span></code></a> et les fonctions pratiques de l'analyseur <strong>va changer</strong> dans une future version de Python. Par conséquent, vous devez <strong>toujours spécifier explicitement la stratégie que vous souhaitez utiliser</strong> lors de l'appel de l'une des classes et fonctions décrites dans le module <a class="reference internal" href="email.parser.html#module-email.parser" title="email.parser: Parse flat text email messages to produce a message object structure."><code class="xref py py-mod docutils literal notranslate"><span class="pre">parser</span></code></a>.</p>
<p>La première partie de cette documentation couvre les fonctionnalités de <a class="reference internal" href="email.policy.html#email.policy.Policy" title="email.policy.Policy"><code class="xref py py-class docutils literal notranslate"><span class="pre">Policy</span></code></a>, une <a class="reference internal" href="../glossary.html#term-abstract-base-class"><span class="xref std std-term">classe mère abstraite</span></a> qui définit les fonctionnalités communes à tous les objets de stratégie, y compris <a class="reference internal" href="email.policy.html#email.policy.compat32" title="email.policy.compat32"><code class="xref py py-const docutils literal notranslate"><span class="pre">compat32</span></code></a>. Cela inclut certaines méthodes automatiques (<em>hooks</em> en anglais) appelées en interne par le paquet de messagerie, qu'une stratégie personnalisée peut remplacer pour obtenir un comportement différent. La deuxième partie décrit les classes concrètes <a class="reference internal" href="email.policy.html#email.policy.EmailPolicy" title="email.policy.EmailPolicy"><code class="xref py py-class docutils literal notranslate"><span class="pre">EmailPolicy</span></code></a> et <a class="reference internal" href="email.policy.html#email.policy.Compat32" title="email.policy.Compat32"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compat32</span></code></a>, qui implémentent les points d'entrée automatiques qui fournissent respectivement le comportement standard et le comportement et les fonctionnalités rétrocompatibles.</p>
<p>Les instances <a class="reference internal" href="email.policy.html#email.policy.Policy" title="email.policy.Policy"><code class="xref py py-class docutils literal notranslate"><span class="pre">Policy</span></code></a> sont immuables, mais elles peuvent être clonées, en acceptant les mêmes arguments nommés que le constructeur de classe et en renvoyant une nouvelle instance <a class="reference internal" href="email.policy.html#email.policy.Policy" title="email.policy.Policy"><code class="xref py py-class docutils literal notranslate"><span class="pre">Policy</span></code></a> qui est une copie de l'original mais avec les valeurs d'attributs spécifiées modifiées.</p>
<p>Par exemple, le code suivant peut être utilisé pour lire un message électronique à partir d'un fichier sur le disque et le transmettre au programme système <code class="docutils literal notranslate"><span class="pre">sendmail</span></code> sur un système Unix :</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">email</span> <span class="kn">import</span> <span class="n">message_from_binary_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">email.generator</span> <span class="kn">import</span> <span class="n">BytesGenerator</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">email</span> <span class="kn">import</span> <span class="n">policy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">subprocess</span> <span class="kn">import</span> <span class="n">Popen</span><span class="p">,</span> <span class="n">PIPE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;mymsg.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">msg</span> <span class="o">=</span> <span class="n">message_from_binary_file</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">policy</span><span class="o">=</span><span class="n">policy</span><span class="o">.</span><span class="n">default</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">Popen</span><span class="p">([</span><span class="s1">&#39;sendmail&#39;</span><span class="p">,</span> <span class="n">msg</span><span class="p">[</span><span class="s1">&#39;To&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">addresses</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">stdin</span><span class="o">=</span><span class="n">PIPE</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">BytesGenerator</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">stdin</span><span class="p">,</span> <span class="n">policy</span><span class="o">=</span><span class="n">msg</span><span class="o">.</span><span class="n">policy</span><span class="o">.</span><span class="n">clone</span><span class="p">(</span><span class="n">linesep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\r\n</span><span class="s1">&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rc</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
</pre></div>
</div>
<p>Ici, nous disons à <a class="reference internal" href="email.generator.html#email.generator.BytesGenerator" title="email.generator.BytesGenerator"><code class="xref py py-class docutils literal notranslate"><span class="pre">BytesGenerator</span></code></a> d'utiliser les caractères de séparation de ligne corrects de la RFC lors de la création de la chaîne binaire à fournir à <code class="docutils literal notranslate"><span class="pre">stdin</span></code> de <code class="docutils literal notranslate"><span class="pre">sendmail</span></code>, où la politique par défaut utiliserait <code class="docutils literal notranslate"><span class="pre">\n</span></code> comme séparateur de ligne.</p>
<p>Certaines méthodes du paquet de messagerie acceptent un argument nommé <em>policy</em>, permettant à la politique d'être remplacée pour cette méthode. Par exemple, le code suivant utilise la méthode <a class="reference internal" href="email.compat32-message.html#email.message.Message.as_bytes" title="email.message.Message.as_bytes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">as_bytes()</span></code></a> de l'objet <em>msg</em> de l'exemple précédent et écrit le message dans un fichier en utilisant les séparateurs de ligne natifs de la plate-forme sur laquelle il est en cours d'exécution :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;converted.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">msg</span><span class="o">.</span><span class="n">as_bytes</span><span class="p">(</span><span class="n">policy</span><span class="o">=</span><span class="n">msg</span><span class="o">.</span><span class="n">policy</span><span class="o">.</span><span class="n">clone</span><span class="p">(</span><span class="n">linesep</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)))</span>
<span class="go">17</span>
</pre></div>
</div>
<p>Les objets de stratégie peuvent également être combinés à l'aide de l'opérateur d'addition, produisant un objet de stratégie dont les paramètres sont une combinaison des objets additionnées (en ne prenant en compte que les paramètres données explicitement) :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">compat_SMTP</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">compat32</span><span class="o">.</span><span class="n">clone</span><span class="p">(</span><span class="n">linesep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\r\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">compat_strict</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">compat32</span><span class="o">.</span><span class="n">clone</span><span class="p">(</span><span class="n">raise_on_defect</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">compat_strict_SMTP</span> <span class="o">=</span> <span class="n">compat_SMTP</span> <span class="o">+</span> <span class="n">compat_strict</span>
</pre></div>
</div>
<p>Cette opération n'est pas commutative ; c'est-à-dire que l'ordre dans lequel les objets sont ajoutés est important. Pour illustrer :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">policy100</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">compat32</span><span class="o">.</span><span class="n">clone</span><span class="p">(</span><span class="n">max_line_length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">policy80</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">compat32</span><span class="o">.</span><span class="n">clone</span><span class="p">(</span><span class="n">max_line_length</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">apolicy</span> <span class="o">=</span> <span class="n">policy100</span> <span class="o">+</span> <span class="n">policy80</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">apolicy</span><span class="o">.</span><span class="n">max_line_length</span>
<span class="go">80</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">apolicy</span> <span class="o">=</span> <span class="n">policy80</span> <span class="o">+</span> <span class="n">policy100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">apolicy</span><span class="o">.</span><span class="n">max_line_length</span>
<span class="go">100</span>
</pre></div>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="email.policy.Policy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">email.policy.</span></span><span class="sig-name descname"><span class="pre">Policy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kw</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="email.policy.html#email.policy.Policy" title="Lien vers cette définition">¶</a></dt>
<dd><p>C'est la <a class="reference internal" href="../glossary.html#term-abstract-base-class"><span class="xref std std-term">classe mère abstraite</span></a> pour toutes les classes de définition de politique. Elle fournit des implémentations par défaut pour quelques méthodes triviales, ainsi que l'implémentation de la propriété d'immutabilité, la méthode <a class="reference internal" href="email.policy.html#email.policy.Policy.clone" title="email.policy.Policy.clone"><code class="xref py py-meth docutils literal notranslate"><span class="pre">clone()</span></code></a> et la sémantique du constructeur.</p>
<p>Le constructeur d'une classe de définition de politique peut recevoir divers arguments nommés. Les arguments qui peuvent être spécifiés sont toutes les propriétés qui ne sont pas des méthodes sur cette classe, plus toutes les propriétés qui ne sont pas des méthodes supplémentaires sur la classe concrète. Une valeur spécifiée dans le constructeur remplace la valeur par défaut de l'attribut correspondant.</p>
<p>Cette classe définit les propriétés suivantes, et ainsi les valeurs des éléments suivants peuvent être passées dans le constructeur de n'importe quelle classe de définition de politique :</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="email.policy.Policy.max_line_length">
<span class="sig-name descname"><span class="pre">max_line_length</span></span><a class="headerlink" href="email.policy.html#email.policy.Policy.max_line_length" title="Lien vers cette définition">¶</a></dt>
<dd><p>La longueur maximale de toute ligne dans la sortie sérialisée, sans compter le(s) caractère(s) de fin de ligne. La valeur par défaut est 78, selon la <span class="target" id="index-20"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc5322.html"><strong>RFC 5322</strong></a>. Une valeur de <code class="docutils literal notranslate"><span class="pre">0</span></code> ou <a class="reference internal" href="constants.html#None" title="None"><code class="xref py py-const docutils literal notranslate"><span class="pre">None</span></code></a> indique qu'aucun retour à la ligne ne doit être fait.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="email.policy.Policy.linesep">
<span class="sig-name descname"><span class="pre">linesep</span></span><a class="headerlink" href="email.policy.html#email.policy.Policy.linesep" title="Lien vers cette définition">¶</a></dt>
<dd><p>La chaîne à utiliser pour terminer les lignes dans la sortie sérialisée. La valeur par défaut est <code class="docutils literal notranslate"><span class="pre">\n</span></code> car c'est la définition interne de fin de ligne utilisée par Python, bien que <code class="docutils literal notranslate"><span class="pre">\r\n</span></code> soit requis par les RFC.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="email.policy.Policy.cte_type">
<span class="sig-name descname"><span class="pre">cte_type</span></span><a class="headerlink" href="email.policy.html#email.policy.Policy.cte_type" title="Lien vers cette définition">¶</a></dt>
<dd><p>Contrôle le type d'encodage de contenu qui peut ou doit être utilisé. Les valeurs possibles sont :</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">7bit</span></code></p></td>
<td><p>toutes les données doivent être « complétement 7 bits » (ASCII uniquement). Cela signifie que si nécessaire, les données seront encodées à l'aide de l'encodage <em>quoted-printable</em> ou <em>base64</em>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">8bit</span></code></p></td>
<td><p>les données ne sont pas contraintes d'être uniquement sur 7 bits. Les données dans les en-têtes doivent toujours être en ASCII uniquement et seront donc encodées (voir <a class="reference internal" href="email.policy.html#email.policy.Policy.fold_binary" title="email.policy.Policy.fold_binary"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fold_binary()</span></code></a> et <a class="reference internal" href="email.policy.html#email.policy.EmailPolicy.utf8" title="email.policy.EmailPolicy.utf8"><code class="xref py py-attr docutils literal notranslate"><span class="pre">utf8</span></code></a> ci-dessous pour les exceptions), mais les parties du corps peuvent utiliser le <code class="docutils literal notranslate"><span class="pre">8bit</span></code> CTE.</p></td>
</tr>
</tbody>
</table>
<p>Une valeur <code class="docutils literal notranslate"><span class="pre">cte_type</span></code> de <code class="docutils literal notranslate"><span class="pre">8bit</span></code> ne fonctionne qu'avec <code class="docutils literal notranslate"><span class="pre">BytesGenerator</span></code>,  et pas avec <code class="docutils literal notranslate"><span class="pre">Generator</span></code> car les chaînes ne peuvent pas contenir de données binaires. Si un <code class="docutils literal notranslate"><span class="pre">Generator</span></code> fonctionne sous une politique qui spécifie <code class="docutils literal notranslate"><span class="pre">cte_type=8bit</span></code>, il agit comme si <code class="docutils literal notranslate"><span class="pre">cte_type</span></code> était <code class="docutils literal notranslate"><span class="pre">7bit</span></code>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="email.policy.Policy.raise_on_defect">
<span class="sig-name descname"><span class="pre">raise_on_defect</span></span><a class="headerlink" href="email.policy.html#email.policy.Policy.raise_on_defect" title="Lien vers cette définition">¶</a></dt>
<dd><p>Si <a class="reference internal" href="constants.html#True" title="True"><code class="xref py py-const docutils literal notranslate"><span class="pre">True</span></code></a>, tous les défauts rencontrés sont signalés comme des erreurs. Si <a class="reference internal" href="constants.html#False" title="False"><code class="xref py py-const docutils literal notranslate"><span class="pre">False</span></code></a> (la valeur par défaut), les défauts sont passés à la méthode <a class="reference internal" href="email.policy.html#email.policy.Policy.register_defect" title="email.policy.Policy.register_defect"><code class="xref py py-meth docutils literal notranslate"><span class="pre">register_defect()</span></code></a>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="email.policy.Policy.mangle_from_">
<span class="sig-name descname"><span class="pre">mangle_from_</span></span><a class="headerlink" href="email.policy.html#email.policy.Policy.mangle_from_" title="Lien vers cette définition">¶</a></dt>
<dd><p>Si <a class="reference internal" href="constants.html#True" title="True"><code class="xref py py-const docutils literal notranslate"><span class="pre">True</span></code></a>, les lignes commençant par <em>&quot;From &quot;</em> dans le corps sont échappées en mettant un <code class="docutils literal notranslate"><span class="pre">&gt;</span></code> devant elles. Ce paramètre est utilisé lorsque le message est sérialisé par un générateur. Par défaut, vaut <a class="reference internal" href="constants.html#False" title="False"><code class="xref py py-const docutils literal notranslate"><span class="pre">False</span></code></a>.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 3.5.</span></p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="email.policy.Policy.message_factory">
<span class="sig-name descname"><span class="pre">message_factory</span></span><a class="headerlink" href="email.policy.html#email.policy.Policy.message_factory" title="Lien vers cette définition">¶</a></dt>
<dd><p>Une fonction de fabrique pour construire un nouvel objet de message vide. Utilisé par l'analyseur lors de la construction des messages. La valeur par défaut est <code class="docutils literal notranslate"><span class="pre">None</span></code>, <a class="reference internal" href="email.compat32-message.html#email.message.Message" title="email.message.Message"><code class="xref py py-class docutils literal notranslate"><span class="pre">Message</span></code></a> est alors utilisé.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 3.6.</span></p>
</div>
</dd></dl>

<p>La méthode <a class="reference internal" href="email.policy.html#email.policy.Policy" title="email.policy.Policy"><code class="xref py py-class docutils literal notranslate"><span class="pre">Policy</span></code></a> suivante est destinée à être appelée par le code à l'aide de la bibliothèque de messagerie pour créer des instances de stratégie avec des paramètres personnalisés :</p>
<dl class="py method">
<dt class="sig sig-object py" id="email.policy.Policy.clone">
<span class="sig-name descname"><span class="pre">clone</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kw</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="email.policy.html#email.policy.Policy.clone" title="Lien vers cette définition">¶</a></dt>
<dd><p>Renvoie une nouvelle instance de <a class="reference internal" href="email.policy.html#email.policy.Policy" title="email.policy.Policy"><code class="xref py py-class docutils literal notranslate"><span class="pre">Policy</span></code></a> dont les attributs ont les mêmes valeurs que l'instance actuelle, sauf si ces attributs reçoivent de nouvelles valeurs par les arguments nommés.</p>
</dd></dl>

<p>Les méthodes <a class="reference internal" href="email.policy.html#email.policy.Policy" title="email.policy.Policy"><code class="xref py py-class docutils literal notranslate"><span class="pre">Policy</span></code></a> restantes sont appelées par le code du paquet de messagerie et ne sont pas destinées à être appelées par une application utilisant le paquet de messagerie. Une stratégie personnalisée doit implémenter toutes ces méthodes.</p>
<dl class="py method">
<dt class="sig sig-object py" id="email.policy.Policy.handle_defect">
<span class="sig-name descname"><span class="pre">handle_defect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">defect</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="email.policy.html#email.policy.Policy.handle_defect" title="Lien vers cette définition">¶</a></dt>
<dd><p>Gère un <em>defect</em> trouvé sur <em>obj</em>. Lorsque le paquet de messagerie appelle cette méthode, <em>defect</em> est toujours une sous-classe de <code class="xref py py-class docutils literal notranslate"><span class="pre">Defect</span></code>.</p>
<p>L'implémentation par défaut vérifie le drapeau <a class="reference internal" href="email.policy.html#email.policy.Policy.raise_on_defect" title="email.policy.Policy.raise_on_defect"><code class="xref py py-attr docutils literal notranslate"><span class="pre">raise_on_defect</span></code></a>. Si c'est <code class="docutils literal notranslate"><span class="pre">True</span></code>, <em>defect</em> est levé comme une exception. Si c'est <code class="docutils literal notranslate"><span class="pre">False</span></code> (par défaut), <em>obj</em> et <em>defect</em> sont passés à <a class="reference internal" href="email.policy.html#email.policy.Policy.register_defect" title="email.policy.Policy.register_defect"><code class="xref py py-meth docutils literal notranslate"><span class="pre">register_defect()</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="email.policy.Policy.register_defect">
<span class="sig-name descname"><span class="pre">register_defect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">defect</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="email.policy.html#email.policy.Policy.register_defect" title="Lien vers cette définition">¶</a></dt>
<dd><p>Enregistre un <em>defect</em> sur <em>obj</em>. Dans le paquet de messagerie, <em>defect</em> sera toujours une sous-classe de <code class="xref py py-class docutils literal notranslate"><span class="pre">Defect</span></code>.</p>
<p>L'implémentation par défaut appelle la méthode <code class="docutils literal notranslate"><span class="pre">append</span></code> de l'attribut <code class="docutils literal notranslate"><span class="pre">defects</span></code> de <em>obj</em>. Lorsque le paquet de courrier électronique appelle <a class="reference internal" href="email.policy.html#email.policy.Policy.handle_defect" title="email.policy.Policy.handle_defect"><code class="xref py py-attr docutils literal notranslate"><span class="pre">handle_defect</span></code></a>, <em>obj</em> a normalement un attribut <code class="docutils literal notranslate"><span class="pre">defects</span></code> qui a une méthode <code class="docutils literal notranslate"><span class="pre">append</span></code>. Les types d'objets personnalisés utilisés avec le paquet de messagerie (par exemple, les objets <code class="docutils literal notranslate"><span class="pre">Message</span></code> personnalisés) doivent également fournir un tel attribut, sinon les défauts dans les messages analysés généreront des erreurs inattendues.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="email.policy.Policy.header_max_count">
<span class="sig-name descname"><span class="pre">header_max_count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="email.policy.html#email.policy.Policy.header_max_count" title="Lien vers cette définition">¶</a></dt>
<dd><p>Renvoie le nombre maximal autorisé d'en-têtes nommés <em>name</em>.</p>
<p>Appelé lorsqu'un en-tête est ajouté à un objet <a class="reference internal" href="email.message.html#email.message.EmailMessage" title="email.message.EmailMessage"><code class="xref py py-class docutils literal notranslate"><span class="pre">EmailMessage</span></code></a> ou <a class="reference internal" href="email.compat32-message.html#email.message.Message" title="email.message.Message"><code class="xref py py-class docutils literal notranslate"><span class="pre">Message</span></code></a>. Si la valeur renvoyée n'est pas <code class="docutils literal notranslate"><span class="pre">0</span></code> ou <code class="docutils literal notranslate"><span class="pre">None</span></code>, et qu'il y a déjà un certain nombre d'en-têtes avec le nom <em>name</em> supérieur ou égal à la valeur renvoyée, une <a class="reference internal" href="exceptions.html#ValueError" title="ValueError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code></a> est levée.</p>
<p>Parce que le comportement par défaut de <code class="docutils literal notranslate"><span class="pre">Message.__setitem__</span></code> est d'ajouter la valeur à la liste des en-têtes, il est facile de créer des en-têtes en double sans s'en rendre compte. Cette méthode permet à certains en-têtes d'être limités dans le nombre d'instances de cet en-tête qui peuvent être ajoutées à un <code class="docutils literal notranslate"><span class="pre">Message</span></code> par programme (la limite n'est pas respectée par l'analyseur, qui produit fidèlement autant d'en-têtes qu'il en existe dans le message analysé).</p>
<p>L'implémentation par défaut renvoie <code class="docutils literal notranslate"><span class="pre">None</span></code> pour tous les noms d'en-tête.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="email.policy.Policy.header_source_parse">
<span class="sig-name descname"><span class="pre">header_source_parse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sourcelines</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="email.policy.html#email.policy.Policy.header_source_parse" title="Lien vers cette définition">¶</a></dt>
<dd><p>Le paquet de courrier électronique appelle cette méthode avec une liste de chaînes, chaque chaîne se terminant par les caractères de séparation de ligne trouvés dans la source analysée. La première ligne comprend le nom de l'en-tête de champ et le séparateur. Tous les espaces blancs dans la source sont préservés. La méthode doit renvoyer le couple <code class="docutils literal notranslate"><span class="pre">(name,</span> <span class="pre">value)</span></code> qui doit être stocké dans le <code class="docutils literal notranslate"><span class="pre">Message</span></code> pour représenter l'en-tête analysé.</p>
<p>Si une implémentation souhaite conserver la compatibilité avec les politiques de paquet de messagerie existantes, <em>name</em> doit être le nom préservé de la casse (tous les caractères jusqu'au séparateur <code class="docutils literal notranslate"><span class="pre">:</span></code>), tandis que <em>value</em> doit être la valeur dépliée (c.-à-d. tous les caractères de séparation de ligne supprimés, mais les espaces blancs conservés intacts), dépouillés des espaces blancs de tête.</p>
<p><em>sourcelines</em> peut contenir des données binaires échappées de substitution.</p>
<p>Il n'y a pas d'implémentation par défaut</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="email.policy.Policy.header_store_parse">
<span class="sig-name descname"><span class="pre">header_store_parse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="email.policy.html#email.policy.Policy.header_store_parse" title="Lien vers cette définition">¶</a></dt>
<dd><p>Le paquet de courrier électronique appelle cette méthode avec le nom et la valeur fournis par le programme d'application lorsque le programme d'application modifie un <code class="docutils literal notranslate"><span class="pre">Message</span></code> par programme (par opposition à un <code class="docutils literal notranslate"><span class="pre">Message</span></code> créé par un analyseur). La méthode doit renvoyer le couple <code class="docutils literal notranslate"><span class="pre">(name,</span> <span class="pre">value)</span></code> qui doit être stocké dans le <code class="docutils literal notranslate"><span class="pre">Message</span></code> pour représenter l'en-tête.</p>
<p>Si une implémentation souhaite conserver la compatibilité avec les politiques existantes du paquet de messagerie, le <em>name</em> et la <em>value</em> doivent être des chaînes ou des sous-classes de chaînes qui ne modifient pas le contenu des arguments transmis.</p>
<p>Il n'y a pas d'implémentation par défaut</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="email.policy.Policy.header_fetch_parse">
<span class="sig-name descname"><span class="pre">header_fetch_parse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="email.policy.html#email.policy.Policy.header_fetch_parse" title="Lien vers cette définition">¶</a></dt>
<dd><p>Le paquet de courrier électronique appelle cette méthode avec le <em>name</em> et la <em>value</em> actuellement stockés dans le <code class="docutils literal notranslate"><span class="pre">Message</span></code> lorsque cet en-tête est demandé par le programme d'application, et tout ce que la méthode renvoie est ce qui est renvoyé à l'application comme valeur de l'en-tête récupéré. Notez qu'il peut y avoir plus d'un en-tête avec le même nom stocké dans le <code class="docutils literal notranslate"><span class="pre">Message</span></code> ; la méthode reçoit le nom et la valeur spécifiques de l'en-tête destiné à être renvoyé à l'application.</p>
<p><em>value</em> peut contenir des données binaires de substitution échappées. Il ne doit pas y avoir de données binaires échappées de substitution dans la valeur renvoyée par la méthode.</p>
<p>Il n'y a pas d'implémentation par défaut</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="email.policy.Policy.fold">
<span class="sig-name descname"><span class="pre">fold</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="email.policy.html#email.policy.Policy.fold" title="Lien vers cette définition">¶</a></dt>
<dd><p>Le paquet de courrier électronique appelle cette méthode avec le <em>name</em> et la <em>value</em> actuellement stockés dans le <code class="docutils literal notranslate"><span class="pre">Message</span></code> pour un en-tête donné. La méthode doit renvoyer une chaîne qui représente correctement cet en-tête « plié » (selon les paramètres de la politique) en mettant en forme le couple <em>name</em> - <em>value</em> et en insérant les caractères <a class="reference internal" href="email.policy.html#email.policy.Policy.linesep" title="email.policy.Policy.linesep"><code class="xref py py-attr docutils literal notranslate"><span class="pre">linesep</span></code></a> aux endroits appropriés. Voir <span class="target" id="index-21"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc5322.html"><strong>RFC 5322</strong></a> pour une discussion sur les règles de mise en forme (« pliage » ou <em>folding</em> en anglais) des en-têtes de courrier électronique.</p>
<p><em>value</em> peut contenir des données binaires de substitution échappées. Il ne doit pas y avoir de données binaires échappées de substitution dans la chaîne renvoyée par la méthode.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="email.policy.Policy.fold_binary">
<span class="sig-name descname"><span class="pre">fold_binary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="email.policy.html#email.policy.Policy.fold_binary" title="Lien vers cette définition">¶</a></dt>
<dd><p>Identique à <a class="reference internal" href="email.policy.html#email.policy.Policy.fold" title="email.policy.Policy.fold"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fold()</span></code></a>, sauf que la valeur renvoyée doit être un objet bytes plutôt qu'une chaîne.</p>
<p><em>value</em> peut contenir des données binaires de substitution échappées. Celles-ci pourraient être reconverties en données binaires dans l'objet bytes renvoyé.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="email.policy.EmailPolicy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">email.policy.</span></span><span class="sig-name descname"><span class="pre">EmailPolicy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kw</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="email.policy.html#email.policy.EmailPolicy" title="Lien vers cette définition">¶</a></dt>
<dd><p>Cette <a class="reference internal" href="email.policy.html#email.policy.Policy" title="email.policy.Policy"><code class="xref py py-class docutils literal notranslate"><span class="pre">Policy</span></code></a> concrète fournit un comportement destiné à être entièrement conforme aux RFC de messagerie actuelles. Ce qui inclut (mais n'est pas limité à) la <span class="target" id="index-22"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc5322.html"><strong>RFC 5322</strong></a>, la <span class="target" id="index-23"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc2047.html"><strong>RFC 2047</strong></a> et les RFC MIME actuelles.</p>
<p>Cette politique ajoute de nouveaux algorithmes d'analyse d'en-tête et de mise en forme (« pliage »). Au lieu de simples chaînes, les en-têtes sont des sous-classes <code class="docutils literal notranslate"><span class="pre">str</span></code> avec des attributs qui dépendent du type du champ. L'algorithme d'analyse et de pliage implémente entièrement la <span class="target" id="index-24"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc2047.html"><strong>RFC 2047</strong></a> et la <span class="target" id="index-25"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc5322.html"><strong>RFC 5322</strong></a>.</p>
<p>La valeur par défaut de l'attribut <a class="reference internal" href="email.policy.html#email.policy.Policy.message_factory" title="email.policy.Policy.message_factory"><code class="xref py py-attr docutils literal notranslate"><span class="pre">message_factory</span></code></a> est <a class="reference internal" href="email.message.html#email.message.EmailMessage" title="email.message.EmailMessage"><code class="xref py py-class docutils literal notranslate"><span class="pre">EmailMessage</span></code></a>.</p>
<p>Outre les attributs définissables répertoriés ci-dessus qui s'appliquent à toutes les règles, cette règle ajoute les attributs supplémentaires suivants :</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 3.6: </span><a class="footnote-reference brackets" href="email.policy.html#id2" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a></p>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="email.policy.EmailPolicy.utf8">
<span class="sig-name descname"><span class="pre">utf8</span></span><a class="headerlink" href="email.policy.html#email.policy.EmailPolicy.utf8" title="Lien vers cette définition">¶</a></dt>
<dd><p>Si c'est <code class="docutils literal notranslate"><span class="pre">False</span></code>, suit la <span class="target" id="index-26"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc5322.html"><strong>RFC 5322</strong></a>, en prenant en charge les caractères non-ASCII dans les en-têtes en les encodant comme des « mots encodés ». Si c'est <code class="docutils literal notranslate"><span class="pre">True</span></code>, suit la <span class="target" id="index-27"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc6532.html"><strong>RFC 6532</strong></a> et utilise l'encodage <code class="docutils literal notranslate"><span class="pre">utf-8</span></code> pour les en-têtes. Les messages formatés de cette manière peuvent être transmis aux serveurs SMTP qui gèrent l'extension <code class="docutils literal notranslate"><span class="pre">SMTPUTF8</span></code> (<span class="target" id="index-28"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc6531.html"><strong>RFC 6531</strong></a>).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="email.policy.EmailPolicy.refold_source">
<span class="sig-name descname"><span class="pre">refold_source</span></span><a class="headerlink" href="email.policy.html#email.policy.EmailPolicy.refold_source" title="Lien vers cette définition">¶</a></dt>
<dd><p>Si la valeur d'un en-tête dans l'objet <code class="docutils literal notranslate"><span class="pre">Message</span></code> provient d'un <a class="reference internal" href="email.parser.html#module-email.parser" title="email.parser: Parse flat text email messages to produce a message object structure."><code class="xref py py-mod docutils literal notranslate"><span class="pre">parser</span></code></a> (au lieu d'être définie par un programme), cet attribut indique si un générateur doit ou non remettre en forme cette valeur lorsqu'il retransforme le message sous forme sérialisée. Les valeurs possibles sont :</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">none</span></code></p></td>
<td><p>toutes les valeurs sources utilisent la mise en forme (<em>folding</em> en anglais) d'origine</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">long</span></code></p></td>
<td><p>les valeurs sources dont une ligne est plus longue que <code class="docutils literal notranslate"><span class="pre">max_line_length</span></code> sont remises en forme</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">all</span></code></p></td>
<td><p>toutes les valeurs sont remises en forme.</p></td>
</tr>
</tbody>
</table>
<p>La valeur par défaut est <code class="docutils literal notranslate"><span class="pre">long</span></code>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="email.policy.EmailPolicy.header_factory">
<span class="sig-name descname"><span class="pre">header_factory</span></span><a class="headerlink" href="email.policy.html#email.policy.EmailPolicy.header_factory" title="Lien vers cette définition">¶</a></dt>
<dd><p>Appelable qui prend deux arguments, <code class="docutils literal notranslate"><span class="pre">name</span></code> et <code class="docutils literal notranslate"><span class="pre">value</span></code>, où <code class="docutils literal notranslate"><span class="pre">name</span></code> est un nom de champ d'en-tête et <code class="docutils literal notranslate"><span class="pre">value</span></code> est une valeur de champ d'en-tête dépliée (c-à-d. sans retours à la ligne de mise en forme), et renvoie une sous-classe de chaîne qui représente cet en-tête. Un <code class="docutils literal notranslate"><span class="pre">header_factory</span></code> par défaut (voir <a class="reference internal" href="email.headerregistry.html#module-email.headerregistry" title="email.headerregistry: Automatic Parsing of headers based on the field name"><code class="xref py py-mod docutils literal notranslate"><span class="pre">headerregistry</span></code></a>) est fourni qui prend en charge l'analyse personnalisée pour les divers types de champs d'en-tête d'adresse et de date <span class="target" id="index-29"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc5322.html"><strong>RFC 5322</strong></a>, et les principaux types de champs d'en-tête MIME. La prise en charge d'une analyse personnalisée supplémentaire sera ajoutée à l'avenir.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="email.policy.EmailPolicy.content_manager">
<span class="sig-name descname"><span class="pre">content_manager</span></span><a class="headerlink" href="email.policy.html#email.policy.EmailPolicy.content_manager" title="Lien vers cette définition">¶</a></dt>
<dd><p>Objet avec au moins deux méthodes : <em>get_content</em> et <em>set_content</em>. Lorsque la méthode <a class="reference internal" href="email.message.html#email.message.EmailMessage.get_content" title="email.message.EmailMessage.get_content"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_content()</span></code></a> ou <a class="reference internal" href="email.message.html#email.message.EmailMessage.set_content" title="email.message.EmailMessage.set_content"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_content()</span></code></a> d'un objet <a class="reference internal" href="email.message.html#email.message.EmailMessage" title="email.message.EmailMessage"><code class="xref py py-class docutils literal notranslate"><span class="pre">EmailMessage</span></code></a> est appelée, elle appelle la méthode correspondante de cet objet, en lui transmettant l'objet message comme premier argument, et tous les arguments positionnels ou nommés qui lui ont été transmis comme arguments supplémentaires. Par défaut, <code class="docutils literal notranslate"><span class="pre">content_manager</span></code> est défini sur <a class="reference internal" href="email.contentmanager.html#email.contentmanager.raw_data_manager" title="email.contentmanager.raw_data_manager"><code class="xref py py-data docutils literal notranslate"><span class="pre">raw_data_manager</span></code></a>.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 3.4.</span></p>
</div>
</dd></dl>

<p>La classe fournit les implémentations concrètes suivantes des méthodes abstraites de <a class="reference internal" href="email.policy.html#email.policy.Policy" title="email.policy.Policy"><code class="xref py py-class docutils literal notranslate"><span class="pre">Policy</span></code></a> :</p>
<dl class="py method">
<dt class="sig sig-object py" id="email.policy.EmailPolicy.header_max_count">
<span class="sig-name descname"><span class="pre">header_max_count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="email.policy.html#email.policy.EmailPolicy.header_max_count" title="Lien vers cette définition">¶</a></dt>
<dd><p>Renvoie la valeur de l'attribut <a class="reference internal" href="email.headerregistry.html#email.headerregistry.BaseHeader.max_count" title="email.headerregistry.BaseHeader.max_count"><code class="xref py py-attr docutils literal notranslate"><span class="pre">max_count</span></code></a> de la classe spécialisée utilisée pour représenter l'en-tête avec le nom donné.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="email.policy.EmailPolicy.header_source_parse">
<span class="sig-name descname"><span class="pre">header_source_parse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sourcelines</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="email.policy.html#email.policy.EmailPolicy.header_source_parse" title="Lien vers cette définition">¶</a></dt>
<dd><p>Le nom est analysé comme le reste jusqu'au <code class="docutils literal notranslate"><span class="pre">:</span></code> et renvoyé sans modification. La valeur est déterminée en supprimant les espaces blancs de début du reste de la première ligne, en joignant toutes les lignes suivantes et en supprimant tous les caractères de retour chariot ou de saut de ligne de fin.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="email.policy.EmailPolicy.header_store_parse">
<span class="sig-name descname"><span class="pre">header_store_parse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="email.policy.html#email.policy.EmailPolicy.header_store_parse" title="Lien vers cette définition">¶</a></dt>
<dd><p>Le nom est renvoyé tel quel. Si la valeur d'entrée a un attribut <code class="docutils literal notranslate"><span class="pre">name</span></code> et qu'elle correspond à <em>name</em> sans tenir compte de la casse, la valeur est renvoyée inchangée. Sinon, le <em>name</em> et la <em>value</em> sont passés à <code class="docutils literal notranslate"><span class="pre">header_factory</span></code>, et l'objet d'en-tête résultant est renvoyé comme valeur. Dans ce cas, une <code class="docutils literal notranslate"><span class="pre">ValueError</span></code> est levée si la valeur d'entrée contient des caractères CR ou LF.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="email.policy.EmailPolicy.header_fetch_parse">
<span class="sig-name descname"><span class="pre">header_fetch_parse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="email.policy.html#email.policy.EmailPolicy.header_fetch_parse" title="Lien vers cette définition">¶</a></dt>
<dd><p>Si la valeur a un attribut <code class="docutils literal notranslate"><span class="pre">name</span></code>, elle est renvoyée sans modification. Sinon, le <em>name</em> et la <em>value</em> sans les caractères CR ou LF sont passés à <code class="docutils literal notranslate"><span class="pre">header_factory</span></code>, et l'objet d'en-tête résultant est renvoyé. Tous les octets échappés de substitution sont transformés en glyphe Unicode de caractère inconnu.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="email.policy.EmailPolicy.fold">
<span class="sig-name descname"><span class="pre">fold</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="email.policy.html#email.policy.EmailPolicy.fold" title="Lien vers cette définition">¶</a></dt>
<dd><p>La mise en forme d'en-tête est contrôlée par le paramètre de politique <a class="reference internal" href="email.policy.html#email.policy.EmailPolicy.refold_source" title="email.policy.EmailPolicy.refold_source"><code class="xref py py-attr docutils literal notranslate"><span class="pre">refold_source</span></code></a>. Une valeur est considérée comme une « valeur source » si et seulement si elle n'a pas d'attribut <code class="docutils literal notranslate"><span class="pre">name</span></code> (avoir un attribut <code class="docutils literal notranslate"><span class="pre">name</span></code> signifie qu'il s'agit d'un objet d'en-tête quelconque). Si une valeur source doit être mise en forme conformément à la politique, elle est convertie en un objet d'en-tête en passant le <em>name</em> et la <em>value</em> avec tous les caractères CR et LF supprimés à <code class="docutils literal notranslate"><span class="pre">header_factory</span></code>. La mise en forme multi-lignes d'un objet d'en-tête (« pliage » ou <em>folding</em> en anglais) se fait en appelant sa méthode <code class="docutils literal notranslate"><span class="pre">fold</span></code> avec la politique actuelle.</p>
<p>Les valeurs sources sont divisées en lignes en utilisant <a class="reference internal" href="stdtypes.html#str.splitlines" title="str.splitlines"><code class="xref py py-meth docutils literal notranslate"><span class="pre">splitlines()</span></code></a>. Si la valeur ne doit pas être remise en forme, les lignes sont jointes en utilisant le caractère <code class="docutils literal notranslate"><span class="pre">linesep</span></code> de la politique et renvoyées. L'exception concerne les lignes contenant des données binaires non ASCII. Dans ce cas, la valeur est remise en forme quel que soit le paramètre <code class="docutils literal notranslate"><span class="pre">refold_source</span></code>, ce qui entraîne le codage CTE des données binaires à l'aide du jeu de caractères <code class="docutils literal notranslate"><span class="pre">unknown-8bit</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="email.policy.EmailPolicy.fold_binary">
<span class="sig-name descname"><span class="pre">fold_binary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="email.policy.html#email.policy.EmailPolicy.fold_binary" title="Lien vers cette définition">¶</a></dt>
<dd><p>Identique à <a class="reference internal" href="email.policy.html#email.policy.EmailPolicy.fold" title="email.policy.EmailPolicy.fold"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fold()</span></code></a> si <a class="reference internal" href="email.policy.html#email.policy.Policy.cte_type" title="email.policy.Policy.cte_type"><code class="xref py py-attr docutils literal notranslate"><span class="pre">cte_type</span></code></a> vaut <code class="docutils literal notranslate"><span class="pre">7bit</span></code>, sauf que la valeur renvoyée est de type <em>bytes</em>.</p>
<p>Si <a class="reference internal" href="email.policy.html#email.policy.Policy.cte_type" title="email.policy.Policy.cte_type"><code class="xref py py-attr docutils literal notranslate"><span class="pre">cte_type</span></code></a> est <code class="docutils literal notranslate"><span class="pre">8bit</span></code>, les données binaires non-ASCII sont reconverties en octets. Les en-têtes contenant des données binaires ne sont pas remises en forme, quel que soit le paramètre <code class="docutils literal notranslate"><span class="pre">refold_header</span></code>, puisqu'il n'y a aucun moyen de savoir si les données binaires sont constituées de caractères à un seul octet ou de caractères à plusieurs octets.</p>
</dd></dl>

</dd></dl>

<p>Les instances suivantes de <a class="reference internal" href="email.policy.html#email.policy.EmailPolicy" title="email.policy.EmailPolicy"><code class="xref py py-class docutils literal notranslate"><span class="pre">EmailPolicy</span></code></a> fournissent des valeurs par défaut adaptées à des domaines d'application spécifiques. Notez qu'à l'avenir, le comportement de ces instances (en particulier l'instance <code class="docutils literal notranslate"><span class="pre">HTTP</span></code>) pourra être ajusté pour se conformer encore plus étroitement aux RFC relatives à leurs domaines.</p>
<dl class="py data">
<dt class="sig sig-object py" id="email.policy.default">
<span class="sig-prename descclassname"><span class="pre">email.policy.</span></span><span class="sig-name descname"><span class="pre">default</span></span><a class="headerlink" href="email.policy.html#email.policy.default" title="Lien vers cette définition">¶</a></dt>
<dd><p>Une instance de <code class="docutils literal notranslate"><span class="pre">EmailPolicy</span></code> avec toutes les valeurs par défaut inchangées. Cette politique utilise les fins de ligne standard Python <code class="docutils literal notranslate"><span class="pre">\n</span></code> plutôt que le <code class="docutils literal notranslate"><span class="pre">\r\n</span></code> conforme à la RFC.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="email.policy.SMTP">
<span class="sig-prename descclassname"><span class="pre">email.policy.</span></span><span class="sig-name descname"><span class="pre">SMTP</span></span><a class="headerlink" href="email.policy.html#email.policy.SMTP" title="Lien vers cette définition">¶</a></dt>
<dd><p>Convient pour la sérialisation des messages conformément aux RFC des e-mails. Comme <code class="docutils literal notranslate"><span class="pre">default</span></code>, mais avec <code class="docutils literal notranslate"><span class="pre">linesep</span></code> défini sur <code class="docutils literal notranslate"><span class="pre">\r\n</span></code>, ce qui est conforme à la RFC.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="email.policy.SMTPUTF8">
<span class="sig-prename descclassname"><span class="pre">email.policy.</span></span><span class="sig-name descname"><span class="pre">SMTPUTF8</span></span><a class="headerlink" href="email.policy.html#email.policy.SMTPUTF8" title="Lien vers cette définition">¶</a></dt>
<dd><p>Identique à <code class="docutils literal notranslate"><span class="pre">SMTP</span></code> sauf que <a class="reference internal" href="email.policy.html#email.policy.EmailPolicy.utf8" title="email.policy.EmailPolicy.utf8"><code class="xref py py-attr docutils literal notranslate"><span class="pre">utf8</span></code></a> vaut <code class="docutils literal notranslate"><span class="pre">True</span></code>. Utile pour sérialiser des messages dans une banque de messages sans utiliser de mots encodés dans les en-têtes. Ne doit être utilisée pour la transmission SMTP que si les adresses de l'expéditeur ou du destinataire contiennent des caractères non ASCII (la méthode <a class="reference internal" href="smtplib.html#smtplib.SMTP.send_message" title="smtplib.SMTP.send_message"><code class="xref py py-meth docutils literal notranslate"><span class="pre">smtplib.SMTP.send_message()</span></code></a> gère cela automatiquement).</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="email.policy.HTTP">
<span class="sig-prename descclassname"><span class="pre">email.policy.</span></span><span class="sig-name descname"><span class="pre">HTTP</span></span><a class="headerlink" href="email.policy.html#email.policy.HTTP" title="Lien vers cette définition">¶</a></dt>
<dd><p>Convient pour la sérialisation des en-têtes à utiliser dans le trafic HTTP. Comme <code class="docutils literal notranslate"><span class="pre">SMTP</span></code> sauf que <code class="docutils literal notranslate"><span class="pre">max_line_length</span></code> est défini sur <code class="docutils literal notranslate"><span class="pre">None</span></code> (illimité).</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="email.policy.strict">
<span class="sig-prename descclassname"><span class="pre">email.policy.</span></span><span class="sig-name descname"><span class="pre">strict</span></span><a class="headerlink" href="email.policy.html#email.policy.strict" title="Lien vers cette définition">¶</a></dt>
<dd><p>Exemple de commodité. Identique à <code class="docutils literal notranslate"><span class="pre">default</span></code> sauf que <code class="docutils literal notranslate"><span class="pre">raise_on_defect</span></code> est défini sur <code class="docutils literal notranslate"><span class="pre">True</span></code>. Cela permet de rendre stricte toute politique en écrivant :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">somepolicy</span> <span class="o">+</span> <span class="n">policy</span><span class="o">.</span><span class="n">strict</span>
</pre></div>
</div>
</dd></dl>

<p>Avec toutes ces <a class="reference internal" href="email.policy.html#email.policy.EmailPolicy" title="email.policy.EmailPolicy"><code class="xref py py-class docutils literal notranslate"><span class="pre">EmailPolicies</span></code></a>, l'API effective du paquet de messagerie est modifiée par rapport à l'API Python 3.2 de la manière suivante :</p>
<ul class="simple">
<li><p>Définir un en-tête sur un <a class="reference internal" href="email.compat32-message.html#email.message.Message" title="email.message.Message"><code class="xref py py-class docutils literal notranslate"><span class="pre">Message</span></code></a> entraîne l'analyse de cet en-tête et la création d'un objet d'en-tête.</p></li>
<li><p>La récupération d'une valeur d'en-tête à partir d'un <a class="reference internal" href="email.compat32-message.html#email.message.Message" title="email.message.Message"><code class="xref py py-class docutils literal notranslate"><span class="pre">Message</span></code></a> entraîne l'analyse de cet en-tête ainsi que la création et le renvoi d'un objet d'en-tête.</p></li>
<li><p>Tout objet d'en-tête, ou tout en-tête qui est remis en forme en raison des paramètres de politique, est mis en forme à l'aide d'un algorithme qui implémente entièrement les algorithmes de pliage de la RFC, notamment en sachant où les mots encodés sont requis et autorisés.</p></li>
</ul>
<p>Du point de vue de l'application, cela signifie que tout en-tête obtenu via <a class="reference internal" href="email.message.html#email.message.EmailMessage" title="email.message.EmailMessage"><code class="xref py py-class docutils literal notranslate"><span class="pre">EmailMessage</span></code></a> est un objet d'en-tête avec des attributs supplémentaires, dont la valeur de chaîne est la valeur Unicode entièrement décodée de l'en-tête. De même, un en-tête peut se voir attribuer une nouvelle valeur, ou un nouvel en-tête créé, à l'aide d'une chaîne Unicode, et la politique se chargera de convertir la chaîne Unicode dans la forme encodée RFC correcte.</p>
<p>Les objets d'en-tête et leurs attributs sont décrits dans <a class="reference internal" href="email.headerregistry.html#module-email.headerregistry" title="email.headerregistry: Automatic Parsing of headers based on the field name"><code class="xref py py-mod docutils literal notranslate"><span class="pre">headerregistry</span></code></a>.</p>
<dl class="py class">
<dt class="sig sig-object py" id="email.policy.Compat32">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">email.policy.</span></span><span class="sig-name descname"><span class="pre">Compat32</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kw</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="email.policy.html#email.policy.Compat32" title="Lien vers cette définition">¶</a></dt>
<dd><p>Cette <a class="reference internal" href="email.policy.html#email.policy.Policy" title="email.policy.Policy"><code class="xref py py-class docutils literal notranslate"><span class="pre">Policy</span></code></a> concrète est la politique de rétrocompatibilité. Elle reproduit le comportement du paquet de courrier électronique dans Python 3.2. Le module <a class="reference internal" href="email.policy.html#module-email.policy" title="email.policy: Controlling the parsing and generating of messages"><code class="xref py py-mod docutils literal notranslate"><span class="pre">policy</span></code></a> définit également une instance de cette classe, <a class="reference internal" href="email.policy.html#email.policy.compat32" title="email.policy.compat32"><code class="xref py py-const docutils literal notranslate"><span class="pre">compat32</span></code></a>, qui est utilisée comme politique par défaut. Ainsi, le comportement par défaut du paquet de messagerie est de maintenir la compatibilité avec Python 3.2.</p>
<p>Les attributs suivants ont des valeurs différentes de la valeur par défaut de <a class="reference internal" href="email.policy.html#email.policy.Policy" title="email.policy.Policy"><code class="xref py py-class docutils literal notranslate"><span class="pre">Policy</span></code></a> :</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="email.policy.Compat32.mangle_from_">
<span class="sig-name descname"><span class="pre">mangle_from_</span></span><a class="headerlink" href="email.policy.html#email.policy.Compat32.mangle_from_" title="Lien vers cette définition">¶</a></dt>
<dd><p>La valeur par défaut est <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</dd></dl>

<p>La classe fournit les implémentations concrètes suivantes des méthodes abstraites de <a class="reference internal" href="email.policy.html#email.policy.Policy" title="email.policy.Policy"><code class="xref py py-class docutils literal notranslate"><span class="pre">Policy</span></code></a> :</p>
<dl class="py method">
<dt class="sig sig-object py" id="email.policy.Compat32.header_source_parse">
<span class="sig-name descname"><span class="pre">header_source_parse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sourcelines</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="email.policy.html#email.policy.Compat32.header_source_parse" title="Lien vers cette définition">¶</a></dt>
<dd><p>Le nom est analysé comme le reste jusqu'au <code class="docutils literal notranslate"><span class="pre">:</span></code> et renvoyé sans modification. La valeur est déterminée en supprimant les espaces blancs de début du reste de la première ligne, en joignant toutes les lignes suivantes et en supprimant tous les caractères de retour chariot ou de saut de ligne de fin.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="email.policy.Compat32.header_store_parse">
<span class="sig-name descname"><span class="pre">header_store_parse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="email.policy.html#email.policy.Compat32.header_store_parse" title="Lien vers cette définition">¶</a></dt>
<dd><p>Le nom et la valeur sont renvoyés sans modification.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="email.policy.Compat32.header_fetch_parse">
<span class="sig-name descname"><span class="pre">header_fetch_parse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="email.policy.html#email.policy.Compat32.header_fetch_parse" title="Lien vers cette définition">¶</a></dt>
<dd><p>Si la valeur contient des données binaires, elle est convertie en un objet <a class="reference internal" href="email.header.html#email.header.Header" title="email.header.Header"><code class="xref py py-class docutils literal notranslate"><span class="pre">Header</span></code></a> en utilisant le jeu de caractères <code class="docutils literal notranslate"><span class="pre">unknown-8bit</span></code>. Sinon, elle est renvoyée sans modification.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="email.policy.Compat32.fold">
<span class="sig-name descname"><span class="pre">fold</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="email.policy.html#email.policy.Compat32.fold" title="Lien vers cette définition">¶</a></dt>
<dd><p>Les en-têtes sont mis en forme à l'aide de l'algorithme de pliage <a class="reference internal" href="email.header.html#email.header.Header" title="email.header.Header"><code class="xref py py-class docutils literal notranslate"><span class="pre">Header</span></code></a>, qui préserve les sauts de ligne existants dans la valeur et encapsule chaque ligne résultante dans la <code class="docutils literal notranslate"><span class="pre">max_line_length</span></code>. Les données binaires non-ASCII sont codées en CTE à l'aide du jeu de caractères <code class="docutils literal notranslate"><span class="pre">unknown-8bit</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="email.policy.Compat32.fold_binary">
<span class="sig-name descname"><span class="pre">fold_binary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="email.policy.html#email.policy.Compat32.fold_binary" title="Lien vers cette définition">¶</a></dt>
<dd><p>Les en-têtes sont mis en forme à l'aide de l'algorithme de pliage <a class="reference internal" href="email.header.html#email.header.Header" title="email.header.Header"><code class="xref py py-class docutils literal notranslate"><span class="pre">Header</span></code></a>, qui préserve les sauts de ligne existants dans la valeur et encapsule chaque ligne résultante dans la <code class="docutils literal notranslate"><span class="pre">max_line_length</span></code>. Si <code class="docutils literal notranslate"><span class="pre">cte_type</span></code> est <code class="docutils literal notranslate"><span class="pre">7bit</span></code>, les données binaires non-ASCII sont encodées en CTE en utilisant le jeu de caractères <code class="docutils literal notranslate"><span class="pre">unknown-8bit</span></code>. Sinon, l'en-tête source d'origine est utilisé, avec ses sauts de ligne existants et toutes les données binaires (non conformes à la RFC) qu'il peut contenir.</p>
</dd></dl>

</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="email.policy.compat32">
<span class="sig-prename descclassname"><span class="pre">email.policy.</span></span><span class="sig-name descname"><span class="pre">compat32</span></span><a class="headerlink" href="email.policy.html#email.policy.compat32" title="Lien vers cette définition">¶</a></dt>
<dd><p>Instance de <a class="reference internal" href="email.policy.html#email.policy.Compat32" title="email.policy.Compat32"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compat32</span></code></a>, offrant une rétrocompatibilité avec le comportement du paquet de messagerie dans Python 3.2.</p>
</dd></dl>

<p class="rubric">Notes</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id2" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="email.policy.html#id1">1</a><span class="fn-bracket">]</span></span>
<p>Initialement ajouté dans 3.3 en tant que <a class="reference internal" href="../glossary.html#term-provisional-package"><span class="xref std std-term">paquet provisoire</span></a>.</p>
</aside>
</aside>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h4>Sujet précédent</h4>
    <p class="topless"><a href="email.generator.html"
                          title="Chapitre précédent"><code class="xref py py-mod docutils literal notranslate"><span class="pre">email.generator</span></code>: Generating MIME documents</a></p>
  </div>
  <div>
    <h4>Sujet suivant</h4>
    <p class="topless"><a href="email.errors.html"
                          title="Chapitre suivant"><code class="xref py py-mod docutils literal notranslate"><span class="pre">email.errors</span></code>: Exception and Defect classes</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>Cette page</h3>
    <ul class="this-page-menu">
      <li><a href="../bugs.html">Signalement de bogue</a></li>
      <li>
        <a href="https://github.com/python/cpython/blob/main/Doc/library/email.policy.rst"
            rel="nofollow">Voir la source
        </a>
      </li>
    </ul>
  </div>
        </div>
<div id="sidebarbutton" title="Réduire la barre latérale">
<span>«</span>
</div>

      </div>
      <div class="clearer"></div>
    </div>  
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="Index général"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Index des modules Python"
             >modules</a> |</li>
        <li class="right" >
          <a href="email.errors.html" title="email.errors: Exception and Defect classes"
             >suivant</a> |</li>
        <li class="right" >
          <a href="email.generator.html" title="email.generator: Generating MIME documents"
             >précédent</a> |</li>

          <li><img src="../_static/py.svg" alt="Python logo" style="vertical-align: middle; margin-top: -1px"/></li>
          <li><a href="https://www.python.org/">Python</a> &#187;</li>
          <li class="switchers">
            <div class="language_switcher_placeholder"></div>
            <div class="version_switcher_placeholder"></div>
          </li>
          <li>
              
          </li>
    <li id="cpython-language-and-version">
      <a href="../index.html">3.12.4 Documentation</a> &#187;
    </li>

          <li class="nav-item nav-item-1"><a href="index.html" >La bibliothèque standard</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="netdata.html" >Traitement des données provenant d'Internet</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="email.html" ><code class="xref py py-mod docutils literal notranslate"><span class="pre">email</span></code> --- An email and MIME handling package</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="email.policy.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">email.policy</span></code>: Policy Objects</a></li>
                <li class="right">
                    

    <div class="inline-search" role="search">
        <form class="inline-search" action="../search.html" method="get">
          <input placeholder="Recherche rapide" aria-label="Recherche rapide" type="search" name="q" id="search-box" />
          <input type="submit" value="Go" />
        </form>
    </div>
                     |
                </li>
            <li class="right">
<label class="theme-selector-label">
    Theme
    <select class="theme-selector" oninput="activateTheme(this.value)">
        <option value="auto" selected>Auto</option>
        <option value="light">Light</option>
        <option value="dark">Dark</option>
    </select>
</label> |</li>
            
      </ul>
    </div>  
    <div class="footer">
    &copy; 
      <a href="../copyright.html">
    
    Copyright
    
      </a>
     2001-2024, Python Software Foundation.
    <br />
    This page is licensed under the Python Software Foundation License Version 2.
    <br />
    Examples, recipes, and other code in the documentation are additionally licensed under the Zero Clause BSD License.
    <br />
    
      See <a href="../../../license.html">History and License</a> for more information.<br />
    
    
    <br />

    The Python Software Foundation is a non-profit corporation.
<a href="https://www.python.org/psf/donations/">Please donate.</a>
<br />
    <br />
      Mis à jour le Jun 09, 2024 (22:21 UTC).
    
      <a href="../../../bugs.html">Found a bug</a>?
    
    <br />

    Créé en utilisant <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.3.7.
    </div>

    <script type="text/javascript" src="../_static/switchers.js"></script>
  </body>
</html>